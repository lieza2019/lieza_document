\documentclass[a4j]{jreport}

\usepackage{amsmath, amssymb, rsfs}
\usepackage{graphicx, tabularx, graphicx, moreverb}

\usepackage{theorem}
\newtheorem{Definition}{Definition}[section]
\newtheorem{Property}{Property}[section]
\newtheorem{Corollary}{Corollary}[section]
\newtheorem{Lemma}{Lemma}[section]
\newtheorem{Claim}{Claim}[section]
\newtheorem{Proof}{Proof.}
\renewcommand{\theProof}{}

\usepackage{bussproofs}

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\thispagestyle{empty}
\begin{center}
{\Large \textrm{日本信号株式会社【連動技術・運行管理システム技術】 \\
    技術資料}} \\
\vspace{6cm}
{\Huge \textbf{型付き連動結線の開発\linebreak
    (Developing the typed language for
    Interlocking-Logic programming) \linebreak
    第１次 拡張改修仕様 \linebreak
    (DRAFT: 2014/12版)}} \\
\vspace{9cm}
%{\huge \textrm{社員番号 5271}} \\
%\vspace{1cm}
%{\huge \textrm{後藤 晃(他)}} \\
%\vspace{4cm}
\begin{flushbottom}
  {\huge \textrm{2014年12月}} \\
\end{flushbottom}
\end{center}


% 10年分の経験を、この一件に全て託せよ。

% LIezA : Logic for Interlocking logics sElf-analyZing Architecture.
\begin{Definition}{項(TERMS)}
  項$t \in \mathbb{T}$を以下のように定義する.
  \[ t \;\stackrel{\mathrm{def}}{:=}\!
      \begin{array}[t]{l}
             t_0 \ \text{\it where}\; (t_0, \mathcal{R}_0) \!\in\!
              \Gamma_{gnd} \ \text{\it for some}\ \mathcal{R}_0 \ |  \\
             t_1 \ \text{\it where}\; (t_1, \mathcal{R}_1) \!\in\!
              \Gamma_{def} \ \text{\it for some}\ \mathcal{R}_1 \ |  \\
             t_1 \wedge t_2
        \ |\ t_1 \vee t_2 \ |  \\
        \{\} \ |\ \{t_1 \cdots t_n \}
        \ |\ [t_1 \cdots t_n ]
        \ |\ \langle t_1 \cdots t_n \rangle \ |  \\
        \circ \ |\  {t_1}^? \ |  \\
              {t_1}^{\leftarrow} \ | \ {t_1}^{\rightarrow}
      \end{array}
  \]
\end{Definition}


\begin{Definition}{項識別子(TERM IDENTIFIER)}
  項$t$の項識別子(TERM INDENTIFIER) $\mathpzc{id}(t)$を以下のように定義する.
  \[ t'\text{\rm s {\bf identifier}} \,\stackrel{\mathrm{def}}{:=}\,
      \mathpzc{id}(t) \in \mathbb{N}
  \]
  
  以降, 項識別子として$m \in \mathbb{N}$を持つ項を$t^m$と表記する.
\end{Definition}

上記$\mathpzc{id}$を,項集合(TERM SET)に対する適用として,以下のように拡張
できる.
\[ \mathpzc{id}(\mathbb{T}) \,\stackrel{\mathrm{def}}{:=}\,
    \bigl\{\mathpzc{id}(t) \,|\; t \in \mathbb{T} \bigr\}
\]


\begin{Corollary}
  \begin{displaymath}
    \begin{array}{c}
      \mathpzc{id}(\mathbb{T}_1 \cup \mathbb{T}_2 ) =
       \mathpzc{id}(\mathbb{T}_1 ) \cup \mathpzc{id}(\mathbb{T}_2 )  \\
      \mathpzc{id}(\bigcup_{j=1}^{n} \mathbb{T}_j ) =
       \bigcup_{j=1}^{n} \mathpzc{id}(\mathbb{T}_j)
    \end{array}
  \end{displaymath}
\end{Corollary}


\begin{Definition}{構造的同値}(STRUCTUAL EQUIVALENCE OVER CANONICAL TERMS)
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{}{
            t_0 \equiv t_0 \
             \text{\it where}\ (t_0, \mathcal{R}_0) \!\in\! \Gamma_{gnd}
          }  &  \text{\it (E-Atom0-canon)}
        \end{array}
        
        &  \begin{array}{rl}
             \dfrac{} {
               t_1 \equiv t_1 \
                \text{\it where}\ (t_1, \mathcal{R}_1) \!\in\! \Gamma_{def}
             }  &  \text{\it (E-Atom1-canon)}
           \end{array}
      \end{array}  \\      
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{
            t_1 \equiv t'_1 \quad t_2 \equiv t'_2
          }{
            t_1 \wedge t_2 \equiv t'_1 \wedge t'_2
          }  &  \text{\it (E-Cas-canon)}
        \end{array}
        &  \begin{array}{rl}
             \dfrac{
               t_1 \equiv t'_1 \quad t_2 \equiv t'_2
             }{
               t_1 \vee t_2 \equiv t'_1 \vee t'_2
             }  &  \text{\it (E-Par-canon)}
        \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{
            t_1 \equiv t'_1 \,\cdots\, t_n \equiv t'_n \quad n \ge 0
          }{
            \{t_1 \cdots t_n\} \equiv \{t'_1 \cdots t'_n\}
          }  &  \text{\it (E-Cat0-canon)}
        \end{array}
        &  \begin{array}{rl}
             \dfrac{
               t_1 \equiv t'_1 \,\cdots\, t_n \equiv t'_n \quad n \ge 1
             }{
               [t_1 \cdots t_n] \equiv [t'_1 \cdots t'_n]
             }  &  \text{\it (E-Cat1-canon)}
           \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          t_1 \equiv t'_1 \,\cdots\, t_n \equiv t'_n \quad n \ge 1
        }{
          \langle t_1 \cdots t_n \rangle \equiv
           \langle t'_1 \cdots t'_n \rangle
        }  &  \text{\it (E-Dup-canon)}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{}{
            \circ \equiv \circ
          }  &  \text{\it (E-Nil-canon)}
        \end{array}
        &  \begin{array}{rl}
             \dfrac{
               t_1 \equiv t'_1
             }{
               {t_1}^? \equiv {t'_1}^?
             }  &  \text{\it (E-Opt-canon)}
        \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{
            t_1 \equiv t'_1
          }{
            {t_1}^{\leftarrow} \equiv {t'_1}^{\leftarrow}
          }  &  \text{\it (E-Alt-canon-L)}
        \end{array}
        &  \begin{array}{rl}
             \dfrac{
               t_1 \equiv t'_1
             }{
               {t_1}^{\rightarrow} \equiv {t'_1}^{\rightarrow}
             }  &  \text{\it (E-Alt-canon-R)}
           \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{
            t_1 \equiv t'_1
          }{
            {t_1}^i \equiv t'_1
          }  &  \text{\it (E-Ins-canon-L)}
        \end{array}
        &  \begin{array}{rl}
             \dfrac{
               t_1 \equiv t'_1
             }{
               t_1 \equiv {{t'}_1}^i
             }  &  \text{\it (E-Ins-canon-R)}
           \end{array}
      \end{array}
      
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Definition}{部分項}(SUBTERMS)
  項$t$の部分項(SUBTERMS)を以下のように定義する.
  \begin{displaymath}
    \begin{array}{lll}
      \mathpzc{sub}(t) &:=
      & \left\{ \begin{array}{ll}
          \{t \}  &
           \text{\it if}\;
            \left\{ \! \begin{array}{l}
              t \equiv t_0\
               \text{\it where}\ (t_0, \mathcal{R}_0) \in \Gamma_{gnd}  \\
              t \equiv t_1\
               \text{\it where}\ (t_1, \mathcal{R}_1) \in \Gamma_{def}  \\
              t \equiv \{\}  \\
              t \equiv \circ
            \end{array} \right.  \\
          
          \{t \} \cup \bigl(\mathpzc{sub}(t_1) \cup \mathpzc{sub}(t_2)
           \bigr)  &
           \text{\it if}\;\; t \ \text{\it is}\ t_1 \wedge t_2,\
            t_1 \vee t_2  \\
          
          \{t \} \cup \bigl(\bigcup^{n}_{j=1} \mathpzc{sub}(t_j) \bigr)  &
           \text{\it if}\;\; t \ \text{\it is}\ \{t_1 \cdots t_n \},
            \ [t_1 \cdots t_n ], \ \langle t_1 \cdots t_n \rangle  \\
          
          \{{t_1}^? \} \cup \mathpzc{sub}(t_1)  &
           \text{\it if}\;\; t \ \text{\it is}\ {t_1}^?  \\
          
          \{{t_1}^\leftarrow \} \cup \mathpzc{sub}(t_1)  &
           \text{\it if}\;\; t \ \text{\it is}\ {t_1}^\leftarrow \\
          
          \{{t_1}^\rightarrow \} \cup \mathpzc{sub}(t_1)  &
           \text{\it if}\;\; t \ \text{\it is}\ {t_1}^\rightarrow
        \end{array} \right.
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Definition}{実例項}(TERM INSTANCE)
  項$t$の実例(INSTANCE)を以下のように定義する.
  \[ t \ \text{\it : {\bf instance}} \,\stackrel{\mathrm{def}}{:=}\,
      \left\{ \!\! \begin{array}{l}
        \bigl(\forall t' \in \mathpzc{sub}(t) \bigr).\bigl[
         \mathpzc{id}(t') = \exists m \ \text{\it s.t.}\ m \in \mathbb{N}
          \bigr]  \\
        (\forall t' \in \mathpzc{sub}(t) ).\bigl[
          \mathpzc{id}(t')\ \text{\it is UNIQUE over}\ \mathpzc{sub}(t)
           \bigr]
      \end{array} \right.
  \]
\end{Definition}


\begin{Lemma} \label{identity_on_structual_equivalence}
  \[ t \equiv t,\ \text{\it where}\;\; t: \text{\it instance}
  \]
  \begin{Proof}
    Proof is induction on structure of t.
    
    Case ${t_0}^i$, where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From (E-Atom0-canon), $t_0 \equiv t_0$ where $(t_0, \mathcal{R}_0) \in
    \Gamma_{gnd}$. Then we obtain $t_0 \equiv {t_0}^i$, from
    (E-Ins-canon-R), and ${t_0}^i \equiv {t_0}^i$, from (E-Ins-canon-L).
    
    Case ${t_1}^i$, where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same as the case of
    ${t_0}^i$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$, with
    (E-Atom1-canon).
    
    Case $(t_1 \wedge t_2)^i$:
    Since $t$ is instance, $t_1$ and $t_2$, that are subterms of $t$,
    are also instances. Then $t_1 \equiv t_1$ and $t_2 \equiv t_2$,
    both are from I.H.
    Therefore we found that $t_1 \wedge t_2 \equiv t_1 \wedge t_2$, from
    (E-Cas-canon) and we also do $t_1 \wedge t_2 \equiv {(t_1 \wedge t_2)}^i$,
    from (E-Ins-canon-R). 故に finally, we can obtain
    ${(t_1 \wedge t_2)}^i \equiv {(t_1 \wedge t_2)}^i$, from
    (E-Ins-canon-L).
    
    Case $(t_1 \vee t_2)^i$: Same as the case of $(t_1 \wedge t_2)^i$,
    with (E-Par-canon).
    
    Case ${\{\}}^i$:
    $\{\} \equiv \{\}$ 成立, from (E-Cat0-canon), よって we obtain
    $\{\} \equiv {\{\}}^i$, from (E-Ins-canon-R). And then we can
    ${\{\}}^i \equiv {\{\}}^i$, from (E-Ins-canon-L).
    
    Case ${\{t_1 \cdots t_n \}}^i$ where $n \ge 1$:
    Since each $t_1 \cdots t_n$ are subterm of $t$, then
    $t_1 \!\equiv\! t_1 \cdots\, t_n \!\equiv\! t_n$, by I.H. for each.
    Therefore we got that $\{t_1 \cdots t_n \} \equiv \{t_1 \cdots t_n \}$,
    from (E-Cat0-canon),
    and we also do $\{t_1 \cdots t_n \} \equiv {\{t_1 \cdots t_n \}}^i$,
    from (E-Ins-canon-R).
    故に ${\{t_1 \cdots t_n \}}^i \equiv {\{t_1 \cdots t_n\}}^i$,
    from (E-Ins-canon-L).
    
    Case ${[t_1 \cdots t_n ]}^i$:
    Same as the case of ${\{t_1 \cdots t_n \}}^i$ with (E-Cat1-canon).
    
    Case ${\langle t_1 \cdots t_n \rangle }^i$:
    Same as the case of ${[t_1 \cdots t_n ]}^i$ with (E-Dup-canon).

    Case $\circ^i$: Similar to the case that $t$ is $\{\}$ with
    (E-Nil-canon).
    
    Case ${t_1}^?$:
    By I.H. $t_1 \equiv t_1$, since $t_1$ is it's subterm. よって we obtain
    ${t_1}^? \equiv {t_1}^?$ from (E-Opt-canon), and then we also
    ${t_1}^? \equiv {{t_1}^?}^i$, from (E-Ins-canon-R).
    故に ${{t_1}^?}^i \equiv {{t_1}^?}^i$, from (E-Ins-canon-L).
    
    Case ${{t_1}^\leftarrow}^i$:
    Since $t_1$ is subterm of $t$, then $t_1 \equiv t_1$ 成立 by I.H.
    Then we obtain ${t_1}^\leftarrow \equiv {t_1}^\leftarrow$, from
    (E-Alt-canon-L), and we also got
    ${t_1}^\leftarrow \equiv {{t_1}^\leftarrow}^i$, from (E-Ins-canon-R).
    故に ${{t_1}^\leftarrow}^i \equiv {{t_1}^\leftarrow}^i$,
    from (E-Ins-canon-L).
    
    Case ${{t_1}^\rightarrow}^i$:
    Same as the case that $t$ is ${{t_1}^\leftarrow}^i$, with
    (E-Alt-canon-R).
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma} \label{grandterm_equivalence}
  \[ \left.\begin{array}{r}
       t \equiv t_0 \ \text{\it where}\ (t_0, \mathcal{R}_0) \in
        \Gamma_{gnd}  \\
       t: \text{\it instance}
     \end{array} \right\} \,\Leftrightarrow\, t \ \text{\it is}\ {t_0}^i\
     \text{\it where}\ (t_0, \mathcal{R}_0) \in \Gamma_{gnd}
  \]
  \begin{Proof}
    ($\Rightarrow$): Proof is directly from def. of structual equivalence.
    
    Case (E-Atom0-canon): Now we assume that the last applied rule is
    (E-Atom0-canon). From def. of this rule, $t$ should be $t_0$ s.t.
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$, which isn't instance,
    from def. of $\Gamma_{gnd}$. Then 前提不成立.
    
    Case (E-Atom1-canon): Same as the case of (E-Atom0-canon).
    
    Case (E-Cas-canon): From def. of rule, $t$ is $t_1 \wedge t_2$ for some
    $t_1$ and $t_2$, and $t_0$ is also $t'_1 \wedge t'_2$ for some $t'_1$
    and $t'_2$. Then $t_0 \not\in \Gamma_{gnd}$, from def. of
    $\Gamma_{gnd}$. 前提不成立.
    
    Case (E-Par-canon): Same as the case of (E-Cas-canon).
    
    Case (E-Cat0-canon): From def. of rule,
    $t$ is $\{t_1 \cdots t_n \}$ for some $t_1 \cdots t_n$, and $t_0$ is
    $\{t'_1 \cdots t'_n \}$ for some $t'_1 \cdots t'_n$.
    Then $t_0 \not\in \Gamma_{gnd}$, from def. of $\Gamma_{gnd}$,
    前提不成立.
    
    Case (E-Cat1-canon): Same as the case of (E-Cat0-canon).
    
    Case (E-Dup-canon): Same as the case of (E-Cat1-canon).
    
    Case (E-Nil-canon):
    From def. of rule, $t$ is $\circ$, and $\circ \not\in \Gamma_{gnd}$,
    from def. of $\Gamma_{gnd}$. 前提不成立.

    Case (E-Opt-canon): From def. of rule, $t$ is ${t_1}^?$, and $t_0$ is
    ${t'_1}^?$, for some $t_1,\, t'_1$ respectively.
    Then ${t'_1}^? \not\in \Gamma_{gnd}$, from def. of $\Gamma_{gnd}$.
    前提不成立.
    
    Case (E-Alt-canon-L): From def. of rule,
    $t$ is ${t_1}^\leftarrow$ and $t_0$ is ${t'_1}^\leftarrow$ for some
    $t_1,\, t'_1$. Then $t_0 \not\in \Gamma_{gnd}$, from def. of
    $\Gamma_{gnd}$. 前提不成立.
    
    Case (E-Alt-canon-R): Same as the case of (E-Alt-canon-L).
    
    Case (E-Ins-canon-L): From def. of this rule, $t$ is ${t_1}^i$,
    which $t_1$ isn't instance.
    And $t_0$ satisfies $t_0 \in \Gamma_{gnd}$,
    for premise as $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    Then we can assume the previous applied rule is only (E-Atom0-canon).
    Since both $t_1$ and $t_0 \in \Gamma_{gnd}$ aren't instance.
    Therefore $t_1$ is $t_0$ s.t.
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$, from def. of (E-Atom0-canon).
    故に $t$ is ${t_0}^i$ s.t. $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case (E-Ins-canon-R): From def. of rule, $t$ is $t_1$ as a instance,
    and $t_0$ is ${t'_1}^i$, for some $t_1,\, {t'}_1$ respectively.
    Then $t_0 \not\in \Gamma_{gnd}$ where $t_0$ is ${t'_1}^i$,
    since any terms belonging to $\Gamma_{gnd}$ aren't instantiated yet.
    前提不成立.
    
    ($\Leftarrow$): Proof is straightforward as below.
    
    From (E-Atom0-canon), $t_0 \equiv t_0$ where
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    Then we obtain ${t_0}^i \equiv t_0$, where
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$, from (E-Ins-canon-L).
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma} \label{user-defined-term_equivalence}
  \[ \left.\begin{array}[c]{r}
       t \equiv t_1\ \text{\it where}\ (t_1, \mathcal{R}_1) \in
        \Gamma_{def}  \\
       t: \text{\it instance}
  \end{array} \right\} \,\Leftrightarrow\, t \ \text{\it is}\ {t_1}^i\
  \text{\it where}\ (t_1, \mathcal{R}_1) \in \Gamma_{def}
  \]
  \begin{Proof}
    Proof is similar to Lemma \ref{grandterm_equivalence}.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma} \label{nil_equivalence}
  \[ \begin{array}{c}
       t \equiv \{\}\ \text{\it s.t.}\ t: \text{\it instance}
        \,\Leftrightarrow\, t\ \text{\it is}\ {\{\}}^i  \\
       t \equiv \circ\ \text{\it s.t.}\ t:\text{\it instance}
        \,\Leftrightarrow\, t\ \text{\it is}\ {\circ}^i
     \end{array}
  \]
  \begin{Proof}
    Proof is similar to Lemma \ref{grandterm_equivalence} or
    \ref{user-defined-term_equivalence}.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Definition}{実例的同値(PROPER EQUIVALENCE OVER CANONICAL TERMS)}
  \begin{displaymath}
    t = t' \;\stackrel{\mathrm{def}}{:=}\
     t \equiv t',\ \text{\it and}\ \mathpzc{id}(t_1) = \mathpzc{id}(t'_1)\
      \text{\it for}\;\; \forall t_1 \!\in\! \mathpzc{sub}(t),\;
       \forall t'_1 \!\in\! \mathpzc{sub}(t')
  \end{displaymath}
\end{Definition}


\begin{Definition}{項生成(TERM INSTANTIATOR)}
  項$t$の生成子$\mathpzc{carv}(t, m)$を以下のように定義する.
  \begin{displaymath}
  \begin{array}{rll}
    \mathpzc{carv}(t, m)  &\stackrel{\mathrm{def}}{:=}
    & \left\{ \begin{array}{l}
        {t_0}^m  \quad \text{\it if}\;\; t \equiv t_0\
         \text{\it where}\ (t_0, \mathcal{R}_0) \in \Gamma_{gnd}  \\
        {t_1}^m  \quad \text{\it if}\;\; t \equiv t_1\
         \text{\it where}\ (t_1, \mathcal{R}_1) \in \Gamma_{def}  \\
        
        \bigl(\mathpzc{carv}(t_1, m) \wedge
         \mathpzc{carv}(t_2, m_1 + 1) \bigr)^{m_2 + 1}
          \quad \text{\it if}\;\; t \ \text{\it is}\ t_1 \wedge t_2  \\
           \quad ,\text{\it where}\ m_1 = \mathpzc{id}\bigl(
            \mathpzc{carv}(t_1, m)\bigr),\
             m_2 = \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 \!+\! 1 )
              \bigr)  \\
        
        \bigl(\mathpzc{carv}(t_1, m) \vee
         \mathpzc{carv}(t_2, m_1 + 1) \bigr)^{m_2 + 1}
          \quad \text{\it if}\;\; t \ \text{\it is}\ t_1 \vee t_2  \\
           \quad ,\text{\it where}\ m_1 = \mathpzc{id}\bigl(
            \mathpzc{carv}(t_1, m)\bigr),\
             m_2 = \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 \!+\! 1 )
              \bigr)  \\
        
        \{\}^{m}  \quad \text{\it if}\;\; t \equiv \{\}  \\
        
        \mathpzc{carv}_{\{\}}\bigl(\{t_1 \cdots t_n \}, m \bigr)
         \quad \text{\it if}\;\; t \ \text{\it is}\
          \{t_1 \cdots t_n \},\; n \ge 1  \\
        \mathpzc{carv}_{[\,]}\bigl([t_1 \cdots t_n ], m \bigr)
         \quad \text{\it if}\;\; t \ \text{\it is}\ 
          [t_1 \cdots t_n ],\; n \ge 1  \\
        \mathpzc{carv}_{\langle \rangle}\bigl(
         \langle t_1 \cdots t_n \rangle, m \bigr)
          \quad \text{\it if}\;\; t \ \text{\it is}\ 
           \langle t_1 \cdots t_n \rangle, \; n \ge 1  \\
        
        \circ^m  \quad \text{\it if}\ t \equiv \circ  \\
        
        {{\mathpzc{carv}(t_1, m)}^?}^{\mathpzc{id}\bigl(
         \mathpzc{carv}(t_1, m) \bigr) + 1}
          \quad \text{\it if}\;\; t \ \text{\it is}\ {t_1}^?  \\
        
        {{\mathpzc{carv}(t_1, m)}^\leftarrow }^{\mathpzc{id}\bigl(
         \mathpzc{carv}(t_1, m) \bigr) + 1}
          \quad \text{\it if}\;\; t \ \text{\it is}\ {t_1}^\leftarrow  \\
        
        {{\mathpzc{carv}(t_1, m)}^\rightarrow}^{\mathpzc{id}\bigl(
         \mathpzc{carv}(t_1, m) \bigr) + 1}
          \quad \text{\it if}\;\; t \ \text{\it is}\ {t_1}^\rightarrow  \\
        
      \end{array} \right.  \\
    \\
    
    \mathpzc{carv}_{\{\}}\bigl(\{t_1 \cdots t_n \}, m \bigr)
     & \stackrel{\mathrm{def}}{:=}
     & \left\{ \begin{array}{l}
         \bigl\{ \mathpzc{carv}(t_1, m) \bigr\}^{m_1 + 1},\
          \text{\it where}\ m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m)
           \bigr) \quad \text{\it if}\;\: n = 1  \\
         \bigl\{\mathpzc{carv}(t_1, m), t'_2 \cdots t'_n \bigr\}^{m'}
          \quad \text{\it if}\;\; n \ge 2  \\
          \quad ,\text{\it where} \begin{array}[t]{l}
            \{t'_2 \cdots t'_n \}^{m'} =
             \mathpzc{carv}\Bigl({\{t_2 \cdots t_n \}}^i,\,
              \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) \!+\! 1
               \Bigr)  \\
            i = \text{\it id}\bigl(\{t_1 \cdots t_n \} \bigr)
          \end{array}
       \end{array} \right.  \\
    \\
    \mathpzc{carv}_{[\,]}\bigl([t_1 \cdots t_n ], m \bigr)
     & \stackrel{\mathrm{def}}{:=}
     & \left\{ \begin{array}{l}
         \bigl[ \mathpzc{carv}(t_1, m) \bigr]^{m_1 + 1},\
          \text{\it where}\ m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m)
           \bigr) \quad \text{\it if}\;\; n = 1  \\
         \bigl[\mathpzc{carv}(t_1, m), t'_2 \cdots t'_n \bigr]^{m'}
          \quad \text{\it if}\;\; n \ge 2  \\
           \quad ,\text{\it where} \begin{array}[t]{l} 
             [t'_2 \cdots t'_n ]^{m'} =
              \mathpzc{carv}\Bigl({[t_2 \cdots t_n ]}^i,\,
               \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) \!+\! 1
                \Bigr)  \\
              i = \mathpzc{id}\bigl([t_1 \cdots t_n ] \bigr)
           \end{array}  
       \end{array} \right.  \\
    \\
    \mathpzc{carv}_{\langle \rangle}\bigl(
     \langle t_1 \cdots t_n \rangle, m \bigr)
     & \stackrel{\mathrm{def}}{:=}
     & \left\{ \begin{array}{l}
         \bigl\langle \mathpzc{carv}(t_1, m) \bigr \rangle^{m_1 + 1},\
          \text{\it where}\ m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m)
           \bigr) \quad \text{\it if}\;\; n = 1  \\
         \bigl\langle \mathpzc{carv}(t_1, m), t'_2 \cdots t'_n
          \bigr\rangle^{m'} \quad \text{\it if}\;\; n \ge 2  \\
           \quad ,\text{\it where} \begin{array}[t]{l}
             \langle t'_2 \cdots t'_n \rangle^{m'} =
              \mathpzc{carv}\bigl({\langle t_2 \cdots t_n \rangle}^i,\,
               \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) \!+\! 1
                \Bigr)  \\
             i = \mathpzc{id}\bigl(\langle t_1 \cdots t_n \rangle \bigr)
           \end{array}   
       \end{array} \right.  \\
  \end{array}
  \end{displaymath}
  以降, 任意の項$t$について$\mathpzc{carv}(t, m), m \in \mathbb{N}$
  が施されているものとする.
\end{Definition}


\begin{Lemma}{equivalence preservation on instantiation}
\label{equivalence_preservation_on_instantiation}
  \[ t \equiv \mathpzc{carv}(t, m),\ \text{\it where}\
               t \ \text{\it is instance}
  \]
  \begin{Proof}
    Proof is directly induction on structure of $t$.
    
    Case ${t_0}^i$\ \text{\it where}\
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    先ず $t_0 \equiv t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$
    成立, from (E-Atom0-canon).
    And we obtain ${t_0}^i \equiv t_0$, from (E-Ins-canon-L), then, 
    ${t_0}^i \equiv {t_0}^m$を得る, from (E-Ins-canon-R).
    一方$\mathpzc{carv}({t_0}^i, m) = {t_0}^m$, from lemma
    \ref{grandterm_equivalence}.
    故に${t_0}^i \equiv \mathpzc{carv}\bigl({t_0}^i, m \bigr)$.
    
    Case ${t_1}^i$\ \text{\it where}\
    $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    ${t_0}^i$\ \text{\it s.t.}\ $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$
    の Case と同様, with lemma \ref{user-defined-term_equivalence}.
    
    Case ${(t_1 \wedge t_2)}^i$:
    By I.H. both $t_1 \equiv \mathpzc{carv}(t_1, m)$, and
    $t_2 \equiv \mathpzc{carv}(t_2, m_1 \!+\! 1)$ where
    $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$成立. Then
    we obtain $t_1 \wedge t_2 \equiv \mathpzc{carv}(t_1, m) \wedge
    \mathpzc{carv}(t_2, m_1 \!+\! 1)$, from (E-Cas-canon). \\
    よって $t_1 \wedge t_2 \equiv {\bigl(\mathpzc{carv}(t_1, m) \wedge
    \mathpzc{carv}(t_2, m_1 \!+\! 1) \bigr)}^{m_2 + 1}$ where
    $m_2 = \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr)$, from
    (E-Ins-canon-R).
    故に $(t_1 \wedge t_2)^i \equiv {\bigl(\mathpzc{carv}(t_1, m) \wedge
    \mathpzc{carv}(t_2, m_1 \!+\! 1) \bigr)}^{m_2 + 1}$, from
    (E-Ins-canon-L)
    であり$(t_1 \wedge t_2)^i \equiv
    \mathpzc{carv}\bigl((t_1 \wedge t_2)^i, m \bigr)$. Since
    $\mathpzc{carv}\bigl((t_1 \wedge t_2)^i, m \bigr) =
    {\bigl(\mathpzc{carv}(t_1, m) \wedge \mathpzc{carv}(t_2, m_1 \!+\! 1)
    \bigr)}^{m_2 \!+\! 1}$.
    
    Case ${(t_1 \vee t_2)}^i$: ${(t_1 \wedge t_2)}^i$ の Case と同様.
    
    Case ${\{\}}^i$: 先ず $\{\} \equiv \{\}$, from (E-Cat0-canon).
    And we obtain ${\{\}}^i \equiv \{\}$, from (E-Ins-canon-L), then
    ${\{\}}^i \equiv {\{\}}^m$成立, from (E-Ins-canon-R).
    一方$\mathpzc{carv}\bigl({\{\}}^i, m \bigr) = {\{\}}^m$, from
    lemma \ref{nil_equivalence}.
    故に${\{\}}^i \equiv \mathpzc{carv}\bigl({\{\}}^i, m \bigr)$.
    
    Case $t$ is ${\{t_1\}}^i$:
    By I.H. $t_1 \equiv \mathpzc{carv}(t_1, m)$.
    Then we obtain $\{t_1\} \equiv \bigl\{ \mathpzc{carv}(t_1, m) \bigr\}$,
    from (E-Cat0-canon). よって
    $\{t_1\} \equiv {\bigl\{ \mathpzc{carv}(t_1, m) \bigr\}}^{m_1 \!+\! 1}$
    where $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$, from
    (E-Ins-canon-R). 故に
    ${\{t_1\}}^i \equiv \bigl{\{\mathpzc{carv}(t_1, m) \bigr\}}^{m_1 \!+\! 1}$,
    from (E-Ins-canon-L) であり
    ${\{t_1\}}^i \equiv \mathpzc{carv}\bigl({\{t_1\}}^i, m \bigr)$.
    Since $\mathpzc{carv}\bigl({\{t_1\}}^i, m \bigr) =
    {\mathpzc{carv}}_{\{\}}\bigl({\{t_1\}}^i, m \bigr) =
    {\bigl\{\mathpzc{carv}(t_1, m) \bigr\}}^{m_1 \!+\! 1}$.
    
    Case ${\{t_1 \cdots t_n \}}^i$, $n \ge 2$:
    From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}\bigl({\{t_1 \cdots t_n \}}^i, m \bigr) =
    \mathpzc{carv}_{\{\}}\bigl({\{t_1 \cdots t_n \}}^i, m \bigr) =
    {\bigl\{ \mathpzc{carv}(t_1, m), t'_2 \cdots t'_n \bigr\}}^{m'}$,
    where ${\{t'_2 \cdots t'_n \}}^{m'} =
    \mathpzc{carv}\Bigl({\{t_2 \cdots t_n \}}^i, \mathpzc{id}\bigl(
    \mathpzc{carv}(t_1, m) \bigr) \!+\! 1 \Bigr)$. \\
    また ${\{t_2 \cdots t_n \}}^i \equiv \mathpzc{carv}\Bigl(
    {\{t_2 \cdots t_n \}}^i, \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m)
    \bigr) \!+\! 1 \Bigr)$, by I.H.
    then ${\{t_2 \cdots t_n \}}^i \equiv \{t'_2 \cdots t'_n \}^{m'}$.  \\
    ここで以下2つの導出が存在する. 
    subcase (E-Ins-canon-R): The previous equation is
    ${\{t_2 \cdots t_n \}}^i \equiv \{t'_2 \cdots t'_n \}$, from def. of
    (E-Ins-canon-R). And from it's syntax, we can predicate that deduction
    is by (E-Ins-canon-L), and which premise is
    $\{t_2 \cdots t_n \} \equiv \{t'_2 \cdots t'_n \}$. Then we obtain
    $t_2 \equiv t'_2 \cdots t_n \equiv t'_n$, from (E-Cat0-canon).
    subcase (E-Ins-Canon-L): The previous equation is
    $\{t_2 \cdots t_n \} \equiv \{t'_2 \cdots t'_n \}^{m'}$, from def. of
    (E-Ins-canon-L). And same as the subcase of above,
    we can predicate the PREVIOUS of previous is
    $\{t_2 \cdots t_n \} \equiv \{t'_2 \cdots t'_n \}$, from
    (E-Ins-canon-R).
    Then 何れにせよ we obtain $t_2 \equiv t'_2 \cdots t_n \equiv t'_n$,
    from (E-Cat0-canon).
    更に$t_1 \equiv \mathpzc{carv}(t_1, m)$, by I.H. 故に
    $\{t_1, t_2 \cdots t_n \} \equiv \bigl\{\mathpzc{carv}(t_1, m),
    t'_2 \cdots t'_n \bigr\}$, from (E-Cat0-canon). Then
    $\{t_1 \cdots t_n \} \equiv {\bigl\{\mathpzc{carv}(t_1, m),
    t'_2 \cdots t'_n \bigr\}}^{m'}$, from (E-Ins-canon-R). And finally,
    ${\{t_1 \cdots t_n \}}^i \equiv {\bigl\{\mathpzc{carv}(t_1, m),
    t'_2 \cdots t'_n \bigr\}}^{m'}$, from (E-Ins-canon-L). ここで
    ${\bigl\{\mathpzc{carv}(t_1, m), t'_2 \cdots t'_n \bigr\}}^{m'} =
    \mathpzc{carv}\bigl({\{t_1 \cdots t_n \}}^i, $ \\ $m \bigr)$より
    $\{t_1 \cdots t_n \}^i \equiv \mathpzc{carv}\bigl(
    {\{t_1 \cdots t_n \}}^i, m \bigr)$.
    
    Case ${[t_1]}^i$: Same as the case of ${\{t_1\}}^i$, from
    (E-Cat1-canon).
    
    Case ${[t_1 \cdots t_n ]}^i$, $n \ge 2$:
    Same as the case of ${\{t_1 \cdots t_n \}}^i$, $n \ge 2$, from
    (E-Cat1-canon).
    
    Case ${\langle t_1 \rangle}^i$:
    Same as the case of ${[t_1]}^i$, from (E-Dup-canon).
    
    Case ${\langle t_1 \cdots t_n \rangle}^i$, $n \ge 2$:
    Same as the case of ${[t_1 \cdots t_n ]}^i$, $n \ge 2$, from
    (E-Dup-canon).
    
    Case $\circ^i$:
    先ず$\circ \equiv \circ$, from (E-Nil-canon). Accordingly
    $\circ^i \equiv \circ$, and $\circ^i \equiv \circ^m$成立, from
    (E-Ins-canon-L) and (E-Ins-canon-R), respectively. かつ
    $\mathpzc{carv}(\circ^i, m) = \circ^m$, from lemma
    \ref{nil_equivalence}.
    故に$\circ^i \equiv \mathpzc{carv}(\circ^i, m)$.
    
    Case ${{t_1}^?}^i$:
    By I.H. $t_1 \equiv \mathpzc{carv}(t_1, m)$, and we obtain
    ${t_1}^? \equiv {\mathpzc{carv}(t_1, m)}^?$, from (E-Opt-canon).
    Then ${t_1}^? \equiv {{\mathpzc{carv}(t_1, m)}^?}^{m_1 \!+\! 1}$ where
    $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$, from
    (E-Ins-canon-R). And finally,
    ${{t_1}^?}^i \equiv {{\mathpzc{carv}(t_1, m)}^?}^{m_1 \!+\! 1}$, from
    (E-Ins-canon-L). かつ
    ${{\mathpzc{carv}(t_1, m)}^?}^{m_1 \!+\! 1} = \mathpzc{carv}\Bigl(
    {{t_1}^?}^i, m \Bigr)$, from def. of $\mathpzc{carv}$.
    故に${{t_1}^?}^i \equiv \mathpzc{carv}\Bigl({{t_1}^?}^i, m \Bigr)$.
    
    Case ${{t_1}^\leftarrow}^i$:
    By I.H. $t_1 \equiv \mathpzc{carv}(t_1, m)$, and we obtain
    ${t_1}^\leftarrow \equiv {\mathpzc{carv}(t_1, m)}^\leftarrow$, from
    (E-Alt-canon-L). Then ${t_1}^\leftarrow \equiv
    {{\mathpzc{carv}(t_1, m)}^\leftarrow}^{m_1 \!+\! 1}$ where
    $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$, from
    (E-Ins-canon-R). And finally, ${{t_1}^\leftarrow}^i \equiv
    {{\mathpzc{carv}(t_1, m)}^\leftarrow}^{m_1 \!+\! 1}$, from (E-Ins-canon-L).
    かつ${{\mathpzc{carv}(t_1, m)}^\leftarrow}^{m_1 \!+\! 1} =
    \mathpzc{carv}\bigl({{t_1}^\leftarrow}^i, m \bigr)$, from def. of
    $\mathpzc{carv}$.
    故に${{t_1}^\leftarrow}^i \equiv \mathpzc{carv}\bigl(
    {{t_1}^\leftarrow}^i, m \bigr)$.
    
    Case ${{t_1}^\rightarrow}^i$:
    Same as the case of ${{t_1}^\leftarrow}^i$, from (E-Alt-canon-R).
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma} \label{range_of_term-id}
  \[ m \le \mathpzc{id}\bigl(\mathpzc{carv}(t, m) \bigr)
  \]
  \begin{Proof}
    Proof is induction on structure of $t$.
    
    Case $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From def. of $\mathpzc{carv}$, $\mathpzc{carv}(t_0, m) = {t_0}^m$, by
    lemma \ref{grandterm_equivalence}, then
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_0, m) \bigr) =
    \mathpzc{id}({t_0}^m) = m \ge m$.
    
    Case $t_1$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same as the case of
    $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case $t_1 \wedge t_2$:
    From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}(t_1 \wedge t_2, m) =
    \bigl(\mathpzc{carv}(t_1, m) \wedge \mathpzc{carv}(t_2, m_1 + 1)
    \bigr)^{m_2 +1}$, where $m_1 = \mathpzc{id}\bigl(carv(t_1, m) \bigr)$
    and $m_2 = \mathpzc{id}\bigl(carv(t_2, m_1 + 1) \bigr)$. ここで
    by I.H. $m \le \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) =
    m_1$より$m < m_1 + 1$を得る. 同様に by I.H. 
    $m_1 + 1 \le \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) =
    m_2$より$m_1 + 1 < m_2 + 1$を得る. かつ
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr) = m_2 + 1$
    より$m < m_1 + 1 < m_2 + 1 = \mathpzc{id}\bigl(\mathpzc{carv}(
    t_1 \wedge t_2, m) \bigr)$. 故に
    $m \le \mathpzc{id}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m ) \bigr)$.
    
    Case $t_1 \vee t_2$:  Same as the case of $t_1 \wedge t_2$.
    
    Case $\{\}$: From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}\bigl(\{\}, m \bigr) = {\{\}}^m$, by lemma
    \ref{nil_equivalence}, then
    $\mathpzc{id}\Bigl(\mathpzc{carv}\bigl(\{\}, m \bigr) \Bigr) =
    \mathpzc{id}\bigl({\{\}}^m \bigr) = m \ge m$.
    
    Case $\{t_1\}$: From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}\bigl(\{t_1\}, m \bigr) = \mathpzc{carv}_{\{\}}\bigl(
    \{t_1\}, m \bigr) = {\bigl\{\mathpzc{carv}(t_1, m) \bigr\}}^{m_1 +1}$,
    where $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$.
    ここで by I.H. $m \le \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigl)
    = m_1$より \\
    $m < m_1 + 1 =  \mathpzc{id}\Bigl({\bigl\{\mathpzc{carv}(t_1, m)
    \bigr\}}^{m_1 + 1} \Bigr) = \mathpzc{id}\Bigl(\mathpzc{carv}\bigl(
    \{t_1\}, m \bigr) \Bigr)$を得る. 故に
    $m \le \mathpzc{id}\Bigl(\mathpzc{carv}\bigl(\{t_1\}, m \bigr) \Bigr)$.
    
    Case $\{t_1 \cdots t_n \}$: From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) =
    \mathpzc{carv}_{\{\}}\bigl(\{t_1 \cdots t_n \}, m \bigr) =$  \\
    ${\bigl\{\mathpzc{carv}(t_1, m), t'_2 \cdots t'_n \bigr\}}^{m'}$, where
    ${\{t'_2 \cdots t'_n \}}^{m'} = \mathpzc{carv}\Bigl(
    \{t_2 \cdots t_n\}^i, \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)
    + 1 \Bigr)$. ここで
    $m \le \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$, by I.H. より
    $m < \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m ) \bigr) + 1$を得る.
    同様に by I.H. $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1
    \le \mathpzc{id}\biggl(\mathpzc{carv}\Bigl({\{t_2 \cdots t_n \}}^i,
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 \Bigr) \biggr) =
    \mathpzc{id}\bigl({\{t'_2 \cdots t'_n \}}^{m'} \bigr) = m'$より
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 \le m'$を得る.
    よって$m < \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 \le m'$
    より$m < m' = $ \\
    $\mathpzc{id}\Bigl({\bigl\{\mathpzc{carv}(t_1, m), t'_2 \cdots t'_n
    \bigr\}}^{m'} \Bigr) = \mathpzc{id}\Bigl(\mathpzc{carv}\bigl(
    \{t_1 \cdots t_n\}, m \bigr) \Bigr)$, 故に
    $m \le \mathpzc{id}\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m
    \bigr) \Bigr)$.
    
    Case $[t_1 \cdots t_n]$: Same as the case of $\{t_1 \cdots t_n \}$.
    
    Case $\langle t_1 \cdots t_n \rangle$:
    Same as the case of $[t_1 \cdots t_n ]$.
    
    Case $\circ$:
    From def. of $\mathpzc{carv}$, $\mathpzc{carv}(\circ, m) = \circ^m$,
    from lemma \ref{nil_equivalence}, then
    $\mathpzc{id}\bigl(\mathpzc{carv}(\circ, m ) \bigr) = \mathpzc{id}(
    \circ^m) = m \ge m$.
    
    Case ${t_1}^?$:
    From def. of $\mathpzc{carv}$, $\mathpzc{carv}({t_1}^?, m) =
    {\bigl({\mathpzc{carv}(t_1, m)}^? \bigr)}^
    {\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1}$. ここで by I.H.
    $m \le \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m ) \bigr)$より
    $m < \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 =
    \mathpzc{id}\bigl(\mathpzc{carv}({t_1}^?, m) \bigr)$を得る.
    故に$m \le \mathpzc{id}\bigl(\mathpzc{carv}({t_1}^?, m) \bigr)$.
    
    Case ${t_1}^\leftarrow$:
    From def. of $\mathpzc{carv}$, $\mathpzc{carv}({t_1}^\leftarrow, m) =
    \bigl({\mathpzc{carv}(t_1, m)}^\leftarrow \bigr)^
    {\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1}$. ここで by I.H.
    $m \le \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$より
    $m < \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 =
    \mathpzc{id}\bigl(\mathpzc{carv}({t_1}^\leftarrow, m) \bigr)$を得る.
    故に$m \le \mathpzc{id}\bigl(\mathpzc{carv}({t_1}^\leftarrow, m)
    \bigr)$.
    
    Case ${t_1}^\rightarrow$: Same as the case of ${t_1}^\leftarrow$.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Definition}{supremum of subterms} \label{supremum_of_subterms}
  \[ \mathpzc{sup}(t) \,\stackrel{\mathrm{def}}{:=}\;
      \mathpzc{id}(t')\ \text{\it for some}\ t' \in \mathpzc{sub}(t)\
       \text{\it s.t.}\ \bigl(\forall t'' \in \mathpzc{sub}(t) \bigr).\bigl[
        \mathpzc{id}(t'') \le \mathpzc{id}(t') \bigr]
  \]
\end{Definition}


\begin{Definition}{infimum of subterms} \label{infimum_of_subterms}
  \[ \mathpzc{inf}(t) \,\stackrel{\mathrm{def}}{:=}\;
      \mathpzc{id}(t')\ \text{\it for some}\ t' \in \mathpzc{sub}(t)\
       \text{\it s.t.}\ \bigl(\forall t'' \in \mathpzc{sub}(t) \bigr).\bigl[
        \mathpzc{id}(t') \le \mathpzc{id}(t'') \bigr]
  \]
\end{Definition}


\begin{Lemma}{supremum of term identifier}
\label{supremum_of_term_identifier}
  \[ \mathpzc{sup}(t') = \mathpzc{id}(t'),\ \text{\it where}\
      t' = \mathpzc{carv}(t, m)
  \]
  \begin{Proof}
    Proof is induction on structure of $t$.
    
    Case ${t_0}^i$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From def. of $\mathpzc{carv}$ with lemma \ref{grandterm_equivalence},
    $\mathpzc{carv}(t_0, m) = {t_0}^m$. Then
    $\mathpzc{sub}\bigl(\mathpzc{carv}(t_0, m) \bigr) = \{{t_0}^m \}$, also
    from lemma \ref{grandterm_equivalence}. 故に
    $sup\bigl(\mathpzc{carv}(t, m) \bigr) = \mathpzc{id}({t_0}^m) = m =
    \mathpzc{id}\bigl(\mathpzc{carv}(t_0, m) \bigr)$, from def. of
    $\mathpzc{sup}$.
    
    Case ${t_1}^i$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same as the case of
    ${t_0}^i$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case $(t_1 \wedge t_2)^i$: From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}(t_1 \wedge t_2, m) = \bigl(\mathpzc{carv}(t_1, m) \wedge
    \mathpzc{carv}(t_2, m_1 + 1) \bigr)^{m_2 + 1}$ where
    $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$,
    $m_2 = \mathpzc{id}\bigr(\mathpzc{carv}(t_2, m_1 + 1) \bigr)$. Then
    $\mathpzc{sub}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr) =
    \Bigl\{\bigl(\mathpzc{carv}(t_1, m) \wedge \mathpzc{carv}(t_2, m_1 + 1)
    \bigr)^{m_2+1} \Bigr\} \cup \Bigl(\mathpzc{sub}\bigl(\mathpzc{carv}(
    t_1, m) \bigr) \cup \mathpzc{sub}\bigl(\mathpzc{carv}(t_2, m_1 + 1)
    \bigr) \Bigr)$. ここで
    $m_1 + 1 \le \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) =
    m_2$ from lemma \ref{range_of_term-id}, then $m_1 < m_2$. Then
    $m_2 < m_2 + 1 = \mathpzc{id}\Bigl(\bigl(\mathpzc{carv}(t_1, m) \wedge
    \mathpzc{carv}(t_2, m_1 + 1) \bigr)^{m_2+1} \Bigr)$. よって
    $m_1 < m_2 < \mathpzc{id}\Bigl(\bigl(\mathpzc{carv}(t_1, m) \wedge
    \mathpzc{carv}(t_2, m_1 + 1) \bigr)^{m_2+1} \Bigr)$ where
    $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) =
    \mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m) \bigr)$,
    $m_2 = \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) =
     \mathpzc{sup}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr)$, by I.H. Then
    $\mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m) \bigr) <
    \mathpzc{sup}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) <
    \mathpzc{id}\Bigl(\bigl(\mathpzc{carv}(t_1, m) \wedge
    \mathpzc{carv}(t_2, m_1 + 1) \bigr)^{m_2+1} \Bigr)$ より
    $\mathpzc{sup}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr) =
    \mathpzc{id}\Bigl(\bigl(\mathpzc{carv}(t_1, m) \wedge
    \mathpzc{carv}(t_2, m_1 + 1) \bigr)^{m_2+1} \Bigr) =
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr)$.
    
    Case $(t_1 \vee t_2)^i$: Same as the case of $(t_1 \wedge t_2)^i$.
    
    Case $\{\}^i$: From def. of $\mathpzc{carv}$ and
    lemma \ref{nil_equivalence},
    $\mathpzc{carv}\bigl(\{\}^i, m \bigr) = \{\}^m$. Then
    $\mathpzc{sub}\Bigl(\mathpzc{carv}\bigl(\{\}^i, m \bigr) \Bigr) =
    \mathpzc{sub}\bigl(\{\}^m \bigr) = \bigl\{\{\}^m \bigr\}$, also from
    lemma \ref{nil_equivalence}. 故に
    $\mathpzc{sup}\Bigl(\mathpzc{carv}\bigl(\{\}^i, m \bigr) \Bigr) =
    \mathpzc{id}\bigl(\{\}^m \bigr) = m = \mathpzc{id}\Bigl(
    \mathpzc{carv}\bigl(\{\}^i, $ \\ $m \bigr) \Bigr)$, from def. of
    $\mathpzc{sup}$.
    
    Case $\{t_1 \cdots t_n \}^i$, $n \ge 1$:
    From claim \ref{carv_expansion_cat0}
    $\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}^i, m \bigr) =
    \bigl\{\mathpzc{carv}(t_1, m_1) \cdots \mathpzc{carv}(t_n, m_n)$ \\
    $\bigr\}^{\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}$, where
    $m_j = \left\{ \!\! \begin{array}[c]{l}
       m \quad \text{\it if}\ j = 1  \\
       \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1 \quad
        \text{\it if}\ 2 \le j \le n
     \end{array} \right.$. Then
  $\mathpzc{id}\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n\}^i,$ \\
  $m \bigr) \Bigr) = \mathpzc{id}\bigr(\mathpzc{carv}(t_n, m_n) \bigr) + 1$.
  よって $\mathpzc{sub}\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}^i, m
  \bigr) \Bigr) = \Bigl\{\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}^i, m \bigr)
  \Bigr\} \cup \bigcup_{j=1}^{n} \mathpzc{sub}\bigl($ \\
  $\mathpzc{carv}(t_j, m_j) \bigr)$, from def. of $\mathpzc{sub}$. ここで
  $m_j \le \mathpzc{id}\bigl(\mathpzc{carv}(t_j, m_j) \bigr)$, from lemma
  \ref{range_of_term-id}, かつ
  $m_j = \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1} ) \bigr) + 1$より
  $\mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1 \le
  \mathpzc{id}\bigl(\mathpzc{carv}(t_j, m_j) \bigr)$. よって
  $\mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr)$ \\
  $< \mathpzc{id}\bigl(\mathpzc{carv}(t_j, m_j) \bigr)$であり
  $\mathpzc{id}\bigl(\mathpzc{carv}(t_j, m_j) \bigr) \le \mathpzc{id}\bigl(
  \mathpzc{carv}(t_n, m_n) \bigr)$, $1 \le j \le n$. Then
  $\mathpzc{id}\bigl(\mathpzc{carv}(t_j, m_j) \bigr) < \mathpzc{id}\bigl(
  \mathpzc{carv}(t_n, m_n) \bigr) + 1 = \mathpzc{id}\Bigl(\mathpzc{carv}
  \bigl(\{t_1 \cdots t_n\}^i, m \bigr) \Bigr)$かつ
  $\mathpzc{sup}\bigl(\mathpzc{carv}(t_j, m_j) \bigr) = \mathpzc{id}\bigl(
  \mathpzc{carv}(t_j, m_j) \bigr)$ by I.H. where $1 \le j \le n$. 故に
  $\mathpzc{sup}\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}^i, m \bigr)
  \Bigr) = \mathpzc{id}\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}^i, m
  \bigr) \Bigr)$.
  
  Case $[t_1 \cdots t_n ]^i$: Same as the case of
  $\{t_1 \cdots t_n \}^i$, $n \ge 1$, with claim \ref{carv_expansion_cat1}.
  
  Case $\langle t_1 \cdots t_n \rangle^i$: Same as the case of
  $[t_1 \cdots t_n ]^i$ with claim \ref{carv_expansion_dup}.
  
  Case $\circ^i$:
  From def. of $\mathpzc{carv}$ and lemma \ref{nil_equivalence},
  $\mathpzc{carv}(\circ^i, m ) = \circ^m$. Then
  $\mathpzc{sub}\bigl(\mathpzc{carv}(\circ^i, m) \bigr) = \mathpzc{sub}(
  \circ^m) = \bigl\{\circ^m \bigr\}$, also from lemma
  \ref{nil_equivalence}. 故に
  $\mathpzc{sup}\bigl(\mathpzc{carv}(\circ^i, m) \bigr) = \mathpzc{id}(
  \circ^m) = m = \mathpzc{id}\bigl(\mathpzc{carv}(\circ^i, m) \bigr)$, from
  def. of $\mathpzc{sup}$.
  
  Case ${{t_1}^?}^i$: From def. of $\mathpzc{carv}$,
  $\mathpzc{carv}({{t_1}^?}^i, m) = \bigl({\mathpzc{carv}(t_1, m)}^?
  \bigr)^{\mathpzc{id}\bigl( \mathpzc{carv}(t_1, m) \bigr) + 1}$.
  Then from def. of $\mathpzc{sub}$,
  $\mathpzc{sub}\bigl(\mathpzc{carv}({{t_1}^?}^i, m) \bigr) =
  \Bigl\{\bigl({\mathpzc{carv}(t_1, m)}^? \bigr)^{\mathpzc{id}\bigl(
  \mathpzc{carv}(t_1, m) \bigr) + 1} \Bigr\} \cup \mathpzc{sub}\bigl(
  \mathpzc{carv}(t_1, m) \bigr)$. ここで by I.H.
  $\mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m) \bigr) = \mathpzc{id}\bigl(
  \mathpzc{carv}(t_1, m) \bigr)$より
  $\mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m) \bigr) < \mathpzc{id}\bigl(
  \mathpzc{carv}(t_1, m) \bigr) + 1$. 故に from def. of
  $\mathpzc{sup}$, $\mathpzc{sup}\bigl(\mathpzc{carv}({{t_1}^?}^i, m )
  \bigr) = \mathpzc{id}\Bigl(\bigl({\mathpzc{carv}(t_1, m)}^?
  \bigr)^{\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1} \Bigr) =
  \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 =
  \mathpzc{id}\bigl(\mathpzc{carv}({{t_1}^?}^i, m ) \bigr)$.
  
  Case ${{t_1}^\leftarrow}^i$: From def. of $\mathpzc{carv}$,
  $\mathpzc{carv}({{t_1}^\leftarrow}^i, m) = \bigl(\mathpzc{carv}(t_1, m)^
  \leftarrow \bigr)^{\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1}$.
  Then from def. of $\mathpzc{sub}$,
  $\mathpzc{sub}\bigl(\mathpzc{carv}({{t_1}^\leftarrow}^i, m) \bigr) =
  \Bigl\{\bigl(\mathpzc{carv}(t_1, m)^\leftarrow \bigr)^{\mathpzc{id}\bigl(
  \mathpzc{carv}(t_1, m) \bigr) + 1} \Bigr\} \cup \mathpzc{sub}\bigl(
  \mathpzc{carv}(t_1, m) \bigr)$. ここで by I.H.
  $\mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m) \bigr) = \mathpzc{id}\bigl(
  \mathpzc{carv}(t_1, m) \bigr)$より
  $\mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m) \bigr) < \mathpzc{id}\bigl(
  \mathpzc{carv}(t_1, m) \bigr) + 1$. 故に from def. $\mathpzc{sup}$,
  $\mathpzc{sup}\bigl(\mathpzc{carv}({{t_1}^\leftarrow}^i, m) \bigr) =
  \mathpzc{id}\Bigl(\bigl(\mathpzc{carv}(t_1, m)^\leftarrow \bigr)^{
  \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1} \Bigr) =
  \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 =
  \mathpzc{id}\bigl(\mathpzc{carv}({{t_1}^\leftarrow}^i, m) \bigr)$.
  
  Case ${{t_1}^\rightarrow}^i$: Same as the case of ${{t_1}^\leftarrow}^i$.
  $\Box$
  \end{Proof}
\end{Lemma}


\begin{Claim} \label{carv_expansion_cat0}
  \[  \begin{array}{r}
        \mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) =
         {\bigl\{\mathpzc{carv}(t_1, m_1), \mathpzc{carv}(t_2, m_2) \cdots
          \mathpzc{carv}(t_n, m_n) \bigr\}}^
           {\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}  \\
        ,\text{\it where}\ m_j = \left\{\begin{array}[c]{l}
           m \quad \text{\it if}\;\; j = 1  \\
           \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
            \quad \text{\it if}\;\; 2 \le j \le n
        \end{array} \right.
      \end{array}
  \]
  \begin{Proof}
    Proof is induction on n, as the num of subterms $t_j$.
    
    B.C.) $n = 1$: From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}\bigl(\{t_1\}, m \bigr) = {\mathpzc{carv}}_{\{\}}\bigl(
    \{t_1\}, m \bigr) = {\bigl\{\mathpzc{carv}(t_1, m) \bigr\}}^
    {\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1} =
    {\bigl\{\mathpzc{carv}(t_1, m_1) \bigr\}}^
    {\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) + 1}$, where
    $m_1 = m$.
    
    I.S.) $n \ge 2$: From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) =
    {\mathpzc{carv}}_{\{\}}\bigl(\{t_1 \cdots t_n \}, m \bigr) =
    {\bigl\{\mathpzc{carv}(t_1, m), t'_2 \cdots t'_n \bigr\}}^{m'}$, where
    ${\{t'_2 \cdots t'_n \}}^{m'} = \mathpzc{carv}\Bigl(\{t_2 \cdots t_n \},
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 \Bigr)$.  \\
    ここで by I.H. $\mathpzc{carv}\Bigl(\{t_2 \cdots t_n \},
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 \Bigr) =
    \bigl\{\mathpzc{carv}(t_2, m_2) \cdots \mathpzc{carv}(t_n, m_n) \bigr\}^
    {\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}$, where
    $ m_j = \left\{ \begin{array}[c]{l}
         \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1
          \quad \text{\it if}\;\; j = 2  \\
         \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
          \quad \text{\it if}\;\; 3 \le j \le n
       \end{array} \right.
    $より  \\
    ${\{t'_2 \cdots t'_n \}}^{m'} = \bigl\{\mathpzc{carv}(t_2, m_2)
    \cdots \mathpzc{carv}(t_n, m_n)
    \bigr\}^ {\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}$. Then
    $t'_2 = \mathpzc{carv}(t_2, m_2) \cdots t'_n = \mathpzc{carv}(t_n, m_n)$
    ,where $m' = \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1$.
    よって$\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) =
    {\bigr\{\mathpzc{carv}(t_1, m), t'_2 \cdots t'_n \bigr\}}^{m'} =
    {\bigl\{\mathpzc{carv}(t_1, m), \mathpzc{carv}(t_2, m_2) \cdots
    \mathpzc{carv}(t_n, m_n) \bigr\}}^
    {\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}$, \\ where
    $ m_j = \left\{ \begin{array}[c]{l}
        \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1
         \quad \text{\it if}\;\; j = 2  \\
        \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
         \quad \text{\it if}\;\; 3 \le j \le n
      \end{array} \right.$より
    $\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) =$  \\
    ${\bigl\{\mathpzc{carv}(t_1, m_1), \mathpzc{carv}(t_2, m_2) \cdots
    \mathpzc{carv}(t_n, m_n) \bigr\}}^
    {\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}$, \\ where
    $ m_j = \left\{ \begin{array}[c]{l}
        m \quad \text{\it if}\;\; j = 1  \\
        \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) + 1
         \quad \text{\it if}\;\; j = 2  \\
        \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
         \quad \text{\it if}\;\; 3 \le j \le n
      \end{array} \right.$これはすなわち, \\ where
    $ m_j = \left\{ \begin{array}[c]{l}
        m \quad \text{\it if}\;\; j = 1  \\
        \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
         \quad \text{\it if}\;\; 2 \le j \le n
      \end{array} \right.$である.
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Claim} \label{carv_expansion_cat1}
  \[  \begin{array}{r}
        \mathpzc{carv}\bigl([t_1 \cdots t_n ], m \bigr) =
         {\bigl\{\mathpzc{carv}(t_1, m_1), \mathpzc{carv}(t_2, m_2) \cdots
          \mathpzc{carv}(t_n, m_n) \bigr\}}^
           {\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}  \\
        ,\text{\it where}\ m_j = \left\{\begin{array}[c]{l}
           m \quad \text{\it if}\;\; j = 1  \\
           \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
            \quad \text{\it if}\;\; 2 \le j \le n
        \end{array} \right.
      \end{array}
  \]
  \begin{Proof}
    Proof is similar to claim \ref{carv_expansion_cat0}.
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Claim} \label{carv_expansion_dup}
  \[  \begin{array}{r}
        \mathpzc{carv}\bigl(\langle t_1 \cdots t_n \rangle, m \bigr) =
         {\bigl\{\mathpzc{carv}(t_1, m_1), \mathpzc{carv}(t_2, m_2) \cdots
          \mathpzc{carv}(t_n, m_n) \bigr\}}^
           {\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}  \\
        ,\text{\it where}\ m_j = \left\{\begin{array}[c]{l}
           m \quad \text{\it if}\;\; j = 1  \\
           \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
            \quad \text{\it if}\;\; 2 \le j \le n
        \end{array} \right.
      \end{array}
  \]
  \begin{Proof}
    Proof is similar to claim \ref{carv_expansion_cat1}.
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Lemma}{infimum of term identifier}
\label{infimum_of_term_identifier}
  \[ \mathpzc{inf}(t') = m,\ \text{\it where}\ t' = \mathpzc{carv}(t, m)
  \]
  \begin{Proof}
    Proof is induction on structure of $t$.
    
    Case ${t_0}^i$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From def. of $\mathpzc{carv}$ with lemma \ref{grandterm_equivalence},
    $\mathpzc{carv}(t_0, m) = {t_0}^m$, then $\mathpzc{sub}\bigl(
    \mathpzc{carv}(t_0, m) \bigr) = \{{t_0}^m \}$, also from lemma
    \ref{grandterm_equivalence}. 故に
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_0, m) \bigr) =
    \mathpzc{id}({t_0}^m) = m$, from def. of $inf$.
    
    Case ${t_1}^i$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same as the case of ${t_0}^i$ where
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case $({t_1 \wedge t_2)}^i$: From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}(t_1 \wedge t_2, m) = {\bigl(\mathpzc{carv}(t_1, m)
    \wedge \mathpzc{carv}(t_2, m_1 + 1) \bigr)}^{m_2 + 1}$, where
    $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$,
    $m_2 = \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr)$. よって
    from def. of $\mathpzc{sub}$,
    $\mathpzc{sub}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr) =
    \Bigl\{{\bigl(\mathpzc{carv}(t_1, m) \wedge \mathpzc{carv}(t_2, m_1 + 1)
    \bigr)}^{m_2 + 1} \Bigr\} \cup
    \Bigl(\mathpzc{sub}\bigl(\mathpzc{carv}(t_1, m) \bigr) \cup
    \mathpzc{sub}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) \Bigr)$成立.
    ここで$m \le \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$, from
    lemma \ref{range_of_term-id}. And
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) = m$, by I.H. Then
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) = m \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) = m_1$. また同様に
    $m_1 + 1 \le \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr)$
    also from \ref{range_of_term-id}, and
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) = m_1 + 1$,
    by I.H. Then
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) = m_1 + 1 \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) = m_2$. 故に
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) \le m_1 < m_1 + 1 =
    \mathpzc{inf}\bigl(\mathpzc{carv}(t_2, m_1 + 1) \bigr) \le m_2 < m_2 + 1
    = \mathpzc{id}\Bigl({\bigl(\mathpzc{carv}(t_1, m) \wedge \mathpzc{carv}(
    t_2, m_1 + 1) \bigr)}^{m_2 + 1} \Bigr)$. Then
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr) =
    \mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) = m$, since
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) < \mathpzc{inf}\bigl(
    \mathpzc{carv}(t_2, m_1 + 1) \bigr) < \mathpzc{id}\Bigl(\bigl(
    \mathpzc{carv}(t_1, m) \wedge \mathpzc{carv}(t_2, m_1$ \\
    ${+ 1) \bigr)}^{m_2 + 1} \Bigr)$.
    
    
    Case $({t_1 \vee t_2)}^i$: Same as the case of $({t_1 \wedge t_2)}^i$.
    
    Case ${\{\}}^i$:
    From def. of $\mathpzc{carv}$ with lemma \ref{nil_equivalence}.
    $\mathpzc{carv}\bigl({\{\}}^i, m \bigr) = {\{\}}^m$, then
    $\mathpzc{sub}\Bigl(\mathpzc{carv}\bigl({\{\}}^i, m \bigr) \Bigr) =
    \bigl\{{\{\}}^m \bigr\}$, also from lemma \ref{nil_equivalence}. 故に
    $\mathpzc{inf}\Bigl(\mathpzc{carv}\bigl({\{\}}^i, m \bigr) \Bigr) =
    \mathpzc{id}\bigl({\{\}}^m \bigr) = m$, from def. of $\mathpzc{inf}$.
    
    Case ${\{t_1 \cdots t_n\}}^i$, $n \ge 1$:
    From claim \ref{carv_expansion_cat0},
    $\mathpzc{carv}\bigl({\{t_1 \cdots t_n \}}^i, m \bigr) =
    \bigl\{\mathpzc{carv}(t_1, m_1) \cdots \mathpzc{carv}(t_n, m_n)$ \\
    $\bigr\}^{\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}$,
    where $m_j = \left\{ \!\! \begin{array}[c]{l}
       m \quad \text{\it if}\ j = 1  \\
       \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1} ) \bigr) + 1
        \quad \text{\it if}\ 2 \le j \le n
    \end{array} \right.$. Then $\mathpzc{id}\Bigl(\mathpzc{carv}\bigl(
    {\{t_1 \cdots t_n \}}^i,$  \\  $ m \bigr) \Bigr) =
    \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1$. よって from
    def. of $\mathpzc{sub}$,
    $\mathpzc{sub}\Bigl(\mathpzc{carv}\bigl({\{t_1 \cdots t_n \}}^i, m
    \bigr) \Bigr) = \Bigl\{\mathpzc{carv}\bigl({\{t_1 \cdots t_n \}}^i, $
    \\ $m \bigr) \Bigr\} \cup \bigcup_{j=1}^{n} \mathpzc{sub}\bigl(
    \mathpzc{carv}(t_j, m_j) \bigr) =
    \Bigl\{{\bigl\{\mathpzc{carv}(t_1, m_1) \cdots \mathpzc{carv}(t_n, m_n)
    \bigr\}}^{\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1} \Bigr\}
    \cup \bigcup_{j=1}^{n} \mathpzc{sub}\bigl(\mathpzc{carv}(t_j,$ \\
    $m_j) \bigr)$. ここで $m_{j-1} \le \mathpzc{id}\bigl(\mathpzc{carv}(
    t_{j-1}, m_{j-1}) \bigr)$, from lemma \ref{range_of_term-id}, and
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) = m_{j-1}$
    by I.H. より $\mathpzc{inf}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1})
    \bigr) \le\mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr)$.
    Then $\mathpzc{inf}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr)+ 1$. かつ
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1})
    \bigr) + 1 = m_j$ and $\mathpzc{inf}\bigl(\mathpzc{carv}(t_j, m_j)
    \bigr) = m_j$ by I.H. again, より
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) < m_j =
    \mathpzc{inf}\bigl(\mathpzc{carv}(t_j, m_j) \bigr)$, よって
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) <
    \mathpzc{inf}\bigl(\mathpzc{carv}(t_j, m_j) \bigr)$ where
    $2 \le j \le n$. よって
    $\mathpzc{inf}\Bigl(\mathpzc{carv}\bigl({\{t_1 \cdots t_n \}}^i, m
    \bigr) \Bigr) = \mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) =
    \mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) = m$.
    
    Case ${[t_1 \cdots t_n ]}^i$:
    Same as the case of ${\{t_1 \cdots t_n\}}^i$, $n \ge 1$.

    Case ${\langle t_1 \cdots t_n \rangle}^i$:
    Same as the case of ${[t_1 \cdots t_n ]}^i$.

    Case ${\circ}^i$:
    From def. of $\mathpzc{carv}$ with lemma \ref{nil_equivalence}.
    $\mathpzc{carv}(\circ^i, m) = \circ^m$, then
    $\mathpzc{sub}\bigl(\mathpzc{carv}(\circ^i, m) \bigr) =
    \mathpzc{sub}(\circ^m) = \{\circ^m \}$ also from lemma
    \ref{nil_equivalence}. 故に
    $\mathpzc{inf}\bigl(\mathpzc{carv}(\circ^i, m) \bigr) =
    \mathpzc{id}(\circ^m) = m$, from def. of $\mathpzc{inf}$.

    Case ${{t_1}^?}^i$:
    From def. of $\mathpzc{carv}$,
    $\mathpzc{carv}\bigl({{t_1}^?}^i, m \bigr) =
    {\bigl(\mathpzc{carv}(t_1, m)^? \bigr)}^{
      \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1}$, then
    $\mathpzc{sub}\bigl(\mathpzc{carv}({t_1}^?, m) \bigr)$
    $= \Bigl\{ {\bigl(\mathpzc{carv}(t_1, m)^? \bigr)}^{
      \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1} \Bigr\} \cup
    \mathpzc{sub}\bigl(\mathpzc{carv}(t_1, m) \bigr)$. ここで by I.H. and
    lemma \ref{range_of_term-id},
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr)$
    $= m \le \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 =
    \mathpzc{id}\bigl({\mathpzc{carv}(t_1, m)}^? \bigr)$, then
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) <
    \mathpzc{id}\bigl({\mathpzc{carv}(t_1, m)}^? \bigr)$. 故に
    $\mathpzc{inf}\Bigl(\mathpzc{carv}\bigl({{t_1}^?}^i, m \bigr) \Bigr) =
    \mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) = m$, by I.H. again.

    Case ${{t_1}^\leftarrow}^i$:
    From def. of $\mathpzc{carv}$, $\mathpzc{carv}\bigl({{t_1}^\leftarrow}^i
    ,m \bigr) = {\bigl({\mathpzc{carv}(t_1, m)}^\leftarrow \bigr)}^{
      \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1}$, then
    $\mathpzc{sub}\Bigl(\mathpzc{carv}\bigl({{t_1}^\leftarrow}^i, m \bigr)
    \Bigr)$
    $= \Bigl\{\bigl({\mathpzc{carv}(t_1, m)}^\leftarrow \bigr)^{
      \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1} \Bigr\} \cup
    \mathpzc{sub}\bigl(\mathpzc{carv}(t_1, m) \bigr)$, from def. of
    $\mathpzc{sub}$. ここで by I.H. and lemma \ref{range_of_term-id},
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) = m \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 =
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$より,
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$. 故に
    $\mathpzc{inf}\Bigl(\mathpzc{carv}\bigl({{t_1}^\leftarrow}^i, m \bigr)
    \Bigr) = \mathpzc{inf}\bigl(\mathpzc{carv}(t_1, m) \bigr) = m$, by I.H
    again.
    
    Case ${{t_1}^\rightarrow}^i$:
    Same as the case of ${{t_1}^\leftarrow}^i$.
    $\Box$
  \end{Proof}
\end{Lemma}


\pagebreak
\begin{Definition}{型束縛(BINDING ENVIRONMENT)}
  型束縛$\Gamma$を, 以下のように定義する.
  \begin{displaymath}
    \begin{array}{l}
      \Gamma \,\stackrel{\mathrm{def}}{:=}\, \bigl\{
       (t',\mathcal{R}') \ |\ \Gamma' \vdash t':\mathcal{R}'
        \ \text{\it s.t.}\ \Gamma' \!\subseteq \Gamma \bigr\}  \\
      \Gamma(t) \,\stackrel{\mathrm{def}}{:=}\, \bigl\{
       (t', \mathcal{R}') \ |\ (t', \mathcal{R}') \in \Gamma\
        \text{\it s.t.}\ t' = t \bigr\}
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Definition}{(BINDING DOMAIN)}
  \[ \mathpzc{Dom}(\Gamma) \,\stackrel{\mathrm{def}}{:=}\,
      \bigl\{ t' \ |\ (t', \mathcal{R}') \in \Gamma \bigr\}
  \]
\end{Definition}


\begin{Corollary} \label{dom_bin_join}
  \[ \mathpzc{Dom}(\Gamma_1 \cup \Gamma_2) =
      \mathpzc{Dom}(\Gamma_1) \cup \mathpzc{Dom}(\Gamma_2)
  \]
  \begin{Proof}
    Proof is dirctrly from def. of $\mathpzc{Dom}$.
    
    $\mathpzc{Dom}(\Gamma_1 \cup \Gamma_2) \subseteq
    \mathpzc{Dom}(\Gamma_1) \cup \mathpzc{Dom}(\Gamma_2)$:
    From def. of $\mathpzc{Dom}$,
    $t \in \mathpzc{Dom}(\Gamma_1 \cup \Gamma_2) =
    \bigl\{t' \ |\ (t', \mathcal{R}') \in (\Gamma_1 \cup \Gamma_2)
    \bigr\}$ より $t$ is $t'_1$ s.t. $(t'_1, \mathcal{R}'_1) \in \Gamma_1$
    或は $t'_2$ s.t. $(t'_2, \mathcal{R}'_2) \in \Gamma_2$
    すなわち$t \in \mathpzc{Dom}(\Gamma_1)$或は
    $t \in \mathpzc{Dom}(\Gamma_2)$, from def. of $\mathpzc{Dom}$. よって
    $t \in \bigl(\mathpzc{Dom}(\Gamma_1) \cup \mathpzc{Dom}(\Gamma_2)
    \bigr)$.
    
    $\mathpzc{Dom}(\Gamma_1 \cup \Gamma_2) \supseteq
    \mathpzc{Dom}(\Gamma_1) \cup \mathpzc{Dom}(\Gamma_2)$:
    Now we assume $t \in \bigl(\mathpzc{Dom}(\Gamma_1) \cup
    \mathpzc{Dom}(\Gamma_2) \bigr)$. Then from def. of $\mathpzc{Dom}$,
    $t$ belongs to $\Bigl(\bigl\{ t'_1 \ |\ (t'_1, \mathcal{R}'_1) \!\in\!
    \Gamma_1 \bigr\} \cup \bigl\{ t'_2 \ |\ (t'_2, \mathcal{R}'_2) \!\in\!
    \Gamma_2 \bigr\} \Bigr)$. よって
    $t$ is in $\bigl\{ t'_1 \ |\ (t'_1, \mathcal{R}'_1) \in \Gamma_1
    \bigr\}$ 或は
    $\bigl\{ t'_2 \ |\ (t'_2, \mathcal{R}'_2) \in \Gamma_2 \bigr\}$.
    それ故, $t$ is also in
    $\bigl\{ t'_1 \ |\ (t'_1, \mathcal{R}'_1) \in (\Gamma_1 \cup \Gamma_2)
    \bigr\}$ 或は
    $\bigl\{ t'_2 \ |\ (t'_2, \mathcal{R}'_2) \in (\Gamma_2 \cup \Gamma_1)
    \bigr\}$ respectively. 故に
    $t \in \mathpzc{Dom}(\Gamma_1 \cup \Gamma_2)$, from def. of
    $\mathpzc{Dom}$.
    $\Box$
  \end{Proof}
\end{Corollary}


\begin{Corollary} \label{dom_mul_join}
  \[ \mathpzc{Dom}\Biggl(\bigcup_{j=1}^{n} \Gamma_j \Biggr) =
      \bigcup_{j=1}^{n} \mathpzc{Dom}(\Gamma_j)
  \]
  \begin{Proof}
    Proof is induction on $n$, as num. of
    $\, \Gamma_j,\, \mathpzc{Dom}(\Gamma_j)$.
    
    B.C.): $n = 1$: Trivial.
    $n = 2$: From corollary \ref{dom_bin_join},
    $\mathpzc{Dom}(\Gamma_1 \cup \Gamma_2) = \mathpzc{Dom}(\Gamma_1) \cup
    \mathpzc{Dom}(\Gamma_2)$.
    
    I.S.): $n \ge 3$: $\mathpzc{Dom}\bigl(\bigcup_{j=1}^{n} \Gamma_j \bigr)
    = \mathpzc{Dom}\bigl(\Gamma_1 \cup \bigcup_{j=2}^{n} \Gamma_j \bigr) =
    \mathpzc{Dom}(\Gamma_1) \cup \mathpzc{Dom}\bigl(
    \bigcup_{j=2}^{n} \Gamma_j \bigr)$, from corollary \ref{dom_bin_join}.
    Then, $\mathpzc{Dom}(\Gamma_1) \cup \mathpzc{Dom}\bigl(
    \bigcup_{j=2}^{n} \Gamma_j \bigr) = \mathpzc{Dom}(\Gamma_1) \cup
    \bigl(\bigcup_{j=2}^{n} \mathpzc{Dom}(\Gamma_j) \bigr)$, by I.H.
    故に $\mathpzc{Dom}(\Gamma_1) \cup \bigl(
    \bigcup_{j=2}^{n} \mathpzc{Dom}(\Gamma_j) \bigr) =
    \bigcup_{j=1}^{n} \mathpzc{Dom}(\Gamma_j)$ より
    $\mathpzc{Dom}\bigl(\bigcup_{j=1}^{n} \Gamma_j) =
    \bigcup_{j=1}^{n} \mathpzc{Dom}(\Gamma_j)$.
    $\Box$
  \end{Proof}
\end{Corollary}


\begin{Corollary} \label{dom_sub}
  \[ \mathpzc{Dom}(\Gamma_1 \setminus \Gamma_2) =
      \mathpzc{Dom}(\Gamma_1) \setminus \mathpzc{Dom}(\Gamma_2)
  \]
\end{Corollary}


\pagebreak
\begin{Definition}{正準表現項に関する型照合(PATTERN MATCHING ON CANONICAL
  TERMS)}
  正準表現項$t$の, 型$\mathcal{R}$に対する型照合の定義を, 以下のように
  拡張する.
  \begin{displaymath}
    \begin{array}{c}
      \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{
            \dfrac{}{ t \equiv t_0\ \text{\it where}\
                       (t_0, \mathcal{R}_0) \!\in\! \Gamma_{gnd} }
          }{
            \bigl\{(t, \mathcal{R}_0) \bigr\} \vdash t : \mathcal{R}_0
          }  &  \!\! \text{\it (T-Atom0-canon)}
        \end{array}
        
        & \begin{array}{rl}
            \dfrac{
              \dfrac{}{ t \equiv t_1\ \text{\it where}\
                         (t_1, \mathcal{R}_1) \!\in\! \Gamma_{def} }
            }{
              \bigl\{(t, \mathcal{R}_1) \bigr\} \vdash t : \mathcal{R}_1
            }  &  \!\! \text{\it (T-Atom1-canon)}
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Gamma_1 \vdash t_1 : \mathcal{R}_1
             \quad \Gamma_2 \vdash t_2 : \mathcal{R}_2
              \quad \mathpzc{Dom}(\Gamma_1) \cap \mathpzc{Dom}(\Gamma_2)
              = \phi  \\
              t_1 \wedge t_2 \not\in \bigl(\mathpzc{Dom}(\Gamma_1) \cup
               \mathpzc{Dom}(\Gamma_2) \bigr)
          \end{array}
        }{
          \bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2)
           \bigr\} \cup (\Gamma_1 \cup \Gamma_2) \vdash
            t_1 \wedge t_2 : \mathcal{R}_1 \wedge \mathcal{R}_2
        }  &  \text{\it (T-Cas-canon)}  \\
        \\
        
        \dfrac{
          \begin{array}{c}
            \Gamma_1 \vdash t_1 : \mathcal{R}_1
             \quad \Gamma_2 \vdash t_2 : \mathcal{R}_2
              \quad \mathpzc{Dom}(\Gamma_1) \cap \mathpzc{Dom}(\Gamma_2)
               = \phi  \\
            t_1 \vee t_2 \not\in \bigl(\mathpzc{Dom}(\Gamma_1) \cup
             \mathpzc{Dom}(\Gamma_2) \bigr)
          \end{array}
        }{
          \bigl\{(t_1 \vee t_2, \mathcal{R}_1 \vee \mathcal{R}_2) \bigr\}
           \cup (\Gamma_1 \cup \Gamma_2) \vdash
            t_1 \vee t_2 : \mathcal{R}_1 \vee \mathcal{R}_2
        }  &  \text{\it (T-Par-canon)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            \dfrac{}{
              t \equiv \{\}
               \quad \mathcal{R}_1\,\text{\it is}\, \text{\it Any}.
            }
          }{
            \bigl\{(t, {\mathcal{R}_1}^* ) \bigr\} \vdash
             t: {\mathcal{R}_1}^*
          }  &  (\text{\it nil}\,)  \\
          \\
          \dfrac{
            \begin{array}{c}
              \Gamma_1 \vdash t_1 : \mathcal{R}_1 \,\cdots\,
               \Gamma_n \vdash t_n : \mathcal{R}_1,\
                \text{\it s.t.}\ n \ge 1  \\
              \mathpzc{Dom}(\Gamma_j) \!\cap\! \mathpzc{Dom}(\Gamma_k) \!=\!
               \phi \ \text{\it s.t.}\; j \!\neq\! k
              \quad \{t_1 \cdots t_n \} \not\in
               \bigcup_{j=1}^{n}\mathpzc{Dom}(\Gamma_j)
            \end{array}
          }{
            \Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr)
             \Bigr\} \cup {\displaystyle \bigcup_{j = 1}^{n}} \Gamma_j
              \vdash \{t_1 \cdots t_n \} : {\mathcal{R}_1}^*
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Cat0-canon)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Gamma_1 \vdash t_1 : \mathcal{R}_1 \,\cdots\,
             \Gamma_n \vdash t_n : \mathcal{R}_1,\
              \text{\it s.t.}\ n \ge 1 \\
            \mathpzc{Dom}(\Gamma_j) \cap \mathpzc{Dom}(\Gamma_k) = \phi
             \ \text{\it s.t.}\; j \!\neq\! k
            \quad [t_1 \cdots t_n ] \not\in \bigcup_{j=1}^{n}
             \mathpzc{Dom}(\Gamma_j)
          \end{array}
        }{
          \Bigl\{\bigl([t_1 \cdots t_n], {\mathcal{R}_1}^+ \bigr) \Bigr\}
           \cup {\displaystyle \bigcup_{j = 1}^{n}} \Gamma_j
            \vdash [t_1 \cdots t_n] : {\mathcal{R}_1}^+
        }  &  \text{\it (T-Cat1-canon)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Gamma_1 \vdash t_1 : \mathcal{R}_1 \,\cdots\,
             \Gamma_n \vdash t_n : \mathcal{R}_1\
              \text{\it s.t.}\ n \ge 1 \\
            \mathpzc{Dom}(\Gamma_j) \cap \mathpzc{Dom}(\Gamma_k) = \phi
             \ \text{\it s.t.}\; j \!\neq\! k
            \quad \langle t_1 \cdots t_n \rangle \not\in \bigcup_{j=1}^{n}
             \mathpzc{Dom}(\Gamma_j)
          \end{array}
        }{
          \Bigl\{\bigl(\langle t_1 \cdots t_n \rangle,
          {\mathcal{R}_1}^\downarrow \bigr) \Bigr\}
          \cup {\displaystyle \bigcup_{j = 1}^{n}} \Gamma_j \vdash
          \langle t_1 \cdots t_n \rangle : {\mathcal{R}_1}^\downarrow
        }  &  \text{\it (T-Dup-canon)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            \dfrac{}{
              t \equiv \circ
              \quad \mathcal{R}_1 \,\text{\it is}\, \text{\it Any}.
            }
          }{
            \bigl\{(t, {\mathcal{R}_1}^? ) \bigr\}
             \vdash t : {\mathcal{R}_1}^?
          }  &  (\text{\it nil}\,)  \\
          \\
          \dfrac{
            \Gamma_1 \vdash t_1 : \mathcal{R}_1
            \quad {t_1}^? \not\in \mathpzc{Dom}(\Gamma_1)
          }{
            \bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\} \cup \Gamma_1 \vdash
             {t_1}^? : {\mathcal{R}_1}^?
          }  &  (\text{\it sol}\,)
        \end{array} \right\}  &  \text{\it (T-Opt-canon)}
      \end{array}
    \end{array}
  \end{displaymath}
  
  %% \pagebreak
  \begin{displaymath}
    \begin{array}{c}
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            \Gamma_1 \vdash t_1 : \mathcal{R}_1
            \quad \mathcal{R}_2 \,\text{\it is}\, \text{\it Any}
            \quad {t_1}^{\leftarrow} \not\in \mathpzc{Dom}(\Gamma_1)
          }{
            \bigl\{({t_1}^\leftarrow, \mathcal{R}_1 | \mathcal{R}_2)
             \bigr\} \cup \Gamma_1 \vdash {t_1}^\leftarrow :
              \mathcal{R}_1 | \mathcal{R}_2
          }  &  (\text{\it L}\,)  \\
          \\
          \dfrac{
            \mathcal{R}_1 \,\text{\it is}\, \text{\it Any}
            \quad \Gamma_1 \vdash t_1 : \mathcal{R}_2
            \quad {t_1}^{\rightarrow} \not\in \mathpzc{Dom}(\Gamma_1)
          }{
            \bigl\{({t_1}^{\rightarrow}, \mathcal{R}_1 | \mathcal{R}_2)
             \bigr\} \cup \Gamma_1 \vdash {t_1}^\rightarrow :
              \mathcal{R}_1 | \mathcal{R}_2
          }  &  (\text{\it R}\,)
        \end{array} \right\}  &  \text{\it (T-Alt-canon)}
      \end{array}  
    \end{array}
  \end{displaymath}  
\end{Definition}
\pagebreak

\begin{Lemma}{determinacy of finalizer} \label{determinacy_of_finalizer}
  \begin{center}
    $\Gamma \vdash t : \mathcal{R}$, where
    the LAST-applied rule is deterministic for syntax of $t$, as
    \[ \begin{array}{rl}
         t \equiv t_0\ \text{\it where}\
          (t_0, \mathcal{R}_0) \in \Gamma_{gnd}:
          &  \mbox{(T-Atom0-canon)}  \\
         t \equiv t_1\ \text{\it where}\
          (t_1, \mathcal{R}_1) \in \Gamma_{def}:
          &  \mbox{(T-Atom1-canon)}  \\
         t_1 \wedge t_2:  &  \mbox{(T-Cas-canon)}  \\
         t_1 \vee t_2:  &  \mbox{(T-Par-canon)}  \\
         t \equiv \{\}:  &  \mbox{(T-Cat0-canon-nil)}  \\
         \{t_1 \cdots t_n \}:  &  \mbox{(T-Cat0-canon-$\infty$)}  \\
         
         [t_1 \cdots t_n]:  &  \mbox{(T-Cat1-canon)}  \\
         \langle t_1 \cdots t_n \rangle:  &  \mbox{(T-Dup-canon)}  \\
         t \equiv \circ\:  &  \mbox{(T-Opt-canon-nil)}  \\
         {t_1}^?: &  \mbox{(T-Opt-canon-sol)}  \\
         {t_1}^\leftarrow:  &  \mbox{(T-Alt-canon-L)}  \\
         {t_1}^\rightarrow:  &  \mbox{(T-Alt-canon-R)}
       \end{array}
    \]
  \end{center}
  \begin{Proof}
    Proof is from def. of matching-rules, and lemma
    \ref{grandterm_equivalence}, \ref{user-defined-term_equivalence},
    \ref{nil_equivalence}.
    
    Case $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From lemma \ref{grandterm_equivalence},
    ${t_0}^i \equiv t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$
    holds. Then $\bigl\{({t_0}^i, \mathcal{R}_0) \bigr\} \vdash
    {t_0}^i : \mathcal{R}_0$ を得る, from (T-Atom0-canon).
    一方, from lemma \ref{user-defined-term_equivalence},
    ${t_0}^i \not\equiv t_1$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$,
    since $t_0 \not\in \Gamma_{def}$.
    Then (T-Atom1-canon) cannot be the last applied rule.
    同様に, (T-Cat0-canon-nil) and (T-Opt-canon-nil) aren't the last rule,
    from Lemma \ref{nil_equivalence}, for
    $\{\},\, \circ \not \in \Gamma_{gnd}$ respectively.
    かつ from it's syntax, (T-Cas-canon), (T-Par-canon),
    (T-Cat0-canon-$\infty$), (T-Cat1-canon), (T-Dup-canon),
    (T-Opt-canon-sol), (T-Alt-canon-L), (T-Alt-canon-R) の何れも
    the last applied rule とはなり得ない.
    故に we can determine that the last applied rule is only
    (T-Atom0-canon).
    
    Case $t_1$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same as the case of $t_0$ where
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    And the last applied rule is (T-Atom1-canon).
    
    Case $t_1 \wedge t_2$:
    From lemma \ref{grandterm_equivalence},
    $t_1 \wedge t_2 \not\equiv t_0$ where
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$, since
    $t_1 \wedge t_2 \not\in \Gamma_{gnd}$.
    Then (T-Atom0-canon) isn't the last applied rule.    
    同様に, (T-Atom1-canon) isn't the last rule, from
    Lemma \ref{user-defined-term_equivalence}, for
    $t_1 \wedge t_2 \not\in \Gamma_{def}$.
    また (T-Cat0-canon-nil) and (T-Opt-canon-nil) aren't also the last rule,
    from Lemma \ref{nil_equivalence}.
    かつ from it's syntax, (T-Par-canon), (T-Cat0-canon-$\infty$),
    (T-Cat1-canon), (T-Dup-canon), (T-Opt-canon-sol), (T-Alt-canon-L),
    (T-Alt-canon-R) は何れも the last applied rule とはなり得ない.
    故に, the last applied rule is (T-Cas-canon).
    
    Case $t_1 \vee t_2$:
    Same as the case of $t_1 \wedge t_2$.
    And the last applied rule is (T-Par-canon).
    
    Case ${\{\}}$:
    Since $\{\} \not\in \Gamma_{gnd}, \, \Gamma_{def}$, both (T-Atom0-canon)
    and (T-Atom1-canon) aren't the last applied rule, from lemma
    \ref{grandterm_equivalence} and \ref{user-defined-term_equivalence}
    respectively.
    Similar to above cases, (T-Opt-canon-nil) isn't also the last rule,
    from lemma \ref{nil_equivalence}.
    また from it's syntax, (T-Cas-canon), (T-Par-canon),
    (T-Cat0-canon-$\infty$), (T-Cat1-canon), (T-Dup-canon),
    (T-Opt-canon-sol), (T-Alt-canon-L), (T-Alt-canon-R) は何れも
    the last applied rule とはなり得ない.
    故に we can predicate that the last applied rule is (T-Cat0-canon-nil).
    
    Case $\{t_1 \cdots t_n \}$:
    By same reasons in the case of $\{\}$, we can exclude (T-Atom0-canon)
    ,(T-Atom1-canon) and (T-Opt-canon-nil).
    かつ (T-Cat0-canon-nil) isn't also the last rule, from lemma
    \ref{nil_equivalence}, for $\{t_1 \cdots t_n\},\, n \ge 1$.
    また from it's syntax, (T-Cas-canon), (T-Par-canon), (T-Cat1-canon),
    (T-Dup-canon), (T-Opt-canon-sol), (T-Alt-canon-L), (T-Alt-canon-R) は
    何れも the last applied rule にはなり得ない.
    故に (T-Cat0-canon-$\infty$) is the last.
    
    Case $[t_1 \cdots t_n]$:
    Same as the case of $\{t_1 \cdots t_n \}$.
    And the last applied rule is (T-Cat1-canon).
    
    Case $\langle t_1 \cdots t_n \rangle$:
    Same as the case of $[t_1 \cdots t_n ]$.
    And the last applied rule is (T-Dup-canon).
    
    Case $\circ$:
    Similar to the case of $\{\}$.
    Then the last applied rule is (T-Opt-canon-nil).
    
    Case ${t_1}^?$:
    By same reasons in the case of $\{t_1 \cdots t_n \}$, all of these,
    (T-Atom0-canon), (T-Atom1-canon), (T-Cat0-canon-nil), (T-Opt-canon-nil),
    aren't the last applied rule.
    かつ from it's syntax, (T-Cas-canon), (T-Par-canon),
    (T-Cat0-canon-$\infty$), (T-Cat1-canon), (T-Dup-canon), (T-Alt-canon-L),
    (T-Alt-canon-R) are also excluded.
    故に we can determine the last applied rule as (T-Opt-canon-sol).
    
    Case ${t_1}^\leftarrow$:
    By same reasons in the case of ${t_1}^?$, all of these,
    (T-Atom0-canon), (T-Atom1-canon), (T-Cat0-canon-nil), (T-Opt-canon-nil),
    aren't the last applied rule.
    かつ from it's syntax, (T-Cas-canon), (T-Par-canon),
    (T-Cat0-canon-$\infty$), (T-Cat1-canon), (T-Dup-canon),
    (T-Opt-canon-sol) and (T-Alt-canon-R) are also excluded.
    故に last applied rule is (T-Alt-canon-L).
    
    Case ${t_1}^\rightarrow$:
    Same as the case of ${t_1}^\leftarrow$.
    And the last applied rule is (T-Alt-canon-R).
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{uniqueness of deduction for typematching}
\label{uniqueness_of_deduction_for_typematching} 
  \begin{center}
    If $t$ is typed as $\mathcal{R}$ under some environment $\Gamma$
     s.t. $\Gamma \vdash t: \mathcal{R}$,  \\
    then deduction for $\Gamma \vdash t: \mathcal{R}$ is UNIQUE
  \end{center}
  \begin{Proof}
    Proof is induction on structure of $t$

    Case $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From lemma \ref{grandterm_equivalence}, and lemma
    \ref{determinacy_of_finalizer}, the last applied rule is (T-Atom0-canon).
    Then the judgement $\Gamma \vdash t_0: \mathcal{R}$
    reveals as $\bigl\{(t_0, \mathcal{R}_0) \bigr\} \vdash t_0:
    \mathcal{R}_0$, s.t $t_0 \equiv t_0$ where $(t_0, \mathcal{R}_0) \in
    \Gamma_{gnd}$より That's UNIQUE for deduction, from def. of
    $\Gamma_{gnd}$.
    
    Case $t_1$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same as the case of
    $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.

    Case $t_1 \wedge t_2$:
    From lemma \ref{determinacy_of_finalizer}, the last applied rule is
    (T-Cas-canon). Then $\Gamma \vdash t_1 \wedge t_2: \mathcal{R}$ reveals
    as $\Gamma = \bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2)
    \bigr\} \cup (\Gamma_1 \cup \Gamma_2)$ and
    $\mathcal{R} = \mathcal{R}_1 \wedge \mathcal{R}_2$ s.t.
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$ as its subderivations.
    ここで deductions of both $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$ are UNIQUE, by I.H. 故に deduction
    of $\bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2) \bigr\}
    \cup (\Gamma_1 \cup \Gamma_2) \vdash t_1 \wedge t_2:
    \mathcal{R}_1 \wedge \mathcal{R}_2$ is also UNIQUE, by (T-Cas-canon).

    Case $t_1 \vee t_2$:
    Same as the case of $t_1 \wedge t_2$.

    Case $\{\}$:
    From lemma \ref{nil_equivalence} with lemma
    \ref{determinacy_of_finalizer} , the last applied rule is
    (T-Cat0-canon-nil).
    Then jugdment $\Gamma \vdash \{\}: \mathcal{R}$ is
    $\Bigl\{\bigl(\{\}, {\mathcal{R}_1}^* \bigr) \Bigr\} \vdash \{\}:
    {\mathcal{R}_1}^*$ s.t. $\{\} \equiv \{\}$ より its deduction is UNIQUE.
    
    Case $\{t_1 \cdots t_n\}, n \ge 1$:
    From lemma \ref{determinacy_of_finalizer}, the last rule applied
    is (T-Cas-canon-$\infty$). Then
    $\Gamma \vdash \{t_1 \cdots t_n \}: \mathcal{R}$ has
    $\Gamma = \Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr)
    \Bigr\} \cup \bigcup_{j=1}^{n} \Gamma_j$ and
    $\mathcal{R} = {\mathcal{R}_1}^*$, s.t.
    $\Gamma_j \vdash t_j: \mathcal{R}_1$ where $1 \le j \le n$ as it's
    subderivations. ここで for all subderivations
    $\Gamma_j \vdash t_j: \mathcal{R}_1$, each deduction is UNIQUE by I.H.
    故に deduction of
    $\Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr) \Bigr\} \cup
    \bigcup_{j=1}^{n} \Gamma_j \vdash \{t_1 \cdots t_n\}: {\mathcal{R}_1}^*$
    is also UNIQUE, by (T-Cas-canon-$\infty$).

    Case $[t_1 \cdots t_n]$:
    Same as the caes of $\{t_1 \cdots t_n\}$ where $n \ge 1$.

    Case $\langle t_1 \cdots t_n \rangle$:
    Same as the case of $[t_1 \cdots t_n]$.

    Case $\circ$:
    Same as the case of that t is $\{\}$.

    Case ${t_1}^?$:
    From lemma \ref{determinacy_of_finalizer}, the last rule is
    (T-Opt-canon-sol), then the judgement
    $\Gamma \vdash {t_1}^?: \mathcal{R}$ reveals as
    $\Gamma = \bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\} \cup \Gamma_1$
    and $\mathcal{R} = {\mathcal{R}_1}^?$ s.t.
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ as its subderivation. ここで
    for subderivation $\Gamma_1 \vdash t_1: \mathcal{R}_1$, which deduction
    is UNIQUE by I.H. よって deduction of
    $\bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\} \cup \Gamma_1 \vdash
    {t_1}^?: {\mathcal{R}_1}^?$ is also UNIQUE, by (T-Opt-canon-sol).
    
    Case ${t_1}^\leftarrow$:
    Same as the case of ${t_1}^?$.
    
    Case ${t_1}^\rightarrow$:
    Same as the case of ${t_1}^\rightarrow$.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Definition}
  \[ \Gamma(t) \;\stackrel{\mathrm{def}}{:=}\! \bigl\{
      (t', \mathcal{R}') \,|\, (t', \mathcal{R}') \in \Gamma
       \ \text{\it s.t.}\ t' = t \bigr\}
  \]
\end{Definition}


\begin{Lemma}{environment extension} \label{environment_extension}
  \[ \Gamma \vdash t : \mathcal{R} \,\Rightarrow\,
      \mathpzc{Dom}(\Gamma) = \mathpzc{sub}(t)
  \]
  \begin{Proof}
    Proof is induction on structure of $t$.
    
    Case $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From lemma \ref{determinacy_of_finalizer}, we can predicate that the last
    applied rule on judgement $\Gamma \vdash t_0: \mathcal{R}$ is
    (T-Atom0-canon). Then $\Gamma = \bigl\{(t_0, \mathcal{R}_0) \bigr\}$,
    and $\mathcal{R}$ is $\mathcal{R}_0$, from def. of (T-Atom0-canon).
    よって $\mathpzc{Dom}(\Gamma) = \mathpzc{Dom}\Bigl(
    \bigl\{(t_0, \mathcal{R}_0) \bigr\} \Bigr) = \{t_0\} =
    \mathpzc{sub}(t_0)$, from def. of $\mathpzc{sub}$ with lemma
    \ref{grandterm_equivalence}.
    
    Case $t_1$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same as the case of
    $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case $t_1 \wedge t_2$:
    From lemma \ref{determinacy_of_finalizer}, the last applied rule is
    (T-Cas-canon), then we can reveal the judgement
    $\Gamma \vdash t_1 \wedge t_2: \mathcal{R}$ as
    $\Gamma = \bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2)
    \bigr\} \cup (\Gamma_1 \cup \Gamma_2)$ and $\mathcal{R}$ is
    $\mathcal{R}_1 \wedge \mathcal{R}_2$ s.t.
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$ as its subderivations. Then
    $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1)$ and
    $\mathpzc{Dom}(\Gamma_2) = \mathpzc{sub}(t_2)$成立 by
    I.H. respectively. よって
    $\mathpzc{Dom}(\Gamma_1 \cup \Gamma_2) =
    \mathpzc{Dom}(\Gamma_1) \cup \mathpzc{Dom}(\Gamma_2) =
    \mathpzc{sub}(t_1) \cup \mathpzc{sub}(t_2)$, by corollary
    \ref{dom_bin_join}. これより
    $\mathpzc{Dom}\Bigl(\bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2) \bigr\} \cup (\Gamma_1 \cup \Gamma_2) \Bigr) =
    \{t_1 \wedge t_2 \} \cup \mathpzc{Dom}(\Gamma_1 \cup \Gamma_2)
    = \{t_1 \wedge t_2 \} \cup \bigl(\mathpzc{sub}(t_1) \cup
    \mathpzc{sub}(t_2) \bigr) = \mathpzc{sub}(t_1 \wedge t_2)$を得る,
    since $\mathpzc{sub}(t_1 \wedge t_2) = \{t_1 \wedge t_2 \} \cup
    \bigl(\mathpzc{sub}(t_1) \cup \mathpzc{sub}(t_2) \bigr)$ from def. of
    $\mathpzc{sub}$.
    
    Case $t_1 \vee t_2$:
    Same as the case of $t_1 \wedge t_2$.
    
    Case $\{\}$:
    From lemma \ref{determinacy_of_finalizer}, the last applied rule is
    (T-Cat0-canon-nil). Then the judgement is
    $\Bigl\{\bigl(\{\}, {\mathcal{R}_1}^* \bigr) \Bigr\} \vdash
    \{\}: {\mathcal{R}_1}^*$. よって
    $\mathpzc{Dom}\biggl(\Bigl\{\bigl(\{\}, {\mathcal{R}_1}^* \bigr)
    \Bigr\} \biggr) = \bigl\{\{\} \bigr\} =
    \mathpzc{sub}\bigl(\{\} \bigr)$, from def. of $\mathpzc{sub}$ with
    lemma \ref{nil_equivalence}.
    
    Case $\{t_1 \cdots t_n \}$:
    From lemma \ref{determinacy_of_finalizer}, the last rule is
    (T-Cat0-canon-$\infty$), and judgement
    $\Gamma \vdash \{t_1 \cdots t_n \}: \mathcal{R}$ reveals as
    $\Gamma = \Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr)
    \Bigr\} \cup \bigcup_{j=1}^{n}\Gamma_j$, and $\mathcal{R}$ is
    ${\mathcal{R}_1}^*$.
    また for each subderivations $\Gamma_j \vdash t_j: \mathcal{R}_1$,
    $\mathpzc{Dom}(\Gamma_j) = \mathpzc{sub}(t_j)$ holds by I.H. よって
    $\bigcup_{j=1}^{n}\mathpzc{Dom}(\Gamma_j) =
    \bigcup_{j=1}^{n}\mathpzc{sub}(t_j)$より
    $\mathpzc{Dom}\bigl(\bigcup_{j=1}^{n}\Gamma_j \bigr) =
    \bigcup_{j=1}^{n}\mathpzc{Dom}(\Gamma_j) =
    \bigcup_{j=1}^{n}\mathpzc{sub}(t_j)$を得る, from corollary
    \ref{dom_mul_join}. \\
    よって$\mathpzc{Dom}\biggl(\Bigl\{\bigl(
    \{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr)\Bigr\}
    \cup \bigcup_{j=1}^{n}\Gamma_j \biggr) =
    \bigl\{\{t_1 \cdots t_n \} \bigr\} \cup
    \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n}\Gamma_j \bigr) =
    \bigl\{\{t_1 \cdots t_n \} \bigr\} \cup \bigl(
    \bigcup_{j=1}^{n}\mathpzc{sub}(t_j) \bigr) =
    \mathpzc{sub}\bigl(\{t_1 \cdots t_n \} \bigr)$, from def. of
    $\mathpzc{sub}$.
    
    Case $[t_1 \cdots t_n ]$:
    Same as the case of $\{t_1 \cdots t_n \}$.
    
    Case $\langle t_1 \cdots t_n \rangle$:
    Same as the case of $[t_1 \cdots t_n ]$.
    
    Case $\circ$:
    From lemma \ref{determinacy_of_finalizer}, the last applied rule is
    (T-Opt-canon-nil). Then judgement is
    $\bigl\{(\circ, {\mathcal{R}_1}^?) \bigr\} \vdash \circ:
    {\mathcal{R}_1}^?$. よって
    $\mathpzc{Dom}\Bigl(\bigl\{(\circ, {\mathcal{R}_1}^?) \bigr\} \Bigr)
    = \{\circ \} = \mathpzc{sub}(\circ)$, from def. of
    $\mathpzc{Dom}$ and $\mathpzc{sub}$ with lemma \ref{nil_equivalence}.
    
    Case ${t_1}^?$:
    From lemma \ref{determinacy_of_finalizer}, the last rule is
    (T-Opt-canon-sol). Then from def. of (T-Opt-canon-sol),
    judgement $\Gamma \vdash {t_1}^?: \mathcal{R}$ reveals as
    $\Gamma = \bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\} \cup \Gamma_1$,
    and $\mathcal{R}$ is ${\mathcal{R}_1}^?$ s.t.
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ as it's subderivation. ここで
    $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1)$, by I.H. より
    $\mathpzc{Dom}\Bigl(\bigl\{({t_1}^?, {\mathcal{R}_1}^?)
    \bigr\} \cup \Gamma_1 \Bigr) = \{{t_1}^?\} \cup \mathpzc{Dom}(\Gamma_1)
    = \{{t_1}^? \} \cup \mathpzc{sub}(t_1) =
    \mathpzc{sub}({t_1}^? )$, from def. of $\mathpzc{sub}$.
    
    Case ${t_1}^\leftarrow$:
    From lemma \ref{determinacy_of_finalizer}, the last rule is
    (T-Alt-canon-L), and judgement is
    $\bigl\{({t_1}^\leftarrow, \mathcal{R}_1 | \mathcal{R}_2) \bigr\}$
    $\cup \Gamma_1 \vdash {t_1}^\leftarrow: \mathcal{R}_1 | \mathcal{R}_2$
    s.t. $\Gamma_1 \vdash t_1: \mathcal{R}_1$ as it's subderivation. ここで
    $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1)$, by I.H. より
    $\mathpzc{Dom}\Bigl(\bigl\{({t_1}^\leftarrow,
    \mathcal{R}_1 | \mathcal{R}_2) \bigr\} \cup \Gamma_1 \Bigr) =
    \{{t_1}^\leftarrow \}\cup \mathpzc{Dom}(\Gamma_1) =
    \{{t_1}^\leftarrow \} \cup \mathpzc{sub}(t_1) =
    \mathpzc{sub}({t_1}^\leftarrow)$, from def. of $\mathpzc{sub}$.
    
    Case ${t_1}^\rightarrow$:
    Same as the case of ${t_1}^\leftarrow$.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{binding identity} \label{binding_identity}
  \[ \Gamma \vdash t: \mathcal{R} \,\Rightarrow\,
      \Gamma(t) = \bigl\{(t, \mathcal{R}) \bigr\}
  \]
  \begin{Proof}
    Proof is directly from def. of matching-rules with lemma
    \ref{environment_extension}.
    
    Case (T-Atom0-canon): Trivially O.K. from def. of (T-Atom0-canon).
    
    Case (T-Atom1-canon): Trivially O.K. from def. of (T-Atom1-canon).
    
    Case (T-Cas-canon):
    The judgement we obtain is
    $\Gamma \vdash t_1 \wedge t_2: \mathcal{R}_1 \wedge \mathcal{R}_2$,
    which $\Gamma = \bigl\{(t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2) \bigr\} \cup
    (\Gamma_1 \cup \Gamma_2)$ s.t.
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$ as its subderivations. ここで
    $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1) \not\ni t_1 \wedge t_2$
    and $\mathpzc{Dom}(\Gamma_2) = \mathpzc{sub}(t_2) \not\ni t_1 \wedge
    t_2$, both from lemma \ref{environment_extension}より
    $\mathpzc{Dom}(\Gamma_1 \cup \Gamma_2) =
    \mathpzc{Dom}(\Gamma_1) \cup \mathpzc{Dom}(\Gamma_2) =
    \bigl(\mathpzc{sub}(t_1) \cup \mathpzc{sub}(t_2) \bigr) \not\ni
    t_1 \wedge t_2$, from corollary \ref{dom_bin_join}. よって
    $\Gamma(t_1 \wedge t_2) =
    \Bigl(\bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2)
    \bigr\} \cup (\Gamma_1 \cup \Gamma_2) \Bigr)(t_1 \wedge t_2) =
    \bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2) \bigr\} \cup
    (\Gamma_1 \cup \Gamma_2)(t_1 \wedge t_2) =
    \bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2) \bigr\}$.
    
    Case (T-Par-canon): Same as the case of (T-Cas-canon).

    Case (T-Cat0-canon-nil): Trivially, from def. of (T-Cat0-canon-nil).

    Case (T-Cat0-canon-$\infty$):
    Now, the judgement is $\Gamma \vdash \{t_1 \cdots t_n \}:
    {\mathcal{R}_1}^*$, which $\Gamma =$ \\
    $\Bigl\{\bigl(\bigl\{t_1 \cdots t_n \}, {\mathcal{R}_1}^*
    \bigr) \Bigr\} \cup \bigcup_{j=1}^{n} \Gamma_j$ s.t.
    $\Gamma_j \vdash t_j: \mathcal{R}_j$ where $1 \le j \le n$ as its
    subderivations. ここで
    $\mathpzc{Dom}(\Gamma_j) = \mathpzc{sub}(t_j) \not\ni \{t_1 \cdots
    t_n \}$, from lemma \ref{environment_extension}より
    $\mathpzc{Dom}\bigl(\bigcup_{j=1}^{n} \Gamma_j \bigr) =
    \bigcup_{j=1}^{n} \mathpzc{Dom}(\Gamma_j) =
    \bigcup_{j=1}^{n} \mathpzc{sub}(t_j) \not\ni \{t_1 \cdots t_n \}$, from
    corollary \ref{dom_mul_join}. よって
    $\Gamma\bigl(\{t_1 \cdots t_n \} \bigr) =
    \biggl(\Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr)
    \Bigr\} \cup \bigcup_{j=1}^{n} \Gamma_j \biggr)\bigl(
    \{t_1 \cdots t_n \} \bigr) =
    \Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr) \Bigr\} \cup
    \bigl(\bigcup_{j=1}^{n} \Gamma_j \bigr)\bigl(\{t_1 \cdots t_n \} \bigr) =
    \Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr) \Bigr\}$.
    
    Case (T-Opt-canon-nil): Trivially O.K. from def. of (T-Opt-canon-nil).
    
    Case (T-Opt-canon-sol):
    The judgement is $\Gamma \vdash {t_1}^?: {\mathcal{R}_1}^?$, which
    $\Gamma = \bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\} \cup \Gamma_1$
    s.t. $\Gamma_1 \vdash t_1: \mathcal{R}_1$ as its subderivation. And
    here $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1) \not\ni {t_1}^?$
    holds, from lemma \ref{environment_extension}, then
    $\Gamma({t_1}^?) = \Bigl(\bigl\{({t_1}^?, {\mathcal{R}_1}^? ) \bigr\}
    \cup \Gamma_1 \Bigr)({t_1}^?) =
    \bigl\{({t_1}^?, {\mathcal{R}_1}^? ) \bigr\} \cup
    \Gamma_1({t_1}^?) = \bigl\{({t_1}^?, {\mathcal{R}_1}^? ) \bigr\}$.
    
    Case (T-Alt-canon-L):
    The judgement is $\Gamma \vdash {t_1}^{\leftarrow}:
    \mathcal{R}_1 | \mathcal{R}_2$, which
    $\Gamma = \bigl\{({t_1}^{\leftarrow}, \mathcal{R}_1 | \mathcal{R}_2)
    \bigr\} \cup \Gamma_1$
    s.t. $\Gamma_1 \vdash t_1: \mathcal{R}_1$ as its subderivation. And
    here $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1) \not\ni
    {t_1}^{\leftarrow}$ holds, from lemma \ref{environment_extension}, then
    $\Gamma({t_1}^{\leftarrow}) = \Bigl(\bigl\{({t_1}^{\leftarrow},
    \mathcal{R}_1 | \mathcal{R}_2) \bigr\} \cup \Gamma_1
    \Bigr)({t_1}^{\leftarrow}) =
    \bigl\{({t_1}^{\leftarrow}, \mathcal{R}_1 | \mathcal{R}_2) \bigr\} \cup
    \Gamma_1({t_1}^{\leftarrow}) =
    \bigl\{({t_1}^{\leftarrow}, \mathcal{R}_1 | \mathcal{R}_2) \bigr\}$.
    
    Case (T-Alt-canon-R): Same as the case of (T-Alt-canon-L).
  \end{Proof}
\end{Lemma}


\begin{Lemma}{supremum of term identifier over environment}
\label{supremum_of_term-id_over_environment}
  \[ \Gamma \vdash t : \mathcal{R} \,\Rightarrow\,
      \bigl(\forall t' \in \mathpzc{Dom}(\Gamma) \bigr)
       .\bigl[\mathpzc{id}(t') \le \mathpzc{sup}(t) \bigr]
  \]
  \begin{Proof}
    Proof is directly from def. of $\mathpzc{sup}$ and lemma
    \ref{environment_extension}.
    
    From def. of $\mathpzc{sup}$, $\bigl(\forall t' \in \mathpzc{sub}(t)
    \bigr).\bigl[\mathpzc{id}(t') \le \mathpzc{sup}(t) \bigr]$成立. かつ
    from lemma \ref{environment_extension},
    $\mathpzc{Dom}(\Gamma) = \mathpzc{sub}(t)$. Then
    $\bigl(\forall t' \in \mathpzc{Dom}(\Gamma) \bigr).\bigl[
    \mathpzc{id}(t') \le \mathpzc{sup}(t) \bigr]$.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{infimum of term identifier over environment}
\label{infimum_of_term-id_over_environment}
  \[ \Gamma \vdash t : \mathcal{R} \,\Rightarrow\,
      \bigl(\forall t' \in \mathpzc{Dom}(\Gamma) \bigr)
       .\bigl[\mathpzc{inf}(t) \le \mathpzc{id}(t') \bigr]
  \]
  \begin{Proof}
    Proof is directly from def. of $\mathpzc{inf}$ and lemma
    \ref{environment_extension}.
    
    From def. of $\mathpzc{inf}$, $\bigl(\forall t' \in \mathpzc{sub}(t)
    \bigr).\bigl[\mathpzc{inf}(t) \le \mathpzc{id}(t') \bigr]$成立. かつ
    from lemma \ref{environment_extension},
    $\mathpzc{Dom}(\Gamma) = \mathpzc{sub}(t)$. Then
    $\bigl(\forall t' \in \mathpzc{Dom}(\Gamma) \bigr).\bigl[\mathpzc{inf}
    (t) \le \mathpzc{id}(t') \bigr]$.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Definition}
  \begin{displaymath}
    \begin{array}{rll}
      \mathpzc{adj}(\Gamma, t, m)  &\stackrel{\mathrm{def}}{:=}
      & \left\{ \begin{array}{l}
          \Bigl\{\bigl(\mathpzc{carv}(t, m), \mathcal{R}_0 \bigr) \Bigr\}
           \quad \text{\it if}\ (t, \mathcal{R}_0) = \Gamma(t)\
            \text{\it s.t.}\ t \equiv t_0,\
             \text{\it where}\ (t_0, \mathcal{R}_0) \in \Gamma_{gnd}  \\
          [7pt]
          \Bigl\{\bigl(\mathpzc{carv}(t, m), \mathcal{R}_1 \bigr) \Bigr\}
           \quad \text{\it if}\ (t, \mathcal{R}_1) = \Gamma(t)\
            \text{\it s.t.}\ t \equiv t_1,\
             \text{\it where}\ (t_1, \mathcal{R}_1) \in \Gamma_{def}  \\
          [7pt]
          \Bigl\{\bigl(\mathpzc{carv}(t_1 \wedge t_2, m),
           \mathcal{R}_1 \wedge \mathcal{R}_2 \bigr) \Bigr\} \cup
            \bigl(\mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_1)}, t_1, m) \cup
             \mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_2)}, t_2, m_1 + 1)
              \bigr)  \\
           \quad ,\text{\it where}\ m_1 = \mathpzc{id}\bigl(
            \mathpzc{carv}(t_1, m) \bigr)
           \quad \text{\it if}\ (t_1 \wedge t_2, \mathcal{R}_1 \wedge
            \mathcal{R}_2) = \Gamma(t)\   \\
          [3pt]
          \Bigl\{\bigl(\mathpzc{carv}(t_1 \vee t_2, m),
           \mathcal{R}_1 \vee \mathcal{R}_2 \bigr) \Bigr\} \cup
            \bigl(\mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_1)}, t_1, m) \cup
             \mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_2)}, t_2, m_1 + 1)
              \bigr)  \\
           \quad ,\text{\it where}\ m_1 = \mathpzc{id}\bigl(
            \mathpzc{carv}(t_1, m) \bigr)
           \quad \text{\it if}\ (t_1 \vee t_2, \mathcal{R}_1 \vee
            \mathcal{R}_2) = \Gamma(t)\   \\
          [3pt]
          \Bigl\{\bigl(\mathpzc{carv}(t, m), \mathcal{R} \bigr) \bigr\}
           \quad \text{\it if}\ (t, \mathcal{R}) = \Gamma(t)\
            \text{\it s.t.}\ t \equiv \{\},\
              \text{\it where}\ \mathcal{R} \equiv {\mathcal{R}_1}^*\,
               \mbox{或} \mathcal{R} \equiv {\mathcal{R}_1}^?  \\
          [11pt]
          \biggl\{\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m),
           {\mathcal{R}_1}^* \Bigr) \biggr\} \cup
            \bigl(\bigcup^{n}_{j=1} \mathpzc{adj}(
             \Gamma|_{\mathpzc{sub}(t_j)}, t_j, m_j) \bigr),\
              \text{\it s.t.}\ n \ge 1  \\
           \quad ,\text{\it where}\ m_j = \left\{ \begin{array}[c]{l}
                   m \;\; \text{\it if}\ j = 1  \\
                    \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1})
                     \bigr) + 1, \;\; 2 \le j \le n
                      \end{array} \right.  \\
           \quad \text{\it if}\ \bigl(\{t_1 \cdots t_n \},
            {\mathcal{R}_1}^* \bigr) = \Gamma(t)  \\
          [5pt]
          \biggl\{\Bigl(\mathpzc{carv}\bigl([t_1 \cdots t_n ], m),
           {\mathcal{R}_1}^+ \Bigr) \biggr\} \cup
            \bigl(\bigcup^{n}_{j=1} \mathpzc{adj}(
             \Gamma|_{\mathpzc{sub}(t_j)}, t_j, m_j) \bigr),\
              \text{\it s.t.}\ n \ge 1  \\
           \quad ,\text{\it where}\ m_j = \left\{ \begin{array}[c]{l}
                   m \;\; \text{\it if}\ j = 1  \\
                    \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1})
                     \bigr) + 1, \;\; 2 \le j \le n
                      \end{array} \right.  \\
           \quad \text{\it if}\ \bigl([t_1 \cdots t_n ],
            {\mathcal{R}_1}^+ \bigr) = \Gamma(t)  \\
          [7pt]
          \biggl\{\Bigl(\mathpzc{carv}\bigl(\langle t_1 \cdots t_n
           \rangle, m), {\mathcal{R}_1}^\downarrow \Bigr) \biggr\} \cup
            \bigl(\bigcup^{n}_{j=1} \mathpzc{adj}(
             \Gamma|_{\mathpzc{sub}(t_j)}, t_j, m_j) \bigr),\
              \text{\it s.t.}\ n \ge 1  \\
           \quad ,\text{\it where}\ m_j = \left\{ \begin{array}[c]{l}
                   m \;\; \text{\it if}\ j = 1  \\
                    \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1})
                     \bigr) + 1, \;\; 2 \le j \le n
                      \end{array} \right.  \\
           \quad \text{\it if}\ \bigl(\langle t_1 \cdots t_n \rangle,
            {\mathcal{R}_1}^\downarrow \bigr) = \Gamma(t)  \\
          [5pt]
          \Bigl\{\bigl(\mathpzc{carv}(t, m), {\mathcal{R}_1}^? \bigr)
          \Bigr\}
           \quad \text{\it if}\ (t, {\mathcal{R}_1}^?) = \Gamma(t)\
            \text{\it s.t.}\ t \equiv \circ  \\
          [7pt]
          \Bigl\{\bigl(\mathpzc{carv}({t_1}^?, m), {\mathcal{R}_1}^? \bigr)
           \Bigr\} \cup
            \mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_1)}, t_1, m)
             \quad \text{\it if}\ ({t_1}^?, {\mathcal{R}_1}^?) = \Gamma(t) \\
          [7pt]
          \Bigl\{\bigl(\mathpzc{carv}({t_1}^\leftarrow, m),
           \mathcal{R}_1 | \mathcal{R}_2 \bigr) \Bigr\} \cup
            \mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_1)}, t_1, m)
             \quad \text{\it if}\ ({t_1}^\leftarrow,
              \mathcal{R}_1 | \mathcal{R}_2 ) = \Gamma(t)  \\
          [7pt]
          \Bigl\{\bigl(\mathpzc{carv}({t_1}^\rightarrow, m),
           \mathcal{R}_1 | \mathcal{R}_2 \bigr) \Bigr\} \cup
            \mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_1)}, t_1, m)
             \quad \text{\it if}\ ({t_1}^\rightarrow,
              \mathcal{R}_1 | \mathcal{R}_2 ) = \Gamma(t)
        \end{array} \right.
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Lemma}{environment rewinding} \label{environment_rewinding}
  \[ \begin{array}{r}
       \Gamma \vdash t: \mathcal{R} \,\Rightarrow\,
        \Bigl(\forall \mathcal{D}'(
         \Gamma_j \!\vdash\! t_j \!:\! \mathcal{R}_j) \in
          \mathcal{D}(\Gamma \!\vdash\! t \!:\! \mathcal{R}) \Bigr).
           \bigl[\Gamma_j = \Gamma|_{\mathpzc{sub}(t_j)} \bigr]  \\

        \mathcal{D}: \text{\it derivation of}\;\;
         \Gamma \vdash t: \mathcal{R}\ \text{\it as}\ 
          \mathcal{D}(\Gamma \vdash t: \mathcal{R}).  \\
        \mathcal{D}': \text{\it subderivation of}\;\;
        \mathcal{D}(\Gamma \vdash t: \mathcal{R}).
     \end{array}
  \]
  \begin{Proof}
    Proof is directly from def. of patternmatching, with lemma
    \ref{environment_extension}.
    
    Case (T-Atom0-canon), (T-Atom1-canon), (T-Cat0-canon-nil),
    (T-Opt-canon-nil): Has no subderivations.
    
    Case (T-Cas-canon):
    From def. of (T-Cas-canon), the judgement
    $\Gamma \vdash t_1 \wedge t_2: \mathcal{R}_1 \wedge \mathcal{R}_2$ has
    $\Gamma = \bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2)
    \bigr\} \cup (\Gamma_1 \cup \Gamma_2)$. また its subderivations are
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$において
    $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1) \not\ni t_1 \wedge t_2$
    and
    $\mathpzc{Dom}(\Gamma_2) = \mathpzc{sub}(t_2) \not\ni t_1 \wedge t_2$,
    both from lemma \ref{environment_extension}. よって
    $\Gamma|_{\mathpzc{sub}(t_1)} = \left.\Bigl(\bigl\{(t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2) \bigr\} \cup
    (\Gamma_1 \cup \Gamma_2) \Bigr)\right|_{\mathpzc{sub}(t_1)} =
    \left.(\Gamma_1 \cup \Gamma_2)\right|_{\mathpzc{sub}(t_1)} = \Gamma_1$,
    since $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1)$ and
    $\mathpzc{sub}(t_1) \cap \mathpzc{Dom}(\Gamma_2) = \phi$ for
    $\mathpzc{Dom}(\Gamma_1) \cap \mathpzc{Dom}(\Gamma_2) = \phi$.
    同様に$\Gamma_2 = \Gamma|_{\mathpzc{sub}(t_2)}$成立.
    
    Case (T-Par-canon): Same as the case of (T-Cas-canon).
    
    Case (T-Cat0-canon-$\infty$):
    From def. of (T-Cat0-canon-$\infty$), we find the judgement is
    $\Gamma \vdash \{t_1 \cdots t_n \}: {\mathcal{R}_1}^*$, which
    $\Gamma =\Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr)
    \Bigr\} \cup \bigcup_{j=1}^{n}\Gamma_j$. また its subderivations are
    $\Gamma_j \vdash t_j: \mathcal{R}_1$ where $1 \le j \le n$ において
    $\mathpzc{Dom}(\Gamma_j) = \mathpzc{sub}(t_j) \not\ni
    \{t_1 \cdots t_n \}$, from lemma \ref{environment_extension}. よって \\
    $\left.\Gamma\right|_{\mathpzc{sub}(t_j)} = \left.\biggl(\Bigl\{\bigl(
    \{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr) \Bigr\} \cup
    \bigcup_{j=1}^{n}\Gamma_j \biggr)\right|_{\mathpzc{sub}(t_j)} =
    \left.\bigl(\bigcup_{j=1}^{n} \Gamma_j \bigr)\right|_{\mathpzc{sub}(t_j)}
    = \Gamma_j$. Since $\mathpzc{Dom}(\Gamma_j) = \mathpzc{sub}(t_j)$ and
    $\mathpzc{sub}(t_j) \cap \mathpzc{Dom}(\Gamma_k) =
    \mathpzc{Dom}(\Gamma_j) \cap \mathpzc{Dom}(\Gamma_k) = \phi$
    if $j \ne k$.
    
    Case (T-Cat1-canon): Same as the case of (T-Cat0-canon-$\infty$).
    
    Case (T-Dup-canon): Same as the case of (T-Cat1-canon).
    
    Case (T-Opt-canon-sol):
    From def. of (T-Opt-canon-sol), the judgement
    $\Gamma \vdash {t_1}^?: {\mathcal{R}_1}^?$ reveals as
    $\Gamma = \bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\} \cup \Gamma_1$.
    かつ its subderivation $\Gamma_1 \vdash t_1: \mathcal{R}_1$において
    $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1) \not\ni {t_1}^?$,
    from lemma \ref{environment_extension}. よって
    $\left.\Gamma\right|_{\mathpzc{sub}(t_1)} = 
    \left.\Bigl(\bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\} \cup
    \Gamma_1 \Bigr)\right|_{\mathpzc{sub}(t_1)} =
    \left.\Gamma_1\right|_{\mathpzc{sub}(t_1)} = \Gamma_1$成立
    
    Case (T-Alt-canon-L):
    From def. of (T-Alt-canon-L), the judgement
    $\Gamma \vdash {t_1}^\leftarrow: \mathcal{R}_1 | \mathcal{R}_2$ is
    $\Gamma = \bigl\{({t_1}^\leftarrow, \mathcal{R}_1 | \mathcal{R}_2)
    \bigr\} \cup \Gamma_1$. また
    its subderivation $\Gamma_1 \vdash t_1: \mathcal{R}_1$において
    $\mathpzc{Dom}(\Gamma_1) = \mathpzc{sub}(t_1) \not\ni {t_1}^\leftarrow$,
    from \ref{environment_extension}. よって
    $\left.\Gamma\right|_{\mathpzc{sub}(t_1)} = \left.\Bigl(\bigl\{
    ({t_1}^\leftarrow, \mathcal{R}_1 | \mathcal{R}_2) \bigr\} \cup
    \Gamma_1 \Bigr)\right|_{\mathpzc{sub}(t_1)} =
    \left.\Gamma_1\right|_{\mathpzc{sub}(t_1)} = \Gamma_1$成立.
    
    Case (T-Alt-canon-R): Same as the case of (T-Alt-canon-L).
  \end{Proof}
\end{Lemma}


\begin{Lemma}{domain flush} \label{domain_flush}
  \[ \Gamma \vdash t : \mathcal{R} \,\Rightarrow\,
      \mathpzc{adj}(\Gamma, t, m) \vdash \mathpzc{carv}(t, m) : \mathcal{R}
  \]
  \begin{Proof}
    Proof is induction on structure of deduction for
    $\Gamma \vdash t: \mathcal{R}$.
    
    Case (T-Atom0-canon):
    From def. of (T-Atom0-canon), judgement is
    $\bigl\{(t, \mathcal{R}_0) \bigr\} \vdash t: \mathcal{R}_0$,
    which $t$ satisfies $t \equiv t_0$ s.t.
    $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$. Then
    $\mathpzc{carv}(t, m) = {t_0}^m$を得る.
    および${t_0}^m \equiv t_0$ from (E-Ins-canon-L), for $t_0 \equiv t_0$
    from (E-Atom0-canon), より
    $\mathpzc{carv}(t, m) \equiv t_0$ where $(t_0, \mathcal{R}_0) \in
    \Gamma_{gnd}$を得る. よって
    $\bigl\{(\mathpzc{carv}(t, m), \mathcal{R}_0) \bigr\} \vdash
    \mathpzc{carv}(t, m): \mathcal{R}_0$, from (T-Atom0-canon). 一方
    $\bigl\{(t, \mathcal{R}_0) \bigr\}(t) = \bigl\{(t, \mathcal{R}_0)
    \bigr\}$ s.t.
    $t \equiv t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$より
    $\mathpzc{adj}(\Gamma, t, m) = \bigl\{(\mathpzc{carv}(t, m),
    \mathcal{R}_0) \bigr\}$, from def. of $\mathpzc{adj}$.
    
    Case (T-Atom1-canon): Same as the case of (T-Atom0-canon).
    
    Case (T-Cas-canon):
    From def. of (T-Cas-canon), judgement is
    $\Gamma \vdash t_1 \wedge t_2: \mathcal{R}_1 \wedge \mathcal{R}_2$,
    which has $\Gamma = \bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2) \bigr\} \cup (\Gamma_1 \cup \Gamma_2)$. かつ
    its subderivations $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$について
    $\mathpzc{adj}(\Gamma_1, t_1, m_1) \vdash \mathpzc{carv}(t_1, m_1):
    \mathcal{R}_1$ and 
    $\mathpzc{adj}(\Gamma_2, t_2, m_2) \vdash \mathpzc{carv}(t_2, m_2):
    \mathcal{R}_2$成立, by I.H respectively, where we let
    $ m_j = \left\{ \begin{array}[c]{l}
        m \quad \text{\it if}\;\; j = 1  \\
        \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) + 1
         \quad \text{\it if}\;\; j = 2
      \end{array} \right.$. この時
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) < 
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) + 1 = m_2 \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_2) \bigr)$ from
    lemma \ref{range_of_term-id}. より
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_2,$ $m_2) \bigr)$. および
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1, m_1)
    \bigr) \cap \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_2, t_2, m_2) \bigr)
    = \phi$成立, from Claim \ref{domain_flush_claim3}. また
    $\mathpzc{carv}(t_1 \wedge t_2, m) =
    {\bigl(\mathpzc{carv}(t_1, m) \wedge \mathpzc{carv}(t_2, m'_1 + 1)
     \bigr)}^{m'_2 + 1}$ where $m'_1 = \mathpzc{id}\bigl(\mathpzc{carv}(
    t_1, m) \bigr)$ and
    $m'_2 = \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m'_1 + 1) \bigr)$, from
    def. of $\mathpzc{carv}$. ここで
    $m'_2 = \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m'_1 + 1) \bigr) =
    \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(t_2, \mathpzc{id}\bigl(
    \mathpzc{carv}(t_1, m) \bigr) + 1 \Bigr) \biggr) = 
    \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_2) \bigr)$, from def. of
    $m_2$成立. よって
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_2) \bigr) = m'_2 < m'_2 + 1 =
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr)$, then
    we obtain $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_2) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr)$. また
    from claim \ref{domain_flush_claim2},
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,
    m_1) \cup \mathpzc{adj}(\Gamma_2, t_2, m_2) \bigr) \Bigr).\Bigl[
    \mathpzc{id}(t') \le \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_2) \bigr)
    \Bigr]$, および
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_2) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_2) \bigr) + 1 =
    m'_2 + 1 =
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr)$ より,
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,
    m_1) \cup \mathpzc{adj}(\Gamma_2, t_2, m_2) \bigr) \Bigr).\Bigl[
    \mathpzc{id}(t') < \mathpzc{id}\bigl(\mathpzc{carv}(t_2, m_2) \bigr)
    + 1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1 \wedge t_2, m) \bigr)
    \Bigr]$. よって
    $\mathpzc{carv}(t_1 \wedge t_2, m) \not\in
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1, m_1) \cup
    \mathpzc{adj}(\Gamma_2, t_2, m_2) \bigr) = \Bigl(\mathpzc{Dom}\bigl(
    \mathpzc{adj}(\Gamma_1, t_1, m_1) \bigr) \cup \mathpzc{Dom}\bigl(
    \mathpzc{adj}(\Gamma_2, t_2, m_2) \bigr) \Bigr)$, from corollary
    \ref{dom_bin_join}.
    故に from (T-Cas-canon), $\Gamma' \vdash \mathpzc{carv}(t_1 \wedge
    t_2, m): \mathcal{R}_1 \wedge \mathcal{R}_2$, which $\Gamma' =
    \bigl\{(\mathpzc{carv}(t_1 \wedge t_2, m), \mathcal{R}_1 \wedge
    \mathcal{R}_2 ) \bigr\} \cup \bigl(\mathpzc{adj}(\Gamma_1, t_1, m_1)
    \cup \mathpzc{adj}(\Gamma_2, t_2, m_2) \bigr) $を得る.
    一方, 前提$\Gamma \vdash t_1 \wedge t_2: \mathcal{R}_1 \wedge
    \mathcal{R}_2$ which subderivations are
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$について,
    $\Gamma_1 = \Gamma|_{\mathpzc{sub}(t_1)}$ and
    $\Gamma_2 = \Gamma|_{\mathpzc{sub}(t_2)}$成立 respectively, from lemma
    \ref{environment_rewinding}.かつ
    $\Gamma(t_1 \wedge t_2) =
    \bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2) \bigr\}$
    from lemma \ref{binding_identity} より,
    $\mathpzc{adj}(\Gamma, t_1 \wedge t_2, m) = \bigl\{(
    \mathpzc{carv}(t_1 \wedge t_2, m), \mathcal{R}_1 \wedge \mathcal{R}_2)
    \bigr\} \cup \bigl(\mathpzc{adj}(\Gamma|_{\mathpzc{sub(t_1)}}, t_1, m)
    \cup \mathpzc{adj}(\Gamma|_{\mathpzc{sub(t_2)}}, t_2, m_1 + 1) \bigr) =
    \bigl\{\mathpzc{carv}(t_1 \wedge t_2, m), \mathcal{R}_1 \wedge
    \mathcal{R}_2) \bigr\} \cup \bigl(\mathpzc{adj}(\Gamma_1, t_1, m) \cup 
    \mathpzc{adj}(\Gamma_2, t_2, m_1 + 1) \bigr)$ where
    $m_1 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr)$, $=
    \bigl\{\mathpzc{carv}(t_1 \wedge t_2, m), \mathcal{R}_1 \wedge
    \mathcal{R}_2) \bigr\} \cup \biggl(\mathpzc{adj}(\Gamma_1, t_1, m) \cup
    \mathpzc{adj}\Bigl(\Gamma_2, t_2, \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m)
    \bigr) + 1 \Bigr) \biggr) =
    \bigl\{\mathpzc{carv}(t_1 \wedge t_2, m), \mathcal{R}_1 \wedge
    \mathcal{R}_2) \bigr\} \cup \bigl(\mathpzc{adj}(\Gamma_1, t_1, m_1) \cup
    \mathpzc{adj}(\Gamma_2, t_2, m_2) \bigr) = \Gamma'$ for $m_1 = m$.
    
    Case (T-Par-canon): Same as the case of (T-Cas-canon).
    
    Case (T-Cat0-canon-nil):
    From def. of (T-Cat0-canon-nil), judgement is
    $\bigl\{(t, {\mathcal{R}_1}^*) \bigr\} \vdash t: {\mathcal{R}_1}^*$
    s.t. $t \equiv \{\}$. Then $\mathpzc{carv}(t, m) = {\{\}}^m$, from def.
    of $\mathpzc{carv}$. よって, 先ず
    $\{\} \equiv \{\}$, from (E-Cat0-canon) より${\{\}}^m \equiv \{\}$,
    from (E-Ins-canon-L) を得る. $\mathpzc{carv}(t, m) = {\{\}}^m$より
    $\mathpzc{carv}(t, m) \equiv \{\}$, then we obtain
    $\bigl\{(\mathpzc{carv}(t, m), {\mathcal{R}_1}^* ) \bigr\} \vdash
    \mathpzc{carv}(t, m): {\mathcal{R}_1}^*$, from (T-Cat0-canon-nil).
    ここで$\bigl\{(t, {\mathcal{R}_1}^*) \bigr\}(t) = \bigl\{(t,
    {\mathcal{R}_1}^*) \bigr\}$ where $t \equiv \{\}$より
    $\mathpzc{adj}(\Gamma, t, m) = \bigl\{(\mathpzc{carv}(t, m),
    {\mathcal{R}_1}^* ) \bigr\}$.
    
    Case (T-Cat0-canon-$\infty$):
    From def. of (T-Cat0-canon-$\infty$), judgement is 
    $\Gamma \vdash \{t_1 \cdots t_n \}: {\mathcal{R}_1}^*$, which
    $\Gamma = \Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr)
    \Bigr\} \cup \bigcup_{j=1}^{n} \Gamma_j$, and subderivations are
    $\Gamma_j \vdash t_j: \mathcal{R}_1$ where $1 \le j \le n$. よって
    by I.H. $\mathpzc{adj}(\Gamma_j, t_j, m_j) \vdash
    \mathpzc{carv}(t_j, m_j): \mathcal{R}_1$, ここで we let
    $\, m_j = \left\{ \begin{array}[c]{l}
       m \;\; \text{\it if}\;\; j = 1  \\
       \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigl) + 1
        \;\; \text{\it if}\;\; j \ge 2
    \end{array} \right.$より
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1 = m_j
    \le \mathpzc{id}\bigl(\mathpzc{carv}(t_j, m_j) \bigr)$, from lemma
    \ref{range_of_term-id}. Then
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_j, m_j) \bigr)$. および from
    Claim \ref{domain_flush_claim3}.
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \cap
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_k, t_k, m_k) \bigr) = \phi$
    s.t. $j \neq k$. また $t$ is $\{t_1 \cdots t_n \}$であり from claim
    \ref{carv_expansion_cat0},
    $\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) = $ \\
    ${\bigl\{\mathpzc{carv}(t_1, m_1) \cdots \mathpzc{carv}(t_n, m_n)
      \bigr\}}^{\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1}$
    where $m_j = \left\{ \begin{array}[c]{l}
      m \;\; \text{\it if}\;\; j = 1  \\
       \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigl) + 1
        \;\; \text{\it if}\;\; j \ge 2
    \end{array} \right.$ より
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) + 1 = 
    \mathpzc{id}\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr)
    \Bigr)$を得る. Then
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) < \mathpzc{id}\Bigl(
    \mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) \Bigr)$, かつ
    $\mathpzc{adj}(\Gamma_j, t_j, m_j) \vdash \mathpzc{carv}(t_j, m_j):
    \mathcal{R}_1$より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n}\mathpzc{adj}(
    \Gamma_j, t_j, m_j) \bigr) \Bigr).$ \\ $\biggl[\mathpzc{id}(t') \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) < \mathpzc{id}\Bigl(
    \mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) \Bigr) \biggr]$,
    from claim \ref{domain_flush_claim2}. よって
    $\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr) \not\in
    \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n}\mathpzc{adj}(\Gamma_j, t_j, m_j)
    \bigr) = \bigcup_{j=1}^{n}\mathpzc{Dom}\bigl(\mathpzc{adj}(
    \Gamma_j, t_j, m_j) \bigr)$, by corollary \ref{dom_mul_join}. これらより
    we obtain $\Gamma' \vdash \mathpzc{carv}\bigl(\{t_1 \cdots t_n \},
    m \bigr): {\mathcal{R}_1}^*$, which
    $\Gamma' = \biggl\{\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m
    \bigr), {\mathcal{R}_1}^* \Bigr) \biggr\} \cup \bigcup_{j=1}^{n}
    \mathpzc{adj}(\Gamma_j, t_j, m_j)$, where
    $m_j = \left\{ \begin{array}[c]{l}
      m \;\; \text{\it if}\;\; j = 1  \\
       \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigl) + 1
        \;\; \text{\it if}\;\; j \ge 2
    \end{array} \right.$, from (T-Cat0-canon-$\infty$).
    一方, 前提$\Gamma \vdash \{t_1 \cdots t_n \}: {\mathcal{R}_1}^*$より
    for its subderivations as $\Gamma_j \vdash t_j:\mathcal{R}_1$,
    $\Gamma_j = \Gamma|_{\mathpzc{sub}(t_j)}$ 成立, from lemma
    \ref{environment_rewinding}. よって
    $\mathpzc{adj}\bigl(\Gamma, \{t_1 \cdots t_n \}, m \bigr) = \biggl\{
    \Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr),
    {\mathcal{R}_1}^* \Bigr) \biggr\} \cup \bigl(\bigcup_{j=1}^{n}
    \mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_j)}, t_j, m_j) \bigr) =$ \\
    $\biggl\{\Bigl(\mathpzc{carv}\bigl(\{t_1 \cdots t_n \}, m \bigr),
    {\mathcal{R}_1}^* \Bigr) \biggr\} \cup$
    $\bigl(\bigcup_{j=1}^{n}\mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) =
    \Gamma'$, since $\Gamma\bigl(\{t_1 \cdots t_n \} \bigr) = \Bigl\{\bigl(
    \{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr) \Bigr\}$ from
    lemma \ref{binding_identity}.
    
    Case (T-Cat1-canon): Same as the case of (T-Cat0-canon-$\infty$).
    
    Case (T-Dup-canon): Same as the case of (T-Cat1-canon).
    
    Case (T-Opt-canon-nil):
    From def. of (T-Opt-canon-nil), the judgement is
    $\bigl\{(t, {\mathcal{R}_1}^?) \bigr\} \vdash t: {\mathcal{R}_1}^?$
    s.t. $t \equiv \circ$. Then from def. of $\mathpzc{carv}$,
    $\mathpzc{carv}(t, m) = \circ^m$. よって先ず
    $\circ \equiv \circ$, from (E-Nil-canon) より $\circ^m \equiv \circ$
    を得る, from (E-Ins-canon-L). これと$\mathpzc{carv}(t, m) = \circ^m$より
    $\mathpzc{carv}(t, m) \equiv \circ$成立. よって we obtain
    $\Bigl\{\bigl(\mathpzc{carv}(t, m), {\mathcal{R}_1}^? \bigr) \Bigr\}
    \vdash \mathpzc{carv}(t, m): {\mathcal{R}_1}^?$, from (T-Opt-canon-sol).
    ここで$\bigl\{(t, {\mathcal{R}_1}^?) \bigr\}(t) =
    \bigl\{(t, {\mathcal{R}_1}^?) \bigr\}$ s.t. $t \equiv \circ$より,
    $\mathpzc{adj}(\Gamma, t, m) = \Bigl\{\bigl(\mathpzc{carv}(t, m),
    {\mathcal{R}_1}^? \bigr) \Bigr\}$.
    
    Case (T-Opt-canon-sol):
    From def. of (T-Opt-canon-sol), the judgement
    $\Gamma \vdash {t_1}^?: {\mathcal{R}_1}^?$ is
    $\Gamma = \bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\} \cup \Gamma_1$,
    and has subderivation $\Gamma_1 \vdash t_1: \mathcal{R}_1$. ここで
    by I.H. $\mathpzc{adj}(\Gamma_1, t_1, m) \vdash \mathpzc{carv}(t_1, m):
    \mathcal{R}_1$成立. また from def. of $\mathpzc{carv}$,
    $\mathpzc{carv}({t_1}^?, m) =
    {{\mathpzc{carv}(t_1, m)}^?}^{\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m)
      \bigr) + 1}$より
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 =
    \mathpzc{id}\bigl(\mathpzc{carv}({t_1}^?, m) \bigr)$, then
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) < \mathpzc{id}\bigl(
    \mathpzc{carv}({t_1}^?, m) \bigr)$. かつ $\mathpzc{adj}(\Gamma_1, t_1,
    m) \vdash \mathpzc{carv}(t_1, m): \mathcal{R}_1$より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,
    m) \bigr) \Bigr).\Bigl[\mathpzc{id}(t') \le \mathpzc{id}\bigl(
    \mathpzc{carv}(t_1, m) \bigr) < \mathpzc{id}\bigl(\mathpzc{carv}(
    {t_1}^?, m) \bigr) \bigr]$, from claim \ref{domain_flush_claim2}. よって
    $\mathpzc{carv}({t_1}^?, m) = {\mathpzc{carv}(t_1, m)}^? \not\in
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1, m) \bigr)$. 故に
    we obtain $\Gamma' \vdash \mathpzc{carv}({t_1}^?, m):
    {\mathcal{R}_1}^?$, which
    $\Gamma' = \Bigl\{\bigl(\mathpzc{carv}({t_1}^?, m), {\mathcal{R}_1}^?
    \bigr) \Bigr\} \cup \mathpzc{adj}(\Gamma_1, t_1, m)$,
    from def. of (T-Opt-canon-sol). 一方, 前提
    $\Gamma \vdash {t_1}^?: {\mathcal{R}_1}^?$, which subderivation is
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ より
    $\Gamma_1 = \Gamma|_{\mathpzc{sub}(t_1)}$成立, from lemma
    \ref{environment_rewinding}. よって
    from def. of $\mathpzc{adj}$, $\mathpzc{adj}(\Gamma, {t_1}^?, m) =
    \Bigl\{\bigl(\mathpzc{carv}({t_1}^?, m), {\mathcal{R}_1}^? \bigr)
    \Bigr\} \cup \mathpzc{adj}(\Gamma|_{\mathpzc{sub}(t_1)}, t_1, m) =
    \Bigl\{\bigl(\mathpzc{carv}({t_1}^?, m), {\mathcal{R}_1}^? \bigr)
    \Bigr\} \cup \mathpzc{adj}(\Gamma_1, t_1, m) = \Gamma'$, since
    $\Gamma({t_1}^?) = \bigl\{({t_1}^?, {\mathcal{R}_1}^?) \bigr\}$, from
    lemma \ref{binding_identity}.
    
    Case (T-Alt-canon-L):
    From def. of (T-Alt-canon-L), the judgement is
    $\Gamma \vdash {t_1}^\leftarrow: \mathcal{R}_1 | \mathcal{R}_2$, which
    $\Gamma = \bigl\{({t_1}^\leftarrow, \mathcal{R}_1 | \mathcal{R}_2 )
    \bigr\} \cup \Gamma_1$, および its subderivation
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$より
    $\mathpzc{adj}(\Gamma_1, t_1, m) \vdash \mathpzc{carv}(t_1, m):
    \mathcal{R}_1$, by I.H. また from def. of $\mathpzc{carv}$,
    $\mathpzc{carv}({t_1}^\leftarrow, m) =
    {{\mathpzc{carv}(t_1, m)}^\leftarrow}^{\mathpzc{id}\bigl(\mathpzc{carv}(
    t_1, m) \bigr) + 1}$より
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) + 1 =
    \mathpzc{id}\bigl(\mathpzc{carv}({t_1}^\leftarrow, m) \bigr)$, then
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_1, m) \bigr) < \mathpzc{id}\bigl(
    \mathpzc{carv}({t_1}^\leftarrow, m) \bigr)$. かつ
    $\mathpzc{adj}(\Gamma_1, t_1, m) \vdash \mathpzc{carv}(t_1, m):
    \mathcal{R}_1$より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,
    m) \bigr) \Bigr).\Bigl[\mathpzc{id}(t') \le \mathpzc{id}\bigl(
    \mathpzc{carv}(t_1, m) \bigr) < \mathpzc{id}\bigl(\mathpzc{carv}(
    {t_1}^\leftarrow, m) \bigr) \Bigr]$, from claim
    \ref{domain_flush_claim2}. よって
    $\mathpzc{carv}({t_1}^\leftarrow, m) =
    {\mathpzc{carv}(t_1, m)}^\leftarrow \not\in
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1, m) \bigr)$. 故に
    $\Gamma' \vdash \mathpzc{carv}({t_1}^\leftarrow, m):
    \mathcal{R}_1 | \mathcal{R}_2$, which
    $\Gamma' = \Bigr\{\bigl(\mathpzc{carv}({t_1}^\leftarrow, m),
    \mathcal{R}_1 | \mathcal{R}_2 \bigr) \Bigr\} \cup
    \mathpzc{adj}(\Gamma_1, t_1, m)$成立, from (T-Alt-canon-L). 一方, 前提
    $\Gamma \vdash {t_1}^\leftarrow: \mathcal{R}_1 | \mathcal{R}_2$ より
    for its subderivation as $\Gamma_1 \vdash t_1: \mathcal{R}_1$,
    $\Gamma_1 = \Gamma|_{\mathpzc{sub}(t_1)}$ 成立, from lemma
    \ref{environment_rewinding}. よって
    $\mathpzc{adj}(\Gamma, {t_1}^\leftarrow, m)$
    $= \Bigl\{\bigl(\mathpzc{carv}({t_1}^\leftarrow, m), \mathcal{R}_1 |
    \mathcal{R}_2 \bigr) \Bigr\} \cup \mathpzc{adj}(
    \Gamma|_{\mathpzc{sub}(t_1)}, t_1, m) =
    \Bigl\{\bigl(\mathpzc{carv}({t_1}^\leftarrow, m), \mathcal{R}_1 |
    \mathcal{R}_2 \bigr) \Bigr\} \cup \mathpzc{adj}(\Gamma_1, t_1, m) =
    \Gamma'$, since
    $\Gamma({t_1}^\leftarrow) = \bigl\{({t_1}^\leftarrow, \mathcal{R}_1 |
    \mathcal{R}_2) \bigr\}$ from lemma \ref{binding_identity}.
    
    Case (T-Alt-canon-R): Same as the case of (T-Alt-canon-L).
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{domain separator} \label{domain_separator}
  \[ \Gamma_j \vdash t_j : \mathcal{R}_j \ \text{\it where}\
      1 \le j \le n \;\Rightarrow
      \!\begin{array}[t]{l}
        \Gamma'_j \vdash \mathpzc{carv}(t_j, m_j):\mathcal{R}_j\
          \text{\it s.t.}\;\; \mathpzc{Dom}(\Gamma'_j) \cap
           \mathpzc{Dom}(\Gamma'_k) \!=\! \phi\;\;
            \text{\it if}\ j \!\ne\! k  \\
        \quad ,\text{\it where}\
         \begin{array}[t]{l}
           \Gamma'_j \!=\! \mathpzc{adj}(\Gamma_j, t_j, m_j)  \\
           m_j \!=\! \left\{ \begin{array}{l}
             m \quad \text{\it if}\;\; j = 1  \\
             \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr)
              \!+\! 1 \quad \text{\it if}\;\; 2 \le j \le n
           \end{array} \right.
         \end{array}
      \end{array}
  \]
  \begin{Proof}
    Proof is induction on num. of judgements
    $\Gamma_j \vdash t_j: \mathcal{R}_j$.
    
    B.C.) $n = 1$:
    It's trivial, directly from lemma \ref{domain_flush}.
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$より
    $\mathpzc{adj}(\Gamma_1, t_1, m) \vdash \mathpzc{carv}(t_1, m):
    \mathcal{R}_1$ where $m = m_1$.
    
    I.S.) $n \ge 2$:
    $\Gamma_1 \vdash t_1:\mathcal{R}_1 \cdots \Gamma_{n-1} \vdash t_{n-1}:
    \mathcal{R}_{n-1}$より
    $\mathpzc{adj}(\Gamma_1, t_1, m_1) \vdash \mathpzc{carv}(t_1, m_1):
    \mathcal{R}_1 \cdots \mathpzc{adj}($  \\
    $\Gamma_{n-1},t_{n-1}, m_{n-1}) \vdash \mathpzc{carv}(
    t_{n-1}, m_{n-1}): \mathcal{R}_{n-1}$ s.t.
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \cap
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_k, t_k, m_k) \bigr) = \phi$
    if $j \neq k$, where
    $m_j = \left\{ \begin{array}[c]{l}
      m \quad \text{\it if}\;\; j = 1  \\
      \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
      \quad \text{\it if}\;\; 2 \le j \le n-1
    \end{array} \right.$成立 by I.H. かつ
    $\Bigl(\forall t'' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1}
    \mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \Bigr).\Bigl[\mathpzc{id}(t'')
    \le \mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1}, m_{n-1}) \bigl) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1}, m_{n-1}) \bigr) + 1 = m_n
    \Bigr]$, from claim \ref{domain_flush_claim2} and def. of $m_n$, then
    $\Bigl(\forall t'' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1}
    \mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \Bigr).\bigl[\mathpzc{id}(t'')
    < m_n \bigr]$. 一方 for n'th judgement
    $\Gamma_n \vdash t_n: \mathcal{R}_n$について
    $\mathpzc{adj}(\Gamma_n, t_n, m_n) \vdash \mathpzc{carv}(t_n, m_n):
    \mathcal{R}_n$ where $m_n = \mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1},
    m_{n-1}) \bigr) + 1$, from lemma \ref{domain_flush}, より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n,
    m_n) \bigr) \Bigr).\Bigl[\mathpzc{inf}\bigl(\mathpzc{carv}(t_n, m_n)
    \bigr)$ $\le \mathpzc{id}(t') \Bigr]$ s.t.
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) = m_n$, from
    lemma \ref{infimum_of_term-id_over_environment} and
    \ref{infimum_of_term_identifier} respectively. Then we obtain
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n,
    m_n) \bigr) \Bigr).\bigl[m_n \le \mathpzc{id}(t') \bigr]$. 故に
    $\mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1} \mathpzc{adj}(\Gamma_j, t_j,
    m_j) \bigr) \cap \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n, m_n)
    \bigr) = \phi$, since recall that
    $\Bigl(\forall t'' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1}
    \mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \Bigr).\bigl[\mathpzc{id}(t'')
    < m_n \bigr]$. よって
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \cap
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_k, t_k, m_k) \bigr) = \phi$,
    if $j \neq k$ where $1 \le j \le n$ and $1 \le k \le n$, since
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \cap
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_k, t_k, m_k) \bigr) = \phi$
    if $j \neq k$ where $1 \le j \le n -1$, $1 \le k \le n -1$
    by I.H. as above.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Claim} \label{domain_flush_claim2}
  \[ \begin{array}{ll}
       \mathpzc{adj}(\Gamma_j, t_j, m_j) \vdash
        \mathpzc{carv}(t_j, m_j): \mathcal{R}_j,\ \text{\it where}\;\;
         1 \!\le\! j \!\le\! n,\
           m_j \!=\! \left\{ \! \begin{array}{l}
             m \quad \text{\it if}\ j \!=\! 1  \\
             \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr)
              \!+\! 1 \quad \text{\it if}\ 2 \!\le\! j \!\le\! n
           \end{array} \right.  \\
       \Rightarrow \Bigl(\forall t' \in \mathpzc{Dom}\bigl(
        \bigcup^{n}_{j=1} \mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr)
         \Bigr).\Bigl[\mathpzc{id}(t') \le \mathpzc{id}\bigl(
          \mathpzc{carv}(t_n, m_n) \bigr) \Bigr]
     \end{array}
  \]
  \begin{Proof}
    Proof is induction on num. of judgements
    $\mathpzc{adj}(\Gamma_j, t_j, m_j) \vdash \mathpzc{carv}(t_j, m_j):
    \mathcal{R}_j$.
    
    B.C.) $n = 1$: Trivially O.K.
    $\mathpzc{adj}(\Gamma_1, t_1, m) \vdash \mathpzc{carv}(t_1, m):
    \mathcal{R}_1$ where $m = m_1$より
    $\Bigl( \forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,
    m_1) \bigr) \Bigr).$
    $\Bigl[\mathpzc{id}(t') \le \mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m_1)
    \bigr) \Bigr]$, from lemma
    \ref{supremum_of_term-id_over_environment}, および
    $\mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) = \mathpzc{id}\bigl(
    \mathpzc{carv}(t_1, m_1) \bigr)$, from
    lemma \ref{supremum_of_term_identifier}.
    Hence, $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1,
    t_1, m_1) \bigr) \Bigr).\Bigl[\mathpzc{id}(t') \le \mathpzc{id}\bigl(
    \mathpzc{carv}(t_1, m_1) \bigr) \Bigr]$, where $m_1 = m$.
    
    I.S.) $n \ge 2$:
    $\mathpzc{adj}(\Gamma_j, t_j, m_j) \vdash \mathpzc{carv}(t_j, m_j):
    \mathcal{R}_j$ where $1 \le j \le n-1$より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1}
    \mathpzc{adj}(\Gamma_j,$
    $t_j, m_j) \bigr) \Bigr).\Bigl[\mathpzc{id}(t') \le \mathpzc{id}\bigl(
      \mathpzc{carv}(t_{n-1}, m_{n-1}) \bigr) \Bigr]$, where
    $m_j = \left\{ \!\! \begin{array}[c]{l}
       m \quad \text{\it if}\;\; j = 1  \\
       \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
       \;\; \text{\it if}\;\; 2 \le j \le n-1
    \end{array} \right.$成立 by I.H. また
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1}, m_{n-1}) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1}, m_{n-1}) \bigr) + 1 = m_n$,
    from def. of $m_j$ より
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1}, m_{n-1}) \bigr) < m_n \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr)$, from lemma
    \ref{range_of_term-id}, then
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1}, m_{n-1}) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr)$. よって
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1}
    \mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \Bigr).\Bigl[
    \mathpzc{id}(t') < \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr)
    \Bigr]$. 一方 for n'th judgement
    $\mathpzc{adj}(\Gamma_n, t_n, m_n) \vdash \mathpzc{carv}(t_n, m_n):
    \mathcal{R}_n$について,
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n,
    m_n) \bigr) \Bigr).\Bigl[\mathpzc{id}(t')$
    $\le \mathpzc{sup}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) \Bigr]$,
    from lemma \ref{supremum_of_term-id_over_environment}, および
    $\mathpzc{sup}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) =
    \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr)$, from lemma
    \ref{supremum_of_term_identifier}. Then
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n,
    m_n) \bigr) \Bigr).\Bigl[\mathpzc{id}(t') \le \mathpzc{id}\bigl(
    \mathpzc{carv}(t_n, m_n) \bigr) \Bigr]$成立. 故に
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n}
    \mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \Bigr).\Bigl[\mathpzc{id}(t')
    \le \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) \Bigr]$. Since
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1}
    \mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \Bigr).$ \\
    $\Bigl[ \mathpzc{id}(t') < \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n)
    \bigr) \Bigr]$, and
    $\mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1} \mathpzc{adj}(\Gamma_j, t_j,
    m_j)\bigr) = \bigcup_{j=1}^{n-1} \mathpzc{Dom}\bigl(\mathpzc{adj}(
    \Gamma_j, t_j, m_j) \bigr)$ from corollary \ref{dom_mul_join}, then
    $\bigcup_{j=1}^{n-1} \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j,
    m_j) \bigr) \cup \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n,$
    $m_n) \bigr)= \bigcup_{j=1}^{n} \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j,
    t_j, m_j) \bigr)$ \\
    $= \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n} \mathpzc{adj}(
    \Gamma_j, t_j,  m_j) \bigr)$ also from corollary \ref{dom_mul_join}.
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Claim} \label{domain_flush_claim3}
  \[ \begin{array}{ll}
       \mathpzc{adj}(\Gamma_j, t_j, m_j) \vdash
        \mathpzc{carv}(t_j, m_j): \mathcal{R}_j\ \text{\it where}\;\;
         1 \!\le\! j \!\le\! n,\
           m_j \!=\! \left\{ \! \begin{array}{l}
             m \quad \text{\it if}\ j \!=\! 1  \\
             \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr)
              \!+\! 1 \quad \text{\it if}\ 2 \!\le\! j \!\le\! n
           \end{array} \right.  \\
       \Rightarrow \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j, m_j)
        \bigr) \cap \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_k, t_k, m_k)
         \bigr) = \phi \quad \text{\it if}\ j \neq k
     \end{array}
  \]
  \begin{Proof}
    Proof is induction on num. of judgements
    $\mathpzc{adj}(\Gamma_j, t_j, m_j) \vdash \mathpzc{carv}(t_j, m_j):
    \mathcal{R}_j$
    
    B.C.) $n = 2$:
    $\mathpzc{adj}(\Gamma_1, t_1, m_1) \vdash \mathpzc{carv}(t_1, m_1):
    \mathcal{R}_1$より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,
    m_1) \bigr) \Bigr).\Bigl[\mathpzc{id}(t') \le \mathpzc{sup}\bigl(
    \mathpzc{carv}(t_1, m_1) \bigr) \Bigr]$, かつ
    $\mathpzc{sup}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) =
    \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m_1) \bigr)$, from lemma
    \ref{supremum_of_term-id_over_environment} and
    \ref{supremum_of_term_identifier} respectively より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,
    m_1)\bigr) \Bigr).\Bigl[\mathpzc{id}(t') \le \mathpzc{id}\bigl(
    \mathpzc{carv}(t_1, m_1) \bigr) \Bigr]$. Then
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,$
    $m_1)\bigr)$
    $\Bigr).\Bigl[\mathpzc{id}(t') < \mathpzc{id}\bigl(\mathpzc{carv}(t_1,
    m_1) \bigr) + 1 = m_2 \Bigr]$ where
    $m_2 = \mathpzc{id}\bigl(\mathpzc{carv}(t_1, m_1) \bigr) + 1$. 同様に
    $\mathpzc{adj}(\Gamma_2, t_2, m_2) \vdash \mathpzc{carv}(t_2, m_2):
    \mathcal{R}_2$より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_2, t_2,
    m_2) \bigr)\Bigr).\Bigl[\mathpzc{inf}\bigl(\mathpzc{carv}(t_2, m_2)
    \bigr) \le \mathpzc{id}(t') \Bigr]$成立, from lemma
    \ref{infimum_of_term-id_over_environment}, then
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_2, t_2,
    m_2) \bigr) \Bigr).\bigl[m_2 \le \mathpzc{id}(t') \bigr]$, since
    $\mathpzc{inf}(\mathpzc{carv}(t_2, m_2) \bigr) = m_2$ from lemma
    \ref{infimum_of_term_identifier}. 故に
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1,
    m_1)\bigr) \Bigr).\bigl[\mathpzc{id}(t') < m_2 \bigr]$および
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_2, t_2,
    m_2) \bigr) \Bigr).$ \\
    $\bigl[m_2 \le \mathpzc{id}(t') \bigr]$より
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_1, t_1, m_1) \bigr) \cap
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_2, t_2,$ $m_2) \bigr) = \phi$.

    I.S.) $n \ge 3$: For n'th judgement
    $\mathpzc{adj}(\Gamma_n, t_n, m_n) \vdash \mathpzc{carv}(t_n, m_n):
    \mathcal{R}_n$,
    $\mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1}, m_{n-1}) \bigr) <
    \mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1}, m_{n-1}) \bigr) + 1 = m_n \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t_n, m_n) \bigr)$, from
    lemma \ref{range_of_term-id}. and def of $m_n$. \\
    一方$\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n,
    t_n, m_n) \bigr) \Bigr).\Bigl[\mathpzc{inf}\bigl(\mathpzc{carv}(t_n,
    m_n) \bigr) \le \mathpzc{id}(t') \Bigr]$, where
    $\mathpzc{inf}\bigl(\mathpzc{carv}(t_n, m_n) \bigr) = m_n$ from
    lemma \ref{infimum_of_term-id_over_environment} and
    lemma \ref{infimum_of_term_identifier} respectively より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n,
    m_n) \bigl) \Bigl).\bigl[m_n \le \mathpzc{id}(t') \bigr]$. Then
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n,
    m_n) \bigl) \Bigl).\Bigl[\mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1},
    m_{n-1}) \bigr) + 1 \le \mathpzc{id}(t') \Bigr]$, since
    $m_n = \mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1},$ $m_{n-1}) \bigl) + 1$
    from def. of $m_j$. よって
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n,
    m_n) \bigl) \Bigl).\Bigl[\mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1},
    m_{n-1}) \bigr)$ \\
    $< \mathpzc{id}(t') \Bigr]$. ここで
    $\mathpzc{adj}(\Gamma_1, t_1, m_1) \vdash \mathpzc{carv}(t_1, m_1):
    \mathcal{R}_1 \cdots \mathpzc{adj}(\Gamma_{n-1}, t_{n-1}, m_{n-1})
    \vdash \mathpzc{carv}(t_{n-1}, m_{n-1}): \mathcal{R}_{n-1}$, where
    $m_j = \left\{ \!\! \begin{array}[c]{l}
      m \quad \text{\it if}\;\; j = 1  \\
      \mathpzc{id}\bigl(\mathpzc{carv}(t_{j-1}, m_{j-1}) \bigr) + 1
       \quad \text{\it if}\;\; 2 \le j \le n - 1
     \end{array} \right. \! $より
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1}
    \mathpzc{adj} (\Gamma_j,$
    $t_j, m_j) \bigr) \Bigl).\Bigl[\mathpzc{id}(t') \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t_{n-1},m_{n-1})\bigr) \Bigr]$,
    from claim \ref{domain_flush_claim2}. Then
    $\mathpzc{Dom}\bigl(\bigcup_{j=1}^{n-1} \mathpzc{adj}(\Gamma_j, t_j,
    m_j) \bigr) \cap \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n, m_n)
    \bigr)$ $= \phi$, recall
    $\Bigl(\forall t' \in \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n,
    t_n, m_n) \bigr) \Bigr).\Bigl[\mathpzc{id}\bigl(\mathpzc{carv}(
    t_{n-1}, m_{n-1} ) \bigr) < \mathpzc{id}(t') \Bigr]$, より
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \cap
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_n, t_n, m_n) \bigr) = \phi$
    if $j \ne n$, where $1 \le j \le n-1$. かつ by I.H.
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \cap
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_k, t_k, m_k) \bigr) = \phi$
    if $j \ne k$, where $1 \le j \le n-1$ and $1 \le j \le n-1$より
    $\mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_j, t_j, m_j) \bigr) \cap
    \mathpzc{Dom}\bigl(\mathpzc{adj}(\Gamma_k, t_k, m_k) \bigr) = \phi$
    if $j \ne k$.
    $\Box$
  \end{Proof}
\end{Claim}


\newpage
\begin{Definition}{論理的同値性(INTUITIONISTIC EQUIVALENCE OVER CANONICAL
TERMS)}
\label{equality_on_CANONICALS}
  項$t$の論理的同値項(INTUITIONISTIC EQUIVALENTS OVER CANONICAL TERMS) $t'$
  を以下のように定義する.
  $t$が$t'$と論理的同値であることを$t \simeq t'$と表記する.
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{lll}
        \begin{array}{rl}
          \dfrac{t \equiv t'}{
            t \simeq t'
          }  &  (\text{\it Identity})
        \end{array}
        & \begin{array}{rl}
            \dfrac{t \simeq t'}{
              t' \simeq t
            }  &  (\text{\it Symmetry})
          \end{array}
        
        & \begin{array}{rl}
            \dfrac{t_1 \simeq t_2 \quad t_2 \simeq t_3}{
              t_1 \simeq t_3
            }  &  (\text{\it Transitivity})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{t_1 \simeq t'_1 \quad t_2 \simeq t'_2}{
            t_1 \!\wedge\! t_2 \simeq t'_1 \!\wedge\! t'_2
          }  &  (\text{\it Transparency-Cas})
        \end{array}
        
        & \begin{array}{rl}
            \dfrac{t_1 \simeq t'_1 \quad t_2 \simeq t'_2}{
              t_1 \!\vee\! t_2 \simeq t'_1 \!\vee\! t'_2
            }  &  (\text{\it Transparency-Par})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{ t \simeq t_1 \wedge (t_2 \wedge t_3) \quad
          t' \simeq (t_1 \wedge t_2) \wedge t_3 }{
          t \simeq t'
        }  &  (\text{\it Associativity-Cas})
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{ t \simeq t_1 \vee (t_2 \vee t_3) \quad
          t' \simeq (t_1 \vee t_2) \wedge t_3 }{
          t \simeq t'
        }  &  (\text{\it Associativity-Par})
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{ t \simeq t' }{ t \simeq \{t'\} }
          & (\text{\it Associativity-Cat0}_1)
        \end{array}
        & \begin{array}[c]{l}
            \begin{array}{rl}
              \dfrac{
                t \simeq t_1 \wedge \{t_2 \cdots t_n \}
              }{
                t \simeq \{t_1, t_2 \cdots t_n \}
              }  &  (\text{\it AssociativityH-Cat0}_\infty)
            \end{array}  \\
            \\
            \begin{array}{rl}
              \dfrac{
                t \simeq \{t_1 \cdots t_n \} \wedge t_{n+1}
              }{
                t \simeq \{t_1 \cdots t_n, t_{n+1} \}
              }  &  (\text{\it AssociativityT-Cat0}_\infty)
            \end{array}
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{ t \simeq t' }{ t \simeq [t'] }
          & (\text{\it Associativity-Cat1}_1)
        \end{array}
        & \begin{array}[c]{l}
            \begin{array}{rl}
              \dfrac{
                t \simeq t_1 \wedge [t_2 \cdots t_n ]
              }{
                t \simeq [t_1, t_2 \cdots t_n ]
              }  &  (\text{\it AssociativityH-Cat1}_\infty)
            \end{array}  \\
            \\
            \begin{array}{rl}
              \dfrac{
                t \simeq [t_1 \cdots t_n ] \wedge t_{n+1}
              }{
                t \simeq [t_1 \cdots t_n, t_{n+1} ]
              }  &  (\text{\it AssociativityT-Cat1}_\infty)
            \end{array}
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{ t \simeq t' }{ t \simeq \langle t' \rangle }
          & (\text{\it Associativity-Dup}_1)
        \end{array}
        & \begin{array}[c]{l}
            \begin{array}{rl}
              \dfrac{
                t \simeq t_1 \vee \langle t_2 \cdots t_n \rangle
              }{
                t \simeq \langle t_1, t_2 \cdots t_n \rangle
              }  &  (\text{\it AssociativityH-Dup}_\infty)
            \end{array}  \\
            \\
            \begin{array}{rl}
              \dfrac{
                t \simeq \langle t_1 \cdots t_n \rangle \vee t_{n+1}
              }{
                t \simeq \langle t_1 \cdots t_n, t_{n+1} \rangle
              }  &  (\text{\it AssociativityT-Dup}_\infty)
            \end{array}
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{ \{\,\} \wedge t \simeq t' }{
            t \simeq t'
          }  &  (\text{\it RevealH-Cas})
        \end{array}
        & \begin{array}{rl}
            \dfrac{ t \wedge \{\,\} \simeq t' }{
              t \simeq t'
            }  &  (\text{\it RevealT-Cas})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{ \{\,\} \vee t \simeq t' }{
            t \simeq t'
          }  &  (\text{\it RevealH-Par})
        \end{array}
        & \begin{array}{rl}
            \dfrac{ t \vee \{\,\} \simeq t' }{
              t \simeq t'
            }  &  (\text{\it RevealT-Par})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{ t \simeq t' }{
            \{\,\} \wedge t \simeq t'
          }  &  (\text{\it PhonyH-Cas})
        \end{array}
        & \begin{array}{rl}
            \dfrac{ t \simeq t' }{
              t \wedge \{\,\} \simeq t'
            }  &  (\text{\it PhonyT-Cas})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{ t \simeq t' }{
            \{\,\} \vee t \simeq t'
          }  &  (\text{\it PhonyH-Par})
        \end{array}
        & \begin{array}{rl}
            \dfrac{ t \simeq t' }{
              t \vee \{\,\} \simeq t'
            }  &  (\text{\it PhonyT-Par})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{ t \simeq t' }{
            t \simeq {t'}^?
          }  &  (\text{\it Optional})
        \end{array}
        
        \begin{array}{rl}
          \dfrac{ t \simeq t'
          }{
            t \simeq {t'}^\leftarrow
          }  &  (\text{\it Alt-L})
        \end{array}
        & \begin{array}{rl}
            \dfrac{ t \simeq t'
            }{
              t \simeq {t'}^\rightarrow
            }  &  (\text{\it Alt-R})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          t \simeq t'
        }{
          t \simeq {t'}^i
        }  &  (\text{\it Instantiation})
      \end{array}
      
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Definition}{拡張された型束縛(BINDING PENTAGRAM)}
  拡張された型束縛$\Delta$を, 以下のように定義する.
  \[ \begin{array}{l}
     \Delta\ \text{\it s.t.}\ \Delta \!\vdash\! t
      \triangleright \!\mathcal{R} \;\stackrel{\mathrm{def}}{:=}
       \!\!\begin{array}[t]{l}
         \Bigl\{\bigl(t, t', \mathcal{R}, \text{\it fin},
          \bigcup_{j=1}^{n} \Delta_j \bigr) \Bigr\} \cup
           \bigl(\bigcup^n_{j=1} \Delta_j \bigr)  \\
          \quad ,\text{\it where}\ \left\{ \begin{array}{l}
            t \simeq t'  \\
            \text{\it fin} \in \{\text{\it gnd}, \text{\it def},
             \wedge, \vee, \text{\it nil}, \text{\it sol}, \infty,
              \text{\it L}, \text{\it R}\}
          \end{array} \right.
       \end{array}  \\
     [39pt]
     \Delta(t) \;\stackrel{\mathrm{def}}{:=}
      \bigl\{(t', t'', \mathcal{R}, \text{\it fin}, \Delta') \,|\,
       (t', t'', \mathcal{R}, \text{\it fin}, \Delta') \in \Delta\
        \text{\it s.t.}\ t = t' \mbox{或} t = t'' \bigr\}
     \end{array}
  \]
\end{Definition}


\begin{Definition}{(PENTAGRAM DOMAIN)}
  \[ \mathpzc{Dom}(\Delta) \;\stackrel{\mathrm{def}}{:=}\!
      \bigl\{\, t,\, t' \,|\, (t, t', \mathcal{R}, \text{\it fin}, \Delta')
       \in \Delta \bigr\}
  \]
\end{Definition}


\begin{Definition}{拡張された正準表現項に関する型照合(汎照合:POLYMORPHIC
  MATCHING ON CANONICAL TERMS)}
  正準表現項$t$の, 型$\mathcal{R}$に対する汎照合の定義を, 以下のように
  拡張する.
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \dfrac{
          \genfrac{}{}{0pt}{0}{}{t \simeq t'_0\ \text{\it s.t.}\
           t \neq t'_0}
            \quad \dfrac{}{t'_0 \equiv t_0\ \text{\it where}\
                           (t_0, \mathcal{R}_0) \in \Gamma_\text{\it gnd}}
        }{
          \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi ) \bigr\}
           \vdash t \triangleright \mathcal{R}_0
        }  &  \text{\it (T-Atom0-xtend)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \genfrac{}{}{0pt}{0}{}{t \simeq t'_1\ \text{\it s.t.}\
           t \neq t'_1}
            \quad \dfrac{}{t'_1 \equiv t_1\ \text{\it where}\
                           (t_1, \mathcal{R}_1) \in \Gamma_\text{\it def}}
        }{
          \bigl\{(t, t'_1, \mathcal{R}_1, \text{\it def}, \phi) \bigr\}
           \vdash t \triangleright \mathcal{R}_1
        }  &  \text{\it (T-Atom1-xtend)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Delta_1 \vdash t_1 \triangleright \mathcal{R}_1
             \quad \Delta_2 \vdash t_2 \triangleright \mathcal{R}_2
              \quad \mathpzc{Dom}(\Delta_1) \cap \mathpzc{Dom}(\Delta_2)
               = \phi  \\
            t \simeq t_1 \wedge t_2\ \text{\it s.t.}\
             t \neq t_1 \wedge t_2
              \quad t,\, t_1 \!\wedge\! t_2 \not\in \mathpzc{Dom}(
               \Delta_1 \cup \Delta_2)
          \end{array}
        }{
          \Bigl\{\bigl(t, t_1 \wedge t_2,
           \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge,
            (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}
             \cup (\Delta_1 \cup \Delta_2) \vdash
              t \triangleright \mathcal{R}_1 \wedge \mathcal{R}_2
        }  &  \text{\it (T-Cas-xtend)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Delta_1 \vdash t_1 \triangleright \mathcal{R}_1
             \quad \Delta_2 \vdash t_2 \triangleright \mathcal{R}_2
              \quad \mathpzc{Dom}(\Delta_1) \cap \mathpzc{Dom}(\Delta_2)
               = \phi  \\
            t \simeq t_1 \vee t_2\ \text{\it s.t.}\
             t \neq t_1 \vee t_2   
              \quad t,\, t_1 \!\vee\! t_2 \not\in \mathpzc{Dom}(
               \Delta_1 \cup \Delta_2)
          \end{array}
        }{
          \Bigl\{\bigl(t, t_1 \vee t_2, \mathcal{R}_1 \vee \mathcal{R}_2,
           \vee, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
            (\Delta_1 \cup \Delta_2) \vdash
             t \triangleright \mathcal{R}_1 \vee \mathcal{R}_2
        }  &  \text{\it (T-Par-xtend)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            \dfrac{}{t \simeq \{\}\ \text{\it s.t.}\ t \neq \{\}
              \quad \mathcal{R}_1 \,\text{\it is}\, \text{\it Any}. }
          }{
            \Bigl\{\bigl(t, \{\}, \mathcal{R}_1^*, \text{\it nil}, \phi
             \bigr) \Bigr\} \vdash
              t \triangleright {\mathcal{R}_1}^*
          }  &  (\text{\it nil}\,)  \\
          \\
          
          \dfrac{
            \quad t \simeq t'
             \quad \Delta' \vdash t' \triangleright \mathcal{R}_1
              \quad t \not\in \mathpzc{Dom}(\Delta')
          }{
            \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta' )
             \bigr\} \cup \Delta'
              \vdash t \triangleright {\mathcal{R}_1}^*
          }  &  (\text{\it sol}\,)  \\
          \\
          
          \dfrac{
            \begin{array}{c}
              \Delta_h \vdash t_h \triangleright \mathcal{R}_1
               \quad \Delta_t \vdash t_t \triangleright {\mathcal{R}_1}^*
                \quad \mathpzc{Dom}(\Delta_h) \cap \mathpzc{Dom}(\Delta_t)
                = \phi  \\
              t \simeq t_h \wedge t_t\ \text{\it s.t.}\
               t \neq t_h \wedge t_t  
               \quad t,\, t_h \!\wedge\! t_t \not\in \mathpzc{Dom}(
                 \Delta_h \cup \Delta_t)
            \end{array}
          }{
            \Bigl\{\bigl(t, t_h \wedge t_t, {\mathcal{R}_1}^*, \infty,
             (\Delta_h \cup \Delta_t) \bigr) \Bigr\} \cup
              (\Delta_h \cup \Delta_t) \vdash
               t \triangleright {\mathcal{R}_1}^*
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Cat0-xtend)}
      \end{array}  \\
      
    \end{array}
  \end{displaymath}
  
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            t \simeq t'
             \quad \Delta' \vdash t' \triangleright \mathcal{R}_1
              \quad t \not\in \mathpzc{Dom}(\Delta')
          }{
            \bigl\{(t, t', {\mathcal{R}_1}^+, \text{\it sol}, \Delta')
             \bigr\} \cup \Delta' \vdash
              t \triangleright {\mathcal{R}_1}^+
          }  &  (\text{\it sol}\,)  \\
          \\
          \dfrac{
            \begin{array}{c}
              \Delta_h \vdash t_h \triangleright \mathcal{R}_1
               \quad \Delta_t \vdash t_t \triangleright {\mathcal{R}_1}^+
                \quad \mathpzc{Dom}(\Delta_h) \cap \mathpzc{Dom}(\Delta_t)
                 = \phi  \\
              t \simeq t_h \wedge t_t\ \text{\it s.t.}\
               t \neq t_h \wedge t_t   
                \quad t,\, t_h \!\wedge\! t_t \not\in \mathpzc{Dom}(
                 \Delta_h \cup \Delta_t)
            \end{array}
          }{
            \Bigl\{\bigl(t, t_h \wedge t_t, {\mathcal{R}_1}^+, \infty,
             (\Delta_h \cup \Delta_t) \bigr) \Bigr\} \cup
              (\Delta_h \cup \Delta_t) \vdash
               t \triangleright {\mathcal{R}_1}^+
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Cat1-xtend)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            t \simeq t'
             \quad \Delta' \vdash t' \triangleright \mathcal{R}_1
              \quad t \not\in \mathpzc{Dom}(\Delta')
          }{
            \bigl\{(t, t', {\mathcal{R}_1}^\downarrow, \text{\it sol},
             \Delta') \bigr\} \cup \Delta' \vdash
              t \triangleright {\mathcal{R}_1}^\downarrow
          }  &  (\text{\it sol}\,)  \\
          \\
          \dfrac{
            \begin{array}{c}
              \Delta_h \vdash t_h \triangleright \mathcal{R}_1
               \quad \Delta_t \vdash t_t \triangleright
                {\mathcal{R}_1}^\downarrow
                 \quad \mathpzc{Dom}(\Delta_h) \cap \mathpzc{Dom}(\Delta_t)
                  = \phi  \\
              t \simeq t_h \vee t_t\ \text{\it s.t.}\
               t \neq t_h \vee t_t   
                \quad t,\, t_h \!\vee\! t_t \not\in \mathpzc{Dom}(
                 \Delta_h \cup \Delta_t)
            \end{array}
          }{
            \Bigl\{\bigl(t, t_h \vee t_t, {\mathcal{R}_1}^\downarrow,
             \infty, (\Delta_h \cup \Delta_t) \bigr) \Bigr\} \cup
              (\Delta_h \cup \Delta_t) \vdash
               t \triangleright {\mathcal{R}_1}^\downarrow
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Dup-xtend)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{\dfrac{}{t \simeq \circ\ \text{\it s.t.}\ t \neq \circ
              \quad \mathcal{R}_1 \,\text{\it is}\, \text{\it Any}. }
          }{
            \Bigl\{\bigl(t, \circ, {\mathcal{R}_1}^?, \text{\it nil}, \phi
             \bigr) \Bigr\} \vdash
              t \triangleright {\mathcal{R}_1}^?
          }  &  (\text{\it nil}\,)  \\
          \\
          
          \dfrac{
            t \simeq t'
             \quad \Delta' \vdash t' \triangleright \mathcal{R}_1
              \quad t \not\in \mathpzc{Dom}(\Delta')
          }{
            \bigl\{(t, t', {\mathcal{R}_1}^?, \text{\it sol},
             \Delta') \bigr\} \cup \Delta' \vdash
              t \triangleright {\mathcal{R}_1}^?
          }  &  (\text{\it sol}\,)
        \end{array} \right\}  &  \text{\it (T-Opt-xtend)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            t \simeq t'
             \quad \Delta' \vdash t' \triangleright \mathcal{R}_1
              \quad \mathcal{R}_2 \,\text{\it is}\, \text{\it Any}.
               \quad t \not\in \mathpzc{Dom}(\Delta')
          }{
            \bigl\{(t, t', \mathcal{R}_1|\mathcal{R}_2,
             \text{\it L}, \Delta') \bigr\} \cup \Delta' \vdash
              t \triangleright \mathcal{R}_1|\mathcal{R}_2
          }  &  (\text{\it L})  \\
          \\
          
          \dfrac{
            t \simeq t'
             \quad \forall \Delta' \not\vdash t' \triangleright
              \mathcal{R}_1
              \quad \Delta' \vdash t' \triangleright \mathcal{R}_2
               \quad t \not\in \mathpzc{Dom}(\Delta')
          }{
            \bigl\{(t, t', \mathcal{R}_1|\mathcal{R}_2,
             \text{\it R}, \Delta') \bigr\} \cup \Delta' \vdash
              t \triangleright \mathcal{R}_1|\mathcal{R}_2
          }  &  (\text{\it R})
        \end{array} \right\}  &  \text{\it (T-Alt-xtend)}
      \end{array}
      
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Lemma}{polymorphic environment retrieving}
\label{polymorphic_environment_retrieving}
\[ \Delta \vdash t \triangleright \mathcal{R} \;\Rightarrow\;
    \Delta(t) = \bigl\{ (t, t', \mathcal{R}, \text{\it fin}, \Delta')
     \bigr\}\;\; \text{\it s.t.}\ t \simeq t'\ \text{\it and}\ 
      \bigl\{(t, t', \mathcal{R}, \text{\it fin}, \Delta') \bigr\} \cup
       \Delta' = \Delta
  \]
  \begin{Proof}
    Proof is directly from def. of polymorphic typematching.
    
    Case (T-Atom0-xtend): From def. of (T-Atom0-xtend),
    environment $\Delta$ of judgmement
    $\Delta \vdash t \triangleright \mathcal{R}_0$ is
    $\bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi ) \bigr\}$ s.t.
    $t \simeq t'_0$. Then
    $\Delta(t) = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi )
    \bigr\}(t) = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi )
    \bigr\} = \Delta$かつ
    $\bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi ) \bigr\} \cup
    \phi = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi ) \bigr\} =
    \Delta$.
    
    Case (T-Atom1-xtend): Similar to the case of (T-Atom0-xtend).
    
    Case (T-Cas-xtend): From def. of (T-Cas-xtend), judgement
    $\Delta \vdash t \triangleright \mathcal{R}_1 \wedge \mathcal{R}_2$ has
    $\Delta =\Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2)$ s.t. $t \simeq t_1 \wedge t_2$. Then
    $\Delta(t) = \biggl(\Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2) \biggr)(t) =
    \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2)(t) =
    \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    \phi = \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}$, for
    $t \not\in \mathpzc{Dom}(\Delta_1 \cup \Delta_2)$. また
    $\Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2) = \Delta$.
    
    Case (T-Par-xtend): Similar to the case of (T-Cas-xtend).
    
    Case (T-Cat0-xtend-nil): Similar to the case of (T-Atom0-xtend).
    
    Case (T-Cat0-xtend-sol): In this case, the judgement
    $\Delta \vdash t \triangleright {\mathcal{R}_1}^*$ has $\Delta =
    \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\} \cup \Delta'$ s.t. $t \simeq t'$. Then
    $\Delta(t) = \Bigl(\bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol},
    \Delta') \bigr\} \cup \Delta' \Bigr)(t) =
    \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\} \cup \Delta'(t) =
    \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\}$, since $t \not\in \mathpzc{Dom}(\Delta')$. かつ
    $\Delta = \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\} \cup \Delta'$ from def. of (T-Cat0-xtend-sol).
    
    Case (T-Cat0-xtend-$\infty$): Similar to the case of (T-Cas-xtend).
    
    Case (T-Cat1-xtend-sol): Case (T-Cat1-xtend-$\infty$):
    Similar to the cases of (T-Cat0-xtend-sol) and (T-Cat0-xtend-$\infty$)
    respectively.
    
    Case (T-Dup-xtend-sol): Case (T-Dup-xtend-$\infty$):
    Similar to the cases of (T-Cat1-xtend-sol) and (T-Cat1-xtend-sol)
    respectively.
    
    Case (T-Opt-xtend-nil): Case (T-Opt-xtend-sol):
    Similar to the cases of (T-Cat0-xtend-nil) and (T-Cat0-xtend-sol)
    respectively.
    
    Case (T-Alt-xtend-L):
    Similar to the case of (T-Cat0-xtend-sol).
    
    Case (T-Alt-xtend-R):
    Similar to the case of (T-Alt-xtend-L).
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{determinacy of polymorphic finalizer}
  \label{determinacy_of_polymorphic_finalizer}
  
    Finalizer (e.g. the LAST-applied rule on
     $\Delta \vdash t \triangleright \mathcal{R}$)
      is deterministic for syntax of
       $\Delta(t) = (t, t', \mathcal{R}, \text{\it fin}, \Delta')$, as
    \[ \begin{array}{rl}
         \text{\it fin} = \text{\it gnd}: & \mbox{(T-Atom0-xtend)}  \\
         \text{\it fin} = \text{\it def}: & \mbox{(T-Atom1-xtend)}  \\
         \text{\it fin} = \wedge: & \mbox{(T-Cas-xtend)}  \\
         \text{\it fin} = \vee: & \mbox{(T-Par-xtend)}  \\
         \mathcal{R} = {\mathcal{R}_1}^*,\ \text{\it fin} = \text{\it nil}:
          & \mbox{(T-Cat0-xtend-nil)}  \\
         \mathcal{R} = {\mathcal{R}_1}^*,\ \text{\it fin} = \text{\it sol}:
          & \mbox{(T-Cat0-xtend-sol)}  \\
         \mathcal{R} = {\mathcal{R}_1}^*,\ \text{\it fin} = \infty:
          & \mbox{(T-Cat0-xtend-$\infty$)}  \\
         \mathcal{R} = {\mathcal{R}_1}^+,\ \text{\it fin} = \text{\it sol}:
          & \mbox{(T-Cat1-xtend-sol)}  \\
         \mathcal{R} = {\mathcal{R}_1}^+,\ \text{\it fin} = \infty:
          & \mbox{(T-Cat1-xtend-$\infty$)}  \\
         \mathcal{R} = {\mathcal{R}_1}^\downarrow,\
          \text{\it fin} = \text{\it sol}:
          & \mbox{(T-Dup-xtend-sol)}  \\
         \mathcal{R} = {\mathcal{R}_1}^\downarrow,\ \text{\it fin} = \infty:
          & \mbox{(T-Dup-xtend-$\infty$)}  \\
         \mathcal{R} = {\mathcal{R}_1}^?,\ \text{\it fin} = \text{\it nil}:
          & \mbox{(T-Opt-xtend-nil)}  \\
         \mathcal{R} = {\mathcal{R}_1}^?,\ \text{\it fin} = \text{\it sol}:
          & \mbox{(T-Opt-xtend-sol)}  \\
         \text{\it fin} = L: & \mbox{(T-Alt-xtend-L)}  \\
         \text{\it fin} = R: & \mbox{(T-Alt-xtend-R)}
       \end{array}
    \]

  \begin{Proof}
    Proof is directly from def. of polymorphic matching-rules, with lemma
    \ref{polymorphic_environment_retrieving}.
    
    Now we suppose the judgement is $\Delta \vdash t: \mathcal{R}$, then
    from lemma \ref{polymorphic_environment_retrieving},
    $\Delta(t)$ gives the binding obtained by the last applied rule, as
    $\Delta(t) = (t, t', \mathcal{R}, \text{\it fin}, \Delta')$ which
    $\mathcal{R}$ and $\text{\it fin}$ dictates the last applied rule
    Hence, the pair $(\mathcal{R},\, \text{\it fin})$ completely and
    uniquely expresses the last applied rule.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{polymorphic environment rewinding}
\label{polymorphic_environment_rewinding}
  \[ \begin{array}{r}
       \Delta \vdash t \triangleright \mathcal{R} \;\Rightarrow\;
       \bigl(\forall \mathcal{D}(\Delta_j \vdash t_j \triangleright
       \mathcal{R}_j) \in \mathcal{D}(\Delta \vdash t \triangleright
       \mathcal{R}) \bigr).
       \bigl[\Delta_j(t_j) = \Delta(t_j) \setminus \Delta(t) \bigr] \\
       [3pt]
       \mathcal{D}(\Delta \vdash t \triangleright \mathcal{R}):
        \text{\it derivation of}\
         \Delta \vdash t \triangleright \mathcal{R}  \\
       \Delta_j \vdash t_j \triangleright \mathcal{R}_j:
        \text{\it subderivation of}\
         \Delta \vdash t \triangleright \mathcal{R}
     \end{array}
  \]
  \begin{Proof}
    Proof is directly from def. of polymorphic typematching, and
    lemma \ref{polymorphic_environment_retrieving}.
    
    Case (T-Atom0-xtend), (T-Atom1-xtend), (T-Cat0-xtend-nil),
    (T-Opt-xtend-nil): Have no subderivations.
    
    Case (T-Cas-xtend): From def. of (T-Cas-xtend), the judgement
    $\Delta \vdash t \triangleright \mathcal{R}_1 \wedge \mathcal{R}_2$ has
    $\Delta = \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2)$ s.t.
    $\mathpzc{Dom}(\Delta_1) \cap \mathpzc{Dom}(\Delta_2) = \phi$ and
    $t, t_1 \wedge t_2 \not\in \mathpzc{Dom}(\Delta_1 \cup \Delta_2)$
    かつ$\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$ and
    $\Delta_2 \vdash t_2 \triangleright \mathcal{R}_2$成立 as its
    subderivations. ここで subderivation
    $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$より
    $t_1 \in \mathpzc{Dom}(\Delta_1) \subseteq \mathpzc{Dom}(\Delta_1) \cup
    \mathpzc{Dom}(\Delta_2) = \mathpzc{Dom}(\Delta_1 \cup \Delta_2)$ by
    lemma \ref{polymorphic_environment_retrieving} and
    corollary \ref{dom_bin_join}. 今
    $\Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1
    \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr)
    \Bigr\}(t_1) \neq \phi$を仮定するならば
    $t = t_1 \in \mathpzc{Dom}(\Delta_1 \cup \Delta_2)$ since
    $t_1 \neq t_1 \wedge t_2$. これは
    $t \not\in \mathpzc{Dom}(\Delta_1 \cup \Delta_2)$ に反する, then
    we have contradiction. よって
    $\Delta(t_1) = \biggl(\Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1
    \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr)
    \Bigr\} \cup (\Delta_1 \cup \Delta_2) \biggr)(t_1) =
    (\Delta_1 \cup \Delta_2)(t_1) = \Delta_1(t_1)$, for
    $\mathpzc{Dom}(\Delta_1) \cap \mathpzc{Dom}(\Delta_2) = \phi$. 一方
    $\Delta(t) = \biggl(\Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1
    \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}
    \cup (\Delta_1 \cup \Delta_2) \biggr)(t) =
    \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
    \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2)(t) =
    \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
    \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}$, for
    $t \not\in \mathpzc{Dom}(\Delta_1 \cup \Delta_2)$. 故に
    $\Delta(t_1) \setminus \Delta(t) =
    \Delta_1(t_1) \setminus \Bigl\{\bigl(t, t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2)
    \bigr) \Bigr\} = \Delta_1(t_1)$, since
    $t \not\in \mathpzc{Dom}(\Delta_1 \cup \Delta_2) =
    \mathpzc{Dom}(\Delta_1) \cup \mathpzc{Dom}(\Delta_2)$ より
    $t \not\in \mathpzc{Dom}(\Delta_1)$, that implies
    $\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge,
    (\Delta_1 \cup \Delta_2) \bigr) \not\in \Delta_1$, then
    $\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge,
    (\Delta_1 \cup \Delta_2) \bigr) \not\in \Delta_1(t_1)$ because of
    $\Delta_1(t_1) \subseteq \Delta_1$. 同様に we can obtain
    $\Delta_2(t_2) = \Delta(t_2) \setminus \Delta(t)$.
    
    Case (T-Par-xtend): Similar to the case of (T-Cas-xtend).
    
    Case (T-Cat0-xtend-sol): In this case, we suppose the judgement
    $\Delta \vdash t \triangleright {\mathcal{R}_1}^*$ has
    $\Delta = \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta' )
    \bigr\} \cup \Delta'$ and subderivation
    $\Delta' \vdash t' \triangleright \mathcal{R}_1$ s.t.
    $t \not\in \mathpzc{Dom}(\Delta')$. Here we have
    $\Delta(t') = \Bigl(\bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol},
    \Delta' ) \bigr\} \cup \Delta' \Bigr)(t') =
    \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta' ) \bigr\}
    \cup \Delta'(t')$, and
    $\Delta(t) = \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\}$ for $t \not\in \mathpzc{Dom}(\Delta')$. Then
    $\Delta(t') \setminus \Delta(t) =
    \Bigl(\bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta' )
    \bigr\} \cup \Delta'(t') \Bigr) \setminus \bigl\{(t, t',
    {\mathcal{R}_1}^*, \text{\it sol}, \Delta') \bigr\} =
    \Delta'(t') \setminus \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol},
    \Delta' ) \bigr\} = \Delta'(t')$ since $\Delta'(t') \subseteq \Delta'$
    s.t. $t \not\in \mathpzc{Dom}(\Delta')$.

    Case (T-Cat0-xtend-$\infty$): Similar to the case of (T-Cas-xtend).

    Case (T-Cat1-xtend-sol): Case (T-Cat1-xtend-$\infty$):
    Similar to the cases of (T-Cat0-xtend-sol) and (T-Cat0-xtend-$\infty$)
    respectively.

    Case (T-Dup-xtend-sol): Case (T-Dup-xtend-$\infty$):
    Similar to the cases of (T-Cat1-xtend-sol) and (T-Cat1-xtend-$\infty$)
    respectively.

    Case (T-Opt-xtend-sol): Case (T-Alt-xtend-L): Case (T-Alt-xtend-R):
    Proof for these cases are similar to the case of (T-Cat0-xtend-sol).
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Definition}
  \[ \mathpzc{sub}_{0}(t, \text{\it fin}) \;\stackrel{\mathrm{def}}{:=}\;
      \left\{ \begin{array}[c]{ll}
        \{t_1, t_n \}
        & \text{\it if}\;\; t\ \text{\it is}\ t_1 \!\wedge\! t_2
           \mbox{或} t_1 \!\vee\! t_2,\
            \text{\it fin} \!\in\! \{\wedge, \vee, \infty \} \\
        \{t\}  &  \text{\it otherwise}
      \end{array} \right.
  \]
  \vspace{3pt}
  \[ \mathpzc{Equ}(\Delta, t) \;\stackrel{\mathrm{def}}{:=}\;
      \left\{ \begin{array}[c]{ll}
        \{t, t'\}
        & \text{\it where}\ (t, t', \mathcal{R}, \text{\it fin}, \Delta') =
           \Delta(t)  \\
        & \cup \, \left\{ \begin{array}[c]{l}
            \phi \quad \text{\it if}\;\; \text{\it fin} \in
                  \{\text{\it gnd}, \text{\it def}, \text{\it nil}\, \}  \\
             \mathpzc{Equ}\bigl(\Delta'(t') \cup \Delta'',
              \mathpzc{sub}_0(t', \text{\it fin}) \bigl)
               \quad \text{\it if}\;\; \text{\it fin} \in
                \{\text{\it sol}, \text{\it L}, \text{\it R}\, \}  \\
            \hphantom{\phi} \quad \text{\it s.t.}\
             (t', t'', \mathcal{R}', \text{\it fin}', \Delta'') =
              \Delta'(t')  \\
            
            \bigcup_{j=1}^{n}\mathpzc{Equ}(\Delta'_j, t_j)\;\;
             \text{\it for}\ \forall t_j \in
              \mathpzc{sub}_{0}(t', \text{\it fin})
               \quad \text{\it otherwise}  \\
            \hphantom{\phi} \quad \text{\it where}\;\;
             {\Delta'}_j = \bigl(\Delta(t_j) \setminus \Delta(t) \bigr) \cup
              {\Delta''}_j  \\
            \hphantom{\phi} \quad \hphantom{\text{\it where}}\;\;
               \text{\it s.t.}\ ({t'}_j, {t''}_j, {\mathcal{R}'}_j,
                {\text{\it fin}'}_j, {\Delta''}_j ) =
                 \bigl(\Delta(t_j) \setminus \Delta(t) \bigr)
          \end{array} \right.
      \end{array} \right.
  \]
\end{Definition}


\begin{Lemma}{determinacy and termination of evaluation}
  \[ \Delta \vdash t \triangleright \mathcal{R} \;\Rightarrow\;
      \mathpzc{Equ}(\Delta, t)\
       \text{\it is deterministic, and has termination}.
  \]
  \begin{Proof}
    Proof is induction on structure of derivation for
    $\Delta \vdash t \triangleright \mathcal{R}$.
    
    Case (T-Atom0-xtend):
    The judgement is $\bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi)
    \bigr\} \vdash t \triangleright \mathcal{R}_0$. Then from def. of
    $\mathpzc{Equ}$,
    $\mathpzc{Equ}\Bigl(\bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd},
    \phi) \bigr\}, t \Bigr) = \{t, t'_0 \} \cup \phi = \{t, t'_0 \}$.
    
    Case (T-Atom1-xtend): Similar to the case of (T-Atom0-xtend).
    
    Case (T-Cas-xtend): The judgement is
    $\Delta \vdash t \triangleright \mathcal{R}_1 \wedge \mathcal{R}_2$,
    which environment $\Delta = \Bigl\{\bigl(t, t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2)
    \bigr) \Bigr\} \cup (\Delta_1 \cup \Delta_2)$, and its subderivations
    are $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$ and
    $\Delta_2 \vdash t_2 \triangleright \mathcal{R}_2$. Then $\Delta(t) =
    \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
    \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}$, from lemma
    \ref{polymorphic_environment_retrieving} and def. of (T-Cas-xtend) より
    $\mathpzc{Equ}(\Delta, t) = \{t, t_1 \wedge t_2 \} \cup \bigl(
    \mathpzc{Equ}(\Delta_1, t_1) \cup \mathpzc{Equ}(\Delta_2, t_2) \bigr)$
    s.t. $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$ and
    $\Delta_2 \vdash t_2 \triangleright \mathcal{R}_2$, since subderivations
    $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$ and
    $\Delta_2 \vdash t_2 \triangleright \mathcal{R}_2$より
    $\Delta_1 = \bigl(\Delta(t_1) \setminus \Delta(t) \bigr) \cup
    \Delta'_1$ s.t.
    $(t_1, t'_1, \mathcal{R}_1, \text{\it fin}_1, \Delta'_1) =
    \bigl(\Delta(t_1) \setminus \Delta(t) \bigr)$ and
    $\Delta_2 = \bigl(\Delta(t_2) \setminus \Delta(t) \bigr) \cup
    \Delta'_2$ s.t.
    $(t_2, t'_2, \mathcal{R}_2, \text{\it fin}_2, \Delta'_2) =
    \bigl(\Delta(t_2) \setminus \Delta(t) \bigr)$成立 respectively, by lemma
    \ref{polymorphic_environment_retrieving} \&
    \ref{polymorphic_environment_rewinding}. Here
    $\mathpzc{Equ}(\Delta_1, t_1)$ and $\mathpzc{Equ}(\Delta_1, t_1)$
    are both deterministric \& termination by I.H. 故に
    $\mathpzc{Equ}(\Delta, t)$ is
    also determinastic \& termination.
    
    Case (T-Par-xtend): Similar to the case of (T-Cas-xtend).
    
    Case (T-Cat0-xtend-nil): The judgment is
    $\Bigl\{\bigl(t, \{\}, {\mathcal{R}_1}^*, \text{\it nil}, \phi \bigr)
    \Bigr\} \vdash t \triangleright {\mathcal{R}_1}^*$ and
    from def. of $\mathpzc{Equ}$,
    $\mathpzc{Equ}\biggl(\Bigl\{\bigl(t, \{\}, {\mathcal{R}_1}^*,
    \text{\it nil}, \phi \bigr) \Bigr\}, t \biggr) = \bigl\{t, \{\}
    \bigr\}$.
    
    Case (T-Cat0-xtend-sol):
    The judgement $\Delta \vdash t \triangleright {\mathcal{R}_1}^*$ has
    $\Delta = \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol},
    \Delta') \bigr\} \cup \Delta'$, which gives
    $\Delta(t) = \bigl\{t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\}$ from lemma \ref{polymorphic_environment_retrieving}, and
    $\Delta' \vdash t' \triangleright \mathcal{R}_1$ as its subderivation.
    Then $\Delta' = \bigl(\Delta(t') \setminus \Delta(t) \bigr) \cup
    \Delta''$ s.t.
    $(t', t'', \mathcal{R}_1, \text{\it fin}', \Delta'') =
    \bigl(\Delta(t') \setminus \Delta(t) \bigr)$ by lemma
    \ref{polymorphic_environment_retrieving} \&
    \ref{polymorphic_environment_rewinding}. よって
    $\mathpzc{Equ}(\Delta, t) = \{t, t'\} \cup \mathpzc{Equ}(\Delta', t')$,
    that's deterministic \& termination by I.H.
    故に$\mathpzc{Equ}(\Delta, t)$ is also.
    
    Case (T-Cat0-xtend-$\infty$): Similar to the case of (T-Cas-xtend).
    
    Case (T-Cat1-xtend-sol): Case (T-Cat1-xtend-$\infty$):
    Similar to the cases of (T-Cat0-xtend-sol) \& (T-Cat0-xtend-$\infty$)
    respectively.
    
    Case (T-Dup-xtend-sol): Case (T-Dup-xtend-$\infty$):
    Similar to the case of (T-Cat1-xtend-sol) \& (T-Cat1-xtend-$\infty$)
    respectively.
    
    Case (T-Opt-xtend-nil): Similar to the case of (T-Atom0-xtend).
    
    Case (T-Opt-xtend-sol): Similar to the case of (T-Cat0-xtend-sol).
    
    Case (T-Alt-xtend-L): Similar to the case of (T-Cat0-xtend-sol).
    
    Case (T-Alt-xtend-R): Similar to the case of (T-Alt-xtend-L).
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{polymorphic environment extension}
\label{polymorphic_environment_extension}
  \[ \Delta \vdash t \triangleright \mathcal{R} \;\Rightarrow\;
      \mathpzc{Dom}(\Delta) = \mathpzc{Equ}(\Delta, t)
  \]
  \begin{Proof}
    Proof is induction on structure of derivation for
    $\Delta \vdash t \triangleright \mathcal{R}$.
    
    Case (T-Atom0-xtend): Trivial, directly from def. of (T-Atom0-xtend).
    Judgement $\Delta \vdash t \triangleright \mathcal{R}_0$ has
    $\Delta = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi )
    \bigr\}$. Then we obtain
    $\mathpzc{Equ}(\Delta, t) = \{t, t'_0 \} = \mathpzc{Dom}(\Delta)$
    from def. of $\mathpzc{Equ}$,
    
    Case (T-Atom1-xtend): Similar to the case of (T-Atom0-xtend).
    
    Case (T-Cas-xtend):
    From def. of (T-Cas-xtend), The environment $\Delta$ of judgement
    $\Delta \vdash t \triangleright \mathcal{R}_1 \wedge \mathcal{R}_2$ is
    $\Delta = \Bigl\{\bigl(t, t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2)
    \bigr) \Bigr\} \cup (\Delta_1 \cup \Delta_2)$, and its subderivations
    are $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$ and
    $\Delta_2 \vdash t_2 \triangleright \mathcal{R}_2$. ここで
    $\Delta(t) = \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}$ s.t.
    $\Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2) = \Delta$ by Lemma
    \ref{polymorphic_environment_retrieving}, よって
    $\mathpzc{Equ}(\Delta, t) = \{t, t_1 \wedge t_2 \} \cup \bigl(
    \mathpzc{Equ}(\Delta_1, t_1) \cup \mathpzc{Equ}(\Delta_2, t_2) \bigr)$
    since $\bigl(\Delta(t_1)\setminus \Delta(t) \bigr) \cup \Delta''_1 =
    \Delta_1$ s.t.
    $(t_1, t'_1, \mathcal{R}_1, \text{\it fin}_1, \Delta''_1) =
    \bigl(\Delta(t_1) \setminus \Delta(t) \bigr) = \Delta_1(t_1)$ and
    $\bigl(\Delta(t_2) \setminus \Delta(t) \bigr) \cup \Delta''_2 =
    \Delta_2$ s.t.
    $(t_2, t'_2, \mathcal{R}_2, \text{\it fin}_2, \Delta''_2) =
    \bigl(\Delta(t_2) \setminus \Delta(t) \bigr) = \Delta_2(t_2)$成立
    respectively by lemma \ref{polymorphic_environment_retrieving} \&
    \ref{polymorphic_environment_rewinding}. これより
    $\mathpzc{Equ}(\Delta, t) =
    \{t, t_1 \wedge t_2 \} \cup \bigl(\mathpzc{Equ}(\Delta_1, t_1) \cup
    \mathpzc{Equ}(\Delta_2, t_2) \bigr) =
    \{t, t_1 \wedge t_2 \} \cup \bigl(\mathpzc{Dom}(\Delta_1) \cup
    \mathpzc{Dom}(\Delta_2) \bigr) =
    \{t, t_1 \wedge t_2 \} \cup \mathpzc{Dom}(\Delta_1 \cup \Delta_2) =
    \mathpzc{Dom}\biggl(\Bigl\{\bigl(t, t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2)
    \bigr) \Bigr\} \cup (\Delta_1 \cup \Delta_2) \biggr) =
    \mathpzc{Dom}(\Delta)$ by I.H. with corollary \ref{dom_bin_join}.
    
    Case (T-Par-xtend): Similar to the case of (T-Cas-xtend).
    
    Case (T-cat0-xtend-nil):
    From def. of (T-Cat0-xtend-nil), the judgement is
    $\Delta \vdash t \triangleright {\mathcal{R}_1}^*$, and $\Delta =
    \Bigl\{\bigl(t, \{\}, {\mathcal{R}_1}^*, \text{\it nil}, \phi \bigr)
    \Bigr\}$. よって we obtain $\mathpzc{Equ}(\Delta, t) =
    \bigl\{t, \{\} \bigr\} = \mathpzc{Dom}(\Delta)$.
    
    Case (T-Cat0-xtend-sol):
    From def. of (T-Cat0-xtend-sol), the judgement is
    $\Delta \vdash t \triangleright {\mathcal{R}_1}^*$ which $\Delta =
    \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta') \bigr\} \cup
    \Delta'$, and subderivation is
    $\Delta' \vdash t' \triangleright \mathcal{R}_1$. ここで
    for subderivation $\Delta' \vdash t' \triangleright \mathcal{R}_1$,
    $\Delta' = \Delta'(t') \cup \Delta''$ s.t.
    $\bigl\{(t', \exists t'', \mathcal{R}_1, \exists \text{\it fin}',
    \Delta'') \bigr\} = \Delta'(t')$ from lemma
    \ref{polymorphic_environment_retrieving}, then
    $\mathpzc{Dom}(\Delta') = \mathpzc{Equ}(\Delta', t')$ by I.H. 成立.
    故に $\mathpzc{Equ}(\Delta, t) = \{t, t'\} \cup \mathpzc{Equ}(
    \Delta', t') = \{t, t'\} \cup \mathpzc{Dom}(\Delta') =
    \mathpzc{Dom}(\Delta)$.

    Case (T-Cat0-xtend-$\infty$): Similar to the case of (T-Cas-xtend).

    Case (T-Cat1-xtend-sol): Case (T-Cat1-xtend-$\infty$):
    Similar to the case of (T-Cat0-xtend-sol) and (T-Cat0-xtend-$\infty$)
    respectively.
    
    Case (T-Dup-xtend-sol): Case (T-Dup-xtend-$\infty$):
    Similar to the case of (T-Cat1-xtend-sol) and (T-Cat1-xtend-$\infty$)
    respectively.

    Case (T-Alt-xtend-L):
    Similar to the case of (T-Cat0-xtend-sol).

    Case (T-Alt-xtend-R):
    Similar to the case of (T-Alt-xtend-L).
    $\Box$.
  \end{Proof}
\end{Lemma}


\begin{Definition}
  \[ \mathpzc{sup}\bigl(\Delta(t) \bigr) \;\stackrel{\mathrm{def}}{:=}\;
      \begin{array}[t]{l}
        \mathpzc{id}(t_1)\ \text{\it for some}\
         t_1 \in \mathpzc{Equ}\Bigl(\bigl(\Delta(t) \cup \Delta' \bigr), t
          \Bigr)  \\
        \hphantom{\mathpzc{id}(t_1)\ \text{\it for some}\ }
         \quad \text{\it s.t.}\
          \biggl(\forall t_0 \in \mathpzc{Equ}\Bigl(\bigl(
           \Delta(t) \cup \Delta' \bigr), t \Bigr) \biggr).\bigl[
             \mathpzc{id}(t_0) \le \mathpzc{id}(t_1) \bigr]  \\
        \hphantom{\mathpzc{id}(t_1)\ \text{\it for some}\ }
         \quad \text{\it where}\
          (t, t', \mathcal{R}, \text{\it fin}, \Delta') = \Delta(t)
      \end{array}
  \]
\end{Definition}


\begin{Definition}
  \[ \mathpzc{fresh}\bigl(\Delta(t) \bigr) \;\stackrel{\mathrm{def}}{:=}\;
      \mathpzc{sup}\bigl(\Delta(t) \bigr) + 1
  \]
\end{Definition}


\begin{Lemma}{uniqueness on polymorphic typematching}
  \[ \Delta \vdash t \triangleright \mathcal{R} \;\Rightarrow\;
      \bigl(\forall t' \in \mathpzc{Equ}(\Delta, t) \bigr).
      \left[ \begin{array}{l}
        \!\! \Delta(t') = \bigl\{(t'_1, t''_1, \mathcal{R}'_1,
         {\text{\it fin}'}_1, \Delta''_1) \bigr\} \;\; \text{\it s.t.}\
          t'\; \text{\it is}\ t'_1\> \mbox{或}\ t''_1
      \end{array} \right]
  \]
  \begin{Proof}
    Proof is induction on structure of derivation for
    $\Delta \vdash t \triangleright \mathcal{R}$.
    
    Case (T-Atom0-xtend):
    From def. (T-Atom0-xtend), the judgement is
    $\Delta \vdash t \triangleright \mathcal{R}_0$, which $\Delta =
    \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi) \bigr\}$. Then,
    $\mathpzc{Equ}(\Delta, t) = \{t, t'_0 \}$, since
    $\Delta(t) = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi)
    \bigr\}(t) = \{t, t'_0 \}$, from def. of $\mathpzc{Equ}$. 故に
    $\Delta(t) = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi)
    \bigr\}(t) = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi)
    \bigr\}$, and
    $\Delta(t'_0) = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi)
    \bigr\}(t'_0) = \bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi)
    \bigr\}$.
    
    Case (T-Atom1-xtend): Same as the case of (T-Atom0-xtend).
    
    Case (T-Cas-xtend):
    From def. of (T-Cas-xtend), the judgement is
    $\Delta \vdash t \triangleright \mathcal{R}_1 \wedge \mathcal{R}_2$,
    which $\Delta = \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2)$. ここで
    $\mathpzc{Dom}(\Delta_1) \cap \mathpzc{Dom}(\Delta_2) = \phi$ and
    $\mathpzc{id}(t), \mathpzc{id}(t_1 \wedge t_2) \not\in
    \mathpzc{id}\bigl(\mathpzc{Dom}(\Delta_1 \cup \Delta_2) \bigr)$成立.
    また it's subderivation
    $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$ and
    $\Delta_2 \vdash t_2 \triangleright \mathcal{R}_2$について
    $\Delta_1 = \Delta(t_1) \cup \Delta'_1 \;\;\text{\it where}\
    (t_1, t'_1, \mathcal{R}_1, \text{\it fin}_1, \Delta'_1) = \Delta(t_1)$,
    and $\Delta_2 = \Delta(t_2) \cup \Delta'_2 \;\;\text{\it where}\
    (t_2, t'_2, \mathcal{R}_2, \text{\it fin}_2, \Delta'_2) = \Delta(t_2)$
    成立, from Lemma \ref{polymorphic_environment_retrieving}. よって
    $\Delta(t) = \Bigl\{\bigl(t, t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2)
    \bigr) \Bigr\}$, from lemma
    \ref{polymorphic_environment_retrieving}, および
    $\mathpzc{sub}_0(t_1 \wedge t_2, \wedge) = \{t_1, t_2 \}$より
    $\mathpzc{Equ}(\Delta, t) = \{t, t_1 \wedge t_2 \} \cup
    \bigl(\mathpzc{Equ}(\Delta'_{1e}, t_1) \cup \mathpzc{Equ}(\Delta'_{2e},
    t_2) \bigr)$, where $\Delta'_{1e}$ and $\Delta'_{2e}$ is from def. of
    $\mathpzc{Equ}$
    $= \{t, t_1 \wedge t_2 \} \cup \bigl(\mathpzc{Equ}(\Delta_{1}, t_1) \cup
    \mathpzc{Equ}(\Delta_{2}, t_2) \bigr)$. ここで
    $\forall t' \in \mathpzc{Equ}(\Delta_1, t_1)$について, by I.H.
    $\Delta_1(t') = \bigl\{(t'_1, t''_1, \mathcal{R}'_1, \text{\it fin}'_1,
    \Delta''_1 ) \bigr\}$ s.t. $t'$ is $t'_1$ 或 $t''_1$. かつ
    $\mathpzc{Dom}(\Delta_1) = \mathpzc{Equ}(\Delta_1, t_1)$, by
    subderivation $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$ and
    Lemma \ref{polymorphic_environment_extension}, より
    $\Delta_2(t') = \phi$, since
    $\phi = \mathpzc{Dom}(\Delta_1) \cap \mathpzc{Dom}(\Delta_2) =
    \mathpzc{Equ}(\Delta_1, t_1) \cap \mathpzc{Dom}(\Delta_2)$. また
    $\mathpzc{id}(t), \mathpzc{id}(t_1 \wedge t_2) \not\in
    \mathpzc{id}\bigl(\mathpzc{Dom}(\Delta_1 \cup \Delta_2) \bigr)$より
    $t, t_1 \wedge t_2 \not\in \mathpzc{Dom}(\Delta_1 \cup \Delta_2)$.
    Then $\mathpzc{Equ}(\Delta_1, t_1) = \mathpzc{Dom}(\Delta_1) \subset
    \mathpzc{Dom}(\Delta_1) \cup \mathpzc{Dom}(\Delta_2) =
    \mathpzc{Dom}(\Delta_1 \cup \Delta_2) \not\ni t, t_1 \wedge t_2$より
    $t, t_1 \wedge t_2 \not\in \mathpzc{Equ}(\Delta_1, t_1)$を得る. よって
    $\Bigl\{\bigr(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
    \wedge, (\Delta_1 \cup \Delta_2) \bigr) \bigr\}(t') = \phi$.
    故に for all $t' \in \mathpzc{Equ}(\Delta_1, t_1)$,
    $\Delta(t') = \biggl(\Bigl\{\bigl(t, t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2)
    \bigr) \Bigr\} \cup (\Delta_1 \cup \Delta_2) \biggr)(t') =
    \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
    \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}(t') \cup
    (\Delta_1 \cup \Delta_2)(t') =
    \phi \cup (\Delta_1 \cup \Delta_2)(t') =
    \Delta_1(t') \cup \Delta_2(t') = \Delta_1(t') \cup \phi = \Delta_1(t') =
    \bigl\{(t'_1, t''_1, \mathcal{R}'_1, \text{\it fin}'_1, \Delta''_1)
    \bigr\}$ s.t. $t'$ is $t'_1$ 或 $t''_1$. 同様に for all
    $t' \in \mathpzc{Equ}(\Delta_2, t_2)$,
    $\Delta(t') = \Delta_2(t') = \bigl\{(t'_2, t''_2, \mathcal{R}'_2,
    \text{\it fin}'_2, \Delta''_2) \bigr\}$
    s.t. $t'$ is $t'_2$ 或 $t''_2$. かつ
    for $t' \in \{t,\, t_1 \wedge t_2\}$, $\Delta(t') =
    \biggl(\Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2) \biggr)(t') =
    \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}(t') \cup
    (\Delta_1 \cup \Delta_2)(t') =
    \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}(t') \cup
    \phi = \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\}$ s.t.
    $t'$ is $t$ 或 $t_1 \wedge t_2$ respectively, since
    $t, t_1 \wedge t_2 \not\in \mathpzc{Dom}(\Delta_1 \cup \Delta_2)$.
    
    Case (T-Par-xtend): Similar to the case of (T-Cas-xtend).
    
    Case (T-Cat0-xtend-nil):
    From def. of (T-Cat0-xtend-nil), the judgement is
    $\Delta \vdash t \triangleright {\mathcal{R}_1}^*$, which
    $\Delta = \Bigl\{\bigl(t, \{\}, {\mathcal{R}_1}^*, \text{\it nil}, \phi
    \bigr) \Bigr\}$, and $t \simeq \{\}$. Then $\mathpzc{Equ}(\Delta, t) =
    \bigl\{t, \{\} \bigr\}$, since $\Delta(t) = \Bigl\{\bigl(t, \{\},
    {\mathcal{R}_1}^*, \text{\it nil}, \phi \bigr) \Bigr\}$. 故に
    for all $t' \in \mathpzc{Equ}(\Delta, t) = \bigl\{t, \{\} \bigr\}$,
    $\Delta(t') = \Bigl\{\bigl(t, \{\}, {\mathcal{R}_1}^*, \text{\it nil},
    \phi \bigr) \Bigr\}$ s.t. $t'$ is $t$ 或 $\{\}$ respectively.
    
    Case (T-Cat0-xtend-sol):
    From def. of (T-Cat0-xtend-sol), the judgement
    $\Delta \vdash t \triangleright {\mathcal{R}_1}^*$ is
    $\Delta = \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\} \cup \Delta'$ s.t.
    $\mathpzc{id}(t) \not\in \mathpzc{id}\bigl(\mathpzc{Dom}(\Delta')
    \bigr)$, and its subderivation is $\Delta' \vdash t' \triangleright
    \mathcal{R}_1$. ここで $\Delta' = \Delta(t') \cup \Delta''$ where
    $(t', t'', \mathcal{R}_1, \text{\it fin}', \Delta'') = \Delta(t')$,
    from lemma \ref{polymorphic_environment_retrieving}. これより
    from def. of $\mathpzc{Equ}$, $\mathpzc{Equ}(\Delta, t) = \{t, t'\} \cup
    \mathpzc{Equ}(\Delta', t')$, since $\mathpzc{sub}_0(t', \text{\it sol})
    = \{t'\}$. また subderivation
    $\Delta' \vdash t' \triangleright \mathcal{R}_1$より for all
    $t'_0 \in \mathpzc{Equ}(\Delta', t')$, $\Delta'(t'_0) = \bigl\{
    (t'_1, t''_1, \mathcal{R}'_1, \text{\it fin}'_1, \Delta''_1) \bigr\}$
    s.t. $t'_0$ is $t'_1$ 或 $t''_1$成立, by I.H. かつ
    $\mathpzc{Dom}(\Delta') = \mathpzc{Equ}(\Delta', t')$, from lemma
    \ref{polymorphic_environment_extension}, then
    $\mathpzc{id}(t) \not\in \mathpzc{id}\bigl(\mathpzc{Dom}(\Delta')
    \bigr)$より$t \not\in \mathpzc{Dom}(\Delta') =
    \mathpzc{Equ}(\Delta', t')$. よって
    $\Delta(t'_0) = \Bigl(\bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol},
    \Delta') \bigr\} \cup \Delta' \Bigr)(t'_0) =
    \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta') \bigr\}(t'_0)
    \cup \Delta'(t'_0) = \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol},
    \Delta') \bigr\}$, if $t'_0$ is $t'$ 若しくは, $= \bigl\{(t'_1, t''_1,
    \mathcal{R}'_1, \text{\it fin}'_1, \Delta''_1) \bigr\} = \Delta'(t'_0)$
    s.t. $t'_0$ is $t'_1$ 或 $t''_1$. および
    $\Delta(t) = \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\}$ from \ref{polymorphic_environment_retrieving},
    and here we recall that
    $\mathpzc{Equ}(\Delta, t) = \{t, t'\} \cup \mathpzc{Equ}(\Delta', t')$,
    より for all $t'_0 \in \mathpzc{Equ}(\Delta, t)$, $\Delta(t'_0) =
    \bigl\{(t'_1, t''_1, \mathcal{R}'_1, \text{\it fin}'_1, \Delta''_1)
    \bigr\}$ s.t. $t'_0$ is $t'_1$ 或 $t''_1$.
    
    Other cases are similar.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{completeness extended}
\label{completeness_extended}
  \[ \Gamma \vdash t: \mathcal{R} \;\Rightarrow\;
      \Delta \vdash t' \triangleright \mathcal{R}\
       \text{\it for some}\ t'\ \text{\it s.t.}\ t \equiv t'
  \]
  \begin{Proof}
    Proof is induction on structure of $t$.
    
    Case $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From lemma \ref{determinacy_of_finalizer}, we can predicate that
    finalizer is (T-Atom0-canon), and the judgement is
    $\bigl\{(t, \mathcal{R}_0) \bigr\} \vdash t: \mathcal{R}_0$ s.t.
    $t \equiv t_0$ where $(t_0, \mathcal{R}) \in \Gamma_{gnd}$.
    Here, we suppose $t' = \mathpzc{carv}\bigl(t, \mathpzc{id}(t) + 1
    \bigr)$, この時 $t \equiv \mathpzc{carv}\bigl(t, \mathpzc{id}(t) + 1
    \bigr) = t'$ then $t' \simeq t$ by (Identity) \& (Symmetry), and
    $\mathpzc{id}(t) < \mathpzc{id}(t) + 1 \le \mathpzc{id}\Bigl(
    \mathpzc{carv}\bigl(t, \mathpzc{id}(t) + 1 \bigr) \Bigr) =
    \mathpzc{id}(t')$, which implies that $t' \neq t$, by
    lemma \ref{equivalence_preservation_on_instantiation} and
    \ref{range_of_term-id} respectively.
    From all facts of above, we obtain
    $\bigl\{(t', t, \mathcal{R}_0, \text{\it gnd}, \phi) \bigr\} \vdash
    t' \triangleright \mathcal{R}_0$ s.t.
    $t \equiv \mathpzc{carv}\bigl(t, \mathpzc{id}(t) + 1 \bigr) = t'$ by
    applying (T-Atom0-xtend).
    
    Case $t_1$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Similar to the case of
    $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case $t_1 \wedge t_2$: In this case, the judgement is
    $\bigl\{(t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2) \bigr\}
    \cup (\Gamma_1 \cup \Gamma_2) \vdash t_1 \wedge t_2:
    \mathcal{R}_1 \wedge \mathcal{R}_2$, which has subderivations
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$. Here
    we can apply I.H. on both subderivations
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_2 \vdash t_2: \mathcal{R}_2$ to get
    $\Delta'_1 \vdash t'_1 \triangleright \mathcal{R}_1$ for some
    $\Delta'_1$, $t'_1$ s.t. $t_1 \equiv t'_1$ and
    $\Delta'_2 \vdash t'_2 \triangleright \mathcal{R}_2$ for some
    $\Delta'_2$, $t'_2$ s.t. $t_2 \equiv t'_2$ respectively.
    Then we make $\Delta'_1$ and $\Delta'_2$ disjoint, applying domain
    separator on both $\Delta'_1 \vdash t'_1 \triangleright \mathcal{R}_1$
    and $\Delta'_2 \vdash t'_2 \triangleright \mathcal{R}_2$ to have
    $\Delta''_1 \vdash \mathpzc{carv}(t'_1, m_1) \triangleright
    \mathcal{R}_1$ and
    $\Delta''_2 \vdash \mathpzc{carv}(t'_2, m_2) \triangleright
    \mathcal{R}_2$ s.t.
    $\mathpzc{Dom}(\Delta''_1) \cap \mathpzc{Dom}(\Delta''_2) = \phi$, where
    $\Delta''_1 = \mathpzc{adj}(\Delta'_1, t'_1, m_1)$,
    $\Delta''_2 = \mathpzc{adj}(\Delta'_2, t'_1, m_1)$ and
    $m_j = \left\{\!\! \begin{array}{l}
      m \;\;\text{\it if}\ j = 1  \\
      \mathpzc{fresh}\Bigl(\Delta''_1\bigl(\mathpzc{carv}(t'_1, m_1) \bigr)
       \Bigr) \;\;\text{\it otherwize},\ j = 2
    \end{array} \right.$. さらに we suppose that ${(t''_1 \wedge t''_2)}^j$
    s.t. $j = \mathpzc{fresh}\bigl(\Delta''_2(t''_2) \bigr)$ as
    term identifier, where $t''_1 = \mathpzc{carv}(t'_1, m_1)$ and
    $t''_2 = \mathpzc{carv}(t'_2, m_2)$, then
    ${(t''_1 \wedge t''_2)}^i \not\in \mathpzc{Dom}(\Delta''_1 \cup
    \Delta''_2)$成立 since $\mathpzc{fresh}\bigl(\Delta''_2(t''_2) \bigr)$
    satisfies $\bigl(\forall t_0 \in \mathpzc{Dom}(\Delta''_1 \cup
    \Delta''_2) \bigr).\Bigl[\mathpzc{id}(t_0) <
    \mathpzc{fresh}\bigl(\Delta''_2(t''_2) \bigr) \Bigr]$ from
    def. of $\mathpzc{fresh}$.
    Now we assume $t' = \mathpzc{carv}\Bigl(t_1 \wedge t_2,
    \mathpzc{fresh}\bigl(\Delta''_2(t''_2) \bigr) + 1 \Bigr)$, then we have
    $t' \neq {(t''_1 \wedge t''_2)}^j$ since
    $\mathpzc{id}\bigl({(t''_1 \wedge t''_2)}^j \bigr) = j < j + 1 =
    \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(t_1 \wedge t_2,
    \mathpzc{fresh}\bigl(\Delta''_2(t''_2) \bigr) + 1 \Bigr) \biggr) =
    \mathpzc{id}(t')$ from lemma \ref{range_of_term-id}. かつ
    $\bigl(\forall t_0 \in \mathpzc{Dom}(\Delta''_1 \cup \Delta''_2) \bigr).
    \bigl[\mathpzc{id}(t_0) < j \bigr]$より
    $t' \not\in \mathpzc{Dom}(\Delta''_1 \cup \Delta''_2)$ for
    $\bigl(\forall t_0 \in \mathpzc{Dom}(\Delta''_1 \cup \Delta''_2)
    \bigr).\bigl[\mathpzc{id}(t_0) < \mathpzc{id}(t') \bigr]$.
    INTUITIONISTIC EQUIVALENCE に関しては, 先ず
    $t'_1 \equiv \mathpzc{carv}(t'_1, m_1) = t''_1$ and
    $t'_2 \equiv \mathpzc{carv}(t'_2, m_2) = t''_2$, both are from
    lemma \ref{equivalence_preservation_on_instantiation} より
    $t'_1 \wedge t'_2 \equiv {(t''_1 \wedge t''_2)}^j$ by
    (E-Cas-canon) and (E-Ins-canon-R), then we have
    $t'_1 \wedge t'_2 \simeq {(t''_1 \wedge t''_2)}^j$ by (Identity). 一方
    $t_1 \equiv t'_1$ and $t_2 \equiv t'_2$, both are by I.H. as above, より
    we found that $t = t_1 \wedge t_2 \equiv t'_1 \wedge t'_2$ by
    (E-Cas-canon) and (E-Ins-canon-L), note that original
    $t = t_1 \wedge t_2$ has its own term identifier which we should
    attach by (E-Ins-canon-L),
    then we have $t \simeq t'_1 \wedge t'_2$ by (Identity). よって we apply
    (Transitivity) on $t = t_1 \wedge t_2 \equiv t'_1 \wedge t'_2$
    and $t'_1 \wedge t'_2 \simeq {(t''_1 \wedge t''_2)}^j$ to obtain
    $t \simeq {(t''_1 \wedge t''_2)}^j$. また $t' \simeq t$成立 for
    $t \equiv \mathpzc{carv}(t, j + 1) = t'$ from lemma
    \ref{equivalence_preservation_on_instantiation}. 故に we eventually
    derive $t' \simeq {(t''_1 \wedge t''_2)}^j$ by (Transitivity).
    From all of above facts as
    $\Delta''_1 \vdash t''_1 \triangleright \mathcal{R}_1$,
    $\Delta''_2 \vdash t''_2 \triangleright \mathcal{R}_2$,
    $\mathpzc{Dom}(\Delta''_1) \cap \mathpzc{Dom}(\Delta''_2) = \phi$,
    $t' \simeq {(t''_1 \wedge t''_2)}^j$ where
    $j = \mathpzc{fresh}\bigl(\Delta''_2(t''_2) \bigr)$,
    $t' \neq {(t''_1 \wedge t''_2)}^j$,$\,$
    $t', {(t''_1 \wedge t''_2)}^j \not\in \mathpzc{Dom}(\Delta''_1 \cup
    \Delta''_2)$, we apply (T-Cas-xtend) on them to obtain new judgement
    $\Bigl\{\bigl(t', {(t''_1 \wedge t''_2)}^j,
    \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge, (\Delta''_1 \cup \Delta''_2)
    \bigr) \Bigr\} \cup (\Delta''_1 \cup \Delta''_2) \vdash
    t' \triangleright \mathcal{R}_1 \wedge \mathcal{R}_2$ s.t.
    $t \equiv t'$ (recall that $t \equiv \mathpzc{carv}(t, j + 1) = t'$
    from lemma \ref{equivalence_preservation_on_instantiation}).
    
    Case $t_1 \vee t_2$: Similar to the case of $t_1 \wedge t_2$.
    
    Case $\{\}$: In this case, the finalizer is (T-Cat0-canon-nil), and
    we can assume that the judgement is
    $\bigl\{(t, {\mathcal{R}_1}^* ) \bigr\} \vdash t: {\mathcal{R}_1}^*$
    s.t. $t = {\{\}}^j \equiv \{\}$ for some term identifier $j$.
    Here we suppose that $t' = \mathpzc{carv}\bigl(t, \mathpzc{id}(t) + 1
    \bigr)$, then we have $t' \simeq t$ by applying (Identity) and
    (Symmetry) on $t \equiv t'$ which comes from
    $t \equiv \mathpzc{carv}\bigl(t, \mathpzc{id}(t) + 1 \bigr) = t'$ by
    lemma \ref{equivalence_preservation_on_instantiation}. また we have
    $t \simeq {\{\}}^j$ which $j = \mathpzc{id}(t) = \mathpzc{id}\bigl(
    {\{\}}^j \bigr)$ as original term $t$'s identifier, by applying
    (E-Ins-canon-R) and (Identity) on $t \equiv \{\}$ as above. Then
    we apply (Transitivity) on them to obtain $t' \simeq {\{\}}^j$.
    一方 accroding to $t' = \mathpzc{carv}\bigl(t, \mathpzc{id}(t) + 1
    \bigr)$, we found that $t' \neq t$ since
    $\mathpzc{id}(t) < \mathpzc{id}(t) + 1 =
    \mathpzc{id}\Bigl(\mathpzc{carv}\bigl(t, \mathpzc{id}(t) + 1 \bigr)
    \Bigr) = \mathpzc{id}(t')$. よって $t' \neq {\{\}}^j$ because of
    $t = {\{\}}^j$ as above. 故に From the above facts as
    $t' \simeq {\{\}}^j$ and $t' \neq {\{\}}^j$, we obtain
    $\Bigl\{\bigl(t', {\{\}}^j, {\mathcal{R}_1}^*, \text{\it nil}, \phi
    \bigr) \Bigr\} \vdash t' \triangleright {\mathcal{R}_1}^*$ s.t.
    $t \equiv t'$ by (T-Cat0-xtend-nil).
    
    Case $\{t_1\}$: In this case, the judgement is
    $\Bigl\{\bigl(\{t_1\}, {\mathcal{R}_1}^* \bigr) \Bigr\} \cup \Gamma_1
    \vdash \{t_1\}: {\mathcal{R}_1}^*$ which has subderivation
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$, then we have
    $\Delta'_1 \vdash t'_1 \triangleright \mathcal{R}_1$ s.t.
    $t_1 \equiv t'_1$ by I.H. Now we suppose
    $t' = \mathpzc{carv}\Bigl(t, \mathpzc{flesh}\bigl(\Delta'_1(t'_1) \bigr)
    \Bigr)$, then we have $t \simeq t'$ by (Identity) since
    $t = \mathpzc{carv}\Bigl(t, \mathpzc{flesh}\bigl(\Delta'_1(t'_1) \bigr)
    \Big) = t'$成立 from
    lemma \ref{equivalence_preservation_on_instantiation}. また
    according to the facts that
    $\mathpzc{flesh}\bigl(\Delta'_1(t'_1) \bigr) \le
    \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(t, \mathpzc{flesh}\bigl(
    \Delta'_1(t'_1) \bigr) \Bigr) \biggr) = \mathpzc{id}(t')$ and
    $\bigl(\forall t_0 \in \mathpzc{Dom}(\Delta'_1) \bigr).\Bigr[
    \mathpzc{id}(t_0) < \mathpzc{flesh}\bigl(\Delta'_1(t'_1) \bigr)
    \Bigr]$, we found that $t' \not\in \mathpzc{Dom}(\Delta'_1)$ since
    $\bigl(\forall t_0 \in \mathpzc{Dom}(\Delta'_1) \bigr).\bigr[
    \mathpzc{id}(t_0) < \mathpzc{id}(t') \bigr]$. 一方INTUITIONISTIC
    EQUIVALENCE について, 先ず we have $t'_1 \simeq \{t_1\}$ applying
    (Symmetry) and ($\text{\it Associativity-Cat0}_1$) on $t_1 \simeq t'_1$
    which comes from $t_1 \equiv t'_1$ by I.H. as above, then we attach
    appropriate term identfier to r.h.s. as
    $t'_1 \simeq \{t_1\} = t$ s.t. $\mathpzc{id}\bigl(\{t_1\} \bigr) =
    \mathpzc{id}(t)$. On the other hand, $t \simeq t'$成立 as above
    より we eventually got $t' \simeq t'_1$ by (Transitivity) and
    (Symmetry). From all of above as
    $t' \simeq t'_1$, $\Delta'_1 \vdash t'_1 \triangleright \mathcal{R}_1$,
    $t' \not\in \mathpzc{Dom}(\Delta'_1)$, we can apply (T-Cat0-xtend-sol)
    on them to obtain new judgement
    $\bigl\{(t', t'_1, {\mathcal{R}_1}^*, \text{\it sol}, \Delta'_1)
    \bigr\} \cup \Delta'_1 \vdash t' \triangleright {\mathcal{R}_1}^*$
    s.t. $t \equiv t'$.
    
    Case $\{t_1 \cdots t_n \}$, $n \ge 2$:
    From def. of (T-Cat0-canon-$\infty$), the judgement in this case is
    $\Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr) \Bigr\}
    \cup \bigcup_{j=1}^{n} \Gamma_j \vdash \{t_1 \cdots t_n \}:
    {\mathcal{R}_1}^*$ which subderivatins are
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\Gamma_j \vdash t_j: \mathcal{R}_1\, (2 \le j \le n)$ s.t.
    $\mathpzc{Dom}(\Gamma_j) \cap \mathpzc{Dom}(\Gamma_k) = \phi$
    if $j \neq k$ and
    $\{t_1 \cdots t_n \} \not\in \bigl(\mathpzc{Dom}(\Gamma_1) \cup
    \bigcup_{j=2}^{n} \mathpzc{Dom}(\Gamma_j) \bigr)$.
    Now, according to a fact of above that
    $\Gamma_j \vdash t_j: \mathcal{R}_1$ where $2 \le j \le n$, we found that
    $\{t_2 \cdots t_n \} \not\in \bigcup_{j=2}^{n} \mathpzc{Dom}(\Gamma_j)$
    since $\{t_2 \cdots t_n \} \not\in \mathpzc{sub}(t_j) =
    \mathpzc{Dom}(\Gamma_j)$ from lemma \ref{environment_extension},
    note that size of $\{t_2 \cdots t_n \}$ is properly greater than
    (size of) $t_j$. Therefore, from facts as
    $\Gamma_j \vdash t_j: {\mathcal{R}_1}^*$ where $2 \le j \le n$,
    $\mathpzc{Dom}(\Gamma_j) \cap \mathpzc{Dom}(\Gamma_k) = \phi$ if
    $j \neq k$,
    $\{t_2 \cdots t_n \} \not\in \bigcup_{j=2}^{n} \mathpzc{Dom}(\Gamma_j)$
    we obtain newly constructed derivation by applying
    (T-Cat0-canon-$\infty$) on them, and its judgement is
    $\Gamma_t \vdash \{t_2 \cdots t_n \}: {\mathcal{R}_1}^*$ which
    $\Gamma_t = \Bigl\{\bigl(\{t_2 \cdots t_n \}, {\mathcal{R}_1}^* \bigr)
    \Bigr\} \cup \bigcup_{j=2}^{n} \Gamma_j$. よって we can apply I.H. on
    $\Gamma_t \vdash \{t_2 \cdots t_n \}: {\mathcal{R}_1}^*$ to have
    $\Delta'_t \vdash t'_t \triangleright {\mathcal{R}_1}^*$ and
    $t_t \equiv t'_t$ from which we can derive $t_t \simeq t'_t$ by
    (Identity). 同様に we obtain
    $\Delta'_h \vdash t'_h \triangleright \mathcal{R}_1$ and
    $t_1 \simeq t'_h$ by applying I.H. on
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$. Here, we make
    $\Delta'_h \vdash t'_h \triangleright \mathcal{R}_1$ and
    $\Delta'_t \vdash t'_t \triangleright {\mathcal{R}_1}^*$ using
    domain separator. In the result of domain separation, we have 
    $\Delta''_h \vdash \mathpzc{carv}(t'_h, m_1) \triangleright
    \mathcal{R}_1$ and $\Delta''_t \vdash \mathpzc{carv}(t'_t, m_2)
    \triangleright {\mathcal{R}_1}^*$ s.t.
    $\mathpzc{Dom}(\Delta''_h) \cap \mathpzc{Dom}(\Delta''_t) = \phi$, where
    $\Delta''_h = \mathpzc{adj}(\Delta'_h, t'_h, m_1)$,
    $\Delta''_t = \mathpzc{adj}(\Delta'_t, t'_t, m_2)$ and
    $m_j = \left\{\!\! \begin{array}{l}
      m \;\; \text{\it if}\ j = 1  \\
      \mathpzc{fresh}\Bigl(\Delta''_h\bigl(\mathpzc{carv}(t'_h, m_1) \bigr)
       \Bigr) \;\; \text{\it otherwise},\ j = 2
    \end{array} \right.$ さらに we let
    $j = \mathpzc{fresh}\Bigl(\Delta''_t\bigl(\mathpzc{carv}(t'_t, m_2)
    \bigr) \Bigr)$ which satisfies
    $\bigl(\forall t_0 \in \mathpzc{Dom}(\Delta''_h \cup \Delta''_t) \bigr).
    \Bigl[\mathpzc{id}(t_0) < \mathpzc{fresh}\bigl(\Delta''_t(t''_t) \bigr)
    \Bigr]$ where $t''_t = \mathpzc{carv}(t'_t, m_2)$, from def. of $m_j $
    and $\mathpzc{fresh}\bigl(\Delta''_t(t''_t) \bigr)$, then we found
    that ${(t''_h \wedge t''_t)}^j \not\in \mathpzc{Dom}(\Delta''_h \cup
    \Delta''_t)$ which $j$ is a term identifier. 一方
    we assume $t' = \mathpzc{carv}(t, j + 1)$, then
    $t' \neq {(t''_h \wedge t''_t)}^j$ holds since $\mathpzc{id}(t')$
    satisfies $\mathpzc{id}(t''_h \wedge t''_t) = j < j + 1 \le
    \mathpzc{id}\bigl(\mathpzc{carv}(t, j + 1) \bigr) =
    \mathpzc{id}(t')$ from lemma \ref{range_of_term-id}. また
    $j < \mathpzc{id}(t')$ s.t. $\bigl(\forall t_0 \in \mathpzc{Dom}(
    \Delta''_h \cup \Delta''_t) \bigr).\bigl[\mathpzc{id}(t_0) < j \bigr]$
    as above より $t' \not\in \mathpzc{Dom}(\Delta''_h \cup \Delta''_t)$
    also 成立. 一方, INTUITIONISTIC EQUIVALENCE に関して From the facts
    that $t'_h \equiv \mathpzc{carv}(t'_h, m_1) = t''_h$ and
    $t'_t \equiv \mathpzc{carv}(t'_t, m_2) = t''_t$ are both by lemma
    \ref{equivalence_preservation_on_instantiation}, we got
    $t'_h \wedge t'_t \equiv {(t''_h \wedge t''_t)}^j$ where
    $j = \mathpzc{fresh}\bigl(\Delta''_t(t''_t) \bigr)$, by (E-Cas-canon)
    and (E-Ins-canon-R), then
    $t'_h \wedge t'_t \simeq {(t''_h \wedge t''_t)}^j$成立 by
    (Instantiation). On the other hand, From the facts we have already
    revealed above that $t_1 \simeq t'_h$ by I.H. on
    $\Gamma_1 \vdash t_1: \mathcal{R}_1$ and
    $\{t_2 \cdots t_n \} = t_t \simeq t'_t$ by I.H. on newly constructed
    derivaton, we have $t_1 \wedge \{t_2 \cdots t_n \} \simeq
    t'_h \wedge t'_t$ by applying (Transparency-Cas), consequently we found
    that $t'_h \wedge t'_t \simeq \{t_1 \cdots t_n \}$ holds by (Symmetry)
    and ($\text{\it AssociativityH-Cat0}_\infty$), then we attach
    $\mathpzc{id}(t)$ on $\{t_1 \cdots t_n \}$ of r.h.s. to obtain
    $\{t_1 \cdots t_n \} = t \simeq t'_h \wedge t'_t$ with (Symmetry).
    ここで recall that $t'_h \wedge t'_t \simeq {(t''_h \wedge t''_t)}^j$,
    then we have $t \simeq {(t''_h \wedge t''_t)}^j$ by (Transitivity).
    かつ $t' \simeq t$, since $t \equiv \mathpzc{carv}(t, j + 1) = t'$
    from lemma \ref{equivalence_preservation_on_instantiation} より, we
    finally obtain $t' \simeq {(t''_h \wedge t''_t)}^j$ by (Transitivity).
    故に we can apply (T-Cat0-xtend-$\infty$) on all facts we have derived
    above that are
    $\Delta''_h \vdash t''_h \triangleright \mathcal{R}_1$,
    $\Delta''_t \vdash t''_t \triangleright {\mathcal{R}_1}^*$,
    $\mathpzc{Dom}(\Delta''_h) \cap \mathpzc{Dom}(\Delta''_t) = \phi$,
    $t' \simeq {(t''_h \wedge t''_t)}^j$ where
    $j = \mathpzc{fresh}\bigl(\Delta''_t(t''_t) \bigr)$,
    $t' \neq {(t''_h \wedge t''_t)}^j$, $\,$
    $t', {(t''_h \wedge t''_t)}^j \not\in \mathpzc{Dom}(\Delta''_h \cup
    \Delta''_t)$ to obtain new judgement
    $\Bigl\{\bigl(t', {(t''_h \wedge t''_t)}^j, {\mathcal{R}_1}^*, \infty,
    (\Delta''_h \cup \Delta''_t) \bigl) \Bigr\} \cup (\Delta''_h \cup
    \Delta''_t) \vdash t' \triangleright {\mathcal{R}_1}^*$ s.t.
    $t \equiv t'$.
    
    Case $[t_1 \cdots t_n ]$: Similar to the case of $\{t_1 \cdots t_n \}$.
    
    Case $\langle t_1 \cdots t_n \rangle$:
    Similar to the case of $[t_1 \cdots t_n ]$.

    Case $\circ$: Similar to the case of $\{\}$.
    
    Case ${t_1}^?$: Similar to the case of $\{t_1\}$.
    
    Case ${t_1}^\leftarrow$: Similar to the case of ${t_1}^?$.
    
    Case ${t_1}^\rightarrow$: Similar to the case of ${t_1}^\leftarrow$.
    $\Box$
  \end{Proof}
\end{Lemma}


\pagebreak
\begin{Definition}
  項形態変換(TERM TRANSMODELING)項形態変換$g^{\Gamma}:t \rightarrow t$を
  以下のように定義する.
  \[
    \begin{array}{rll}
      g^{\Gamma}(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi)
      & \stackrel{\mathrm{def}}{:=} &t'_0\
      \text{\it s.t.}\ t'_0 \equiv t_0\
      \text{\it where}\ (t_0, \mathcal{R}_0) \in \Gamma_{gnd}  \\
      
      g^{\Gamma}(t, t'_1, \mathcal{R}_1, \text{\it def}, \phi)
      & \stackrel{\mathrm{def}}{:=} &t'_1\
      \text{\it s.t.}\ t'_1 \equiv t_1\
      \text{\it where}\ (t_1, \mathcal{R}_1) \in \Gamma_{def}  \\
      
      g^{\Gamma}(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
      \wedge, \Delta')
      & \stackrel{\mathrm{def}}{:=}
      & \!\!\! \begin{array}[t]{l}
          {\biggl(\mathpzc{carv}\Bigl(g^{\Gamma} \bigl(\Delta'(t_1) \bigr),
           m \Bigr)
          \wedge \mathpzc{carv}\Bigl(g^{\Gamma} \bigl(\Delta'(t_2) \bigr),
          m'\Bigr) \biggr)}^i  \\
          \quad \text{\it where} \! \begin{array}[t]{l}
            m' = \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
             \Delta'(t_1) \bigr), m \Bigr) \biggr) + 1  \\
            i = \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
             \Delta'(t_2) \bigr), m' \Bigr) \biggr) + 1
            \end{array}
        \end{array}  \\ [30pt]
     
      g^{\Gamma}(t, t_1 \vee t_2, \mathcal{R}_1 \vee \mathcal{R}_2, \vee,
      \Delta')
      & \stackrel{\mathrm{def}}{:=}
      & \!\!\! \begin{array}[t]{l}
          {\biggl(\mathpzc{carv}\Bigl(g^{\Gamma} \bigl(\Delta'(t_1) \bigr),
           m \Bigr) \vee
          \mathpzc{carv}\Bigl(g^{\Gamma} \bigl(\Delta'(t_2) \bigr),
           m'\Bigr) \biggr)}^i  \\
          \quad \text{\it where} \! \begin{array}[t]{l}
            m' = \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
             \Delta'(t_1) \bigr), m \Bigr) \biggr) + 1  \\
            i = \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
             \Delta'(t_2) \bigr), m' \Bigr) \biggr) + 1
          \end{array}
        \end{array}  \\
      
      g^{\Gamma}\bigl(t, \{\}, \mathcal{R}^*, \text{\it nil}, \phi \bigr)
      & \stackrel{\mathrm{def}}{:=}
      & \{\}  \\
      
      g^{\Gamma}(t, t', \mathcal{R}_1^*, \text{\it sol}, \Delta' \bigr)
      & \stackrel{\mathrm{def}}{:=}
      & {\biggl\{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t') \bigr), m
         \Bigr) \biggr\}}^i\
          \text{\it where}\ i = \mathpzc{id}\biggl(\mathpzc{carv}
           \Bigl(g^{\Gamma} \bigl(\Delta'(t') \bigr), m \Bigr)
            \biggr) + 1  \\ 
      [9pt]
      g^{\Gamma}(t, t_h \wedge t_t, \mathcal{R}_1^*, \infty, \Delta' \bigr)
      & \stackrel{\mathrm{def}}{:=}
      & \!\!\! \begin{array}[t]{l}
          {\biggl\{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr),
           m \Bigr) \biggr\}}^{m'} \quad \text{\it if}\;\;
            \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_t) \bigr), m'
             \Bigr) = \{\}  \\
             \quad \text{\it s.t.} \! \begin{array}[t]{l}
               \Delta'(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1,
                \text{\it fin}_h, \Delta'_h ) \bigr\}  \\
               \Delta'(t_t) = \bigl\{(t_t, t'_t, {\mathcal{R}_1}^*,
               \text{\it fin}_t, \Delta'_t ) \bigr\}
             \end{array}  \\
           \quad \text{\it where}\ m' = \mathpzc{id}\biggl(\mathpzc{carv}
            \Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m \Bigr) \biggr) + 1
        \end{array}  \\ [55pt]
      
      g^{\Gamma}(t, t_h \wedge t_t, \mathcal{R}_1^*, \infty, \Delta' \bigr)
      & \stackrel{\mathrm{def}}{:=}
      & \!\!\! \begin{array}[t]{l}
          {\biggl\{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr),
           m \Bigr), t_1 \cdots t_n \biggr\}}^{i'}  \\
          \quad \text{\it if}\;\; \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
           \Delta'(t_t) \bigr), m' \Bigr) = {\{t_1 \cdots t_n \}}^{i'}  \\
          \quad \text{\it s.t.} \! \begin{array}[t]{l}
            \Delta'(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1,
             \text{\it fin}_h, \Delta'_h ) \bigr\}  \\
            \Delta'(t_t) = \bigl\{(t_t, t'_t, {\mathcal{R}_1}^*,
             \text{\it fin}_t, \Delta'_t ) \bigr\}
          \end{array}  \\ 
          \quad \text{\it where}\ m' = \mathpzc{id}\biggl(\mathpzc{carv}
            \Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m \Bigr) \biggr) + 1
      \end{array}  \\
      
      g^{\Gamma}(t, t', \mathcal{R}_1^+, \text{\it sol}, \Delta' \bigr)
      & \stackrel{\mathrm{def}}{:=}
      & {\biggl[\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t') \bigr), m
         \Bigr) \biggr]}^i\
          \text{\it where}\ i = \mathpzc{id}\biggl(\mathpzc{carv}
           \Bigl(g^{\Gamma} \bigl(\Delta'(t') \bigr), m \Bigr)
            \biggr) + 1  \\
      [9pt]
                
      g^{\Gamma}(t, t_h \wedge t_t, \mathcal{R}_1^+, \infty, \Delta' \bigr)
      & \stackrel{\mathrm{def}}{:=}
      & \!\!\! \begin{array}[t]{l}
          {\biggl[\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr),
           m \Bigr), t_1 \cdots t_n \biggr]}^{i'}  \\
          \quad \text{\it if}\;\; \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
           \Delta'(t_t) \bigr), m' \Bigr) = {[t_1 \cdots t_n ]}^{i'}  \\
          \quad \text{\it s.t.} \! \begin{array}[t]{l}
            \Delta'(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1,
             \text{\it fin}_h, \Delta'_h ) \bigr\}  \\
            \Delta'(t_t) = \bigl\{(t_t, t'_t, {\mathcal{R}_1}^*,
             \text{\it fin}_t, \Delta'_t ) \bigr\}
          \end{array}  \\ 
          \quad \text{\it where}\ m' = \mathpzc{id}\biggl(\mathpzc{carv}
           \Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m \Bigr) \biggr) + 1
      \end{array}
    \end{array}
  \]
  \[
    \begin{array}{rll}
      g^{\Gamma}(t, t', \mathcal{R}_1^{\downarrow}, \text{\it sol},
      \Delta' \bigr)
      & \stackrel{\mathrm{def}}{:=}
      & {\biggl\langle \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t')
         \bigr), m \Bigr) \biggr \rangle}^i\
          \text{\it where}\ i = \mathpzc{id}\biggl(\mathpzc{carv}
           \Bigl(g^{\Gamma} \bigl(\Delta'(t') \bigr), m \Bigr) \biggr) + 1 \\ 
      
       g^{\Gamma}(t, t_h \vee t_t, \mathcal{R}_1^{\downarrow}, \infty,
      \Delta' \bigr)
      & \stackrel{\mathrm{def}}{:=}
      & \!\!\! \begin{array}[t]{l}
          {\biggl\langle \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_h)
           \bigr), m \Bigr), t_1 \cdots t_n \biggr\rangle}^{i'}  \\
          \quad \text{\it if}\;\; \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
           \Delta'(t_t) \bigr), m' \Bigr) =
            {\langle t_1 \cdots t_n \rangle}^{i'}  \\
          \quad \text{\it s.t.} \! \begin{array}[t]{l}
            \Delta'(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1,
             \text{\it fin}_h, \Delta'_h ) \bigr\}  \\
            \Delta'(t_t) = \bigl\{(t_t, t'_t, {\mathcal{R}_1}^{\downarrow},
             \text{\it fin}_t, \Delta'_t ) \bigr\}
          \end{array}  \\ 
          \quad \text{\it where}\ m' = \mathpzc{id}\biggl(\mathpzc{carv}
           \Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m \Bigr) \biggr) + 1
      \end{array}  \\ [7pt]
      
      g^{\Gamma}(t, \circ, \mathcal{R}^?, \text{\it nil}, \phi )
      & \stackrel{\mathrm{def}}{:=}
      & \circ  \\
      
      g^{\Gamma}(t, t', \mathcal{R}_1^?, \text{\it sol}, \Delta' )
      & \stackrel{\mathrm{def}}{:=}
      & {{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t') \bigr), m
         \Bigr)}^?}^i\
          \text{\it where}\ i = \mathpzc{id}\biggl(\mathpzc{carv}
           \Bigl(g^{\Gamma} \bigl(\Delta'(t') \bigr), m \Bigr) \biggr) + 1\\
      [7pt]
                
      g^{\Gamma}(t, t', \mathcal{R}_1 | \mathcal{R}_2, \text{\it L},
       \Delta' )
      & \stackrel{\mathrm{def}}{:=}
      & {{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t') \bigr), m
         \Bigr)}^\leftarrow}^i\
          \text{\it where}\ i = \mathpzc{id}\biggl(\mathpzc{carv}
          \Bigl(g^{\Gamma} \bigl(\Delta'(t') \bigr), m \Bigr) \biggr) + 1\\
      [8pt]
               
      g^{\Gamma}(t, t', \mathcal{R}_1 | \mathcal{R}_2, \text{\it R},
       \Delta' )
      & \stackrel{\mathrm{def}}{:=}
      & {{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t') \bigr), m
         \Bigr)}^\rightarrow}^i\
          \text{\it where}\ i = \mathpzc{id}\biggl(\mathpzc{carv}
           \Bigl(g^{\Gamma} \bigl(\Delta'(t') \bigr), m \Bigr) \biggr) + 1\\
    \end{array}
  \]
\end{Definition}


\begin{Definition}
  型束縛形態変換(BINDING TRANSMODELING)型束縛形態変換
  $G^{\Gamma}:\Delta \rightarrow \Gamma$を以下のように定義する.
  \[ \begin{array}{rll}
       G^{\Gamma}(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi)
       & \stackrel{\mathrm{def}}{:=}
       & \Bigl\{\bigl(g^{\Gamma}(t, t'_0, \mathcal{R}_0, \text{\it gnd},
          \phi), \mathcal{R}_0 \bigr) \Bigr\}  \\ [3pt]
       G^{\Gamma}(t, t'_1, \mathcal{R}_1, \text{\it def}, \phi)
       & \stackrel{\mathrm{def}}{:=}
       & \Bigl\{\bigl(g^{\Gamma}(t, t'_1, \mathcal{R}_1, \text{\it def},
          \phi), \mathcal{R}_1 \bigr) \Bigr\}  \\ [3pt]
       
       G^{\Gamma}(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
        \wedge, \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \!\!\! \begin{array}[t]{l}
           \Bigl\{\bigl(g^{\Gamma}(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
            \mathcal{R}_2, \wedge, \Delta'),
             \mathcal{R}_1 \wedge \mathcal{R}_2  \bigr) \Bigr\}  \\
            \cup \!\! \begin{array}[t]{l}
              \biggl(\mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t_1)
               \bigr), g^{\Gamma}\bigl(\Delta'(t_1) \bigr), m \Bigr) \\
              \ \ \cup \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t_2)
               \bigr), g^{\Gamma}\bigl(\Delta'(t_2) \bigr), m' \Bigr)
                \biggr)
            \end{array}  \\
            \quad \text{\it where}\ m' = \text{\it id}\biggl(
            \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_1) \bigr), m
            \Bigr) \biggr) + 1
         \end{array}  \\ [76pt]
       
       G^{\Gamma}(t, t_1 \vee t_2, \mathcal{R}_1 \vee \mathcal{R}_2,
        \vee, \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \!\!\! \begin{array}[t]{l}
           \Bigl\{\bigl(g^{\Gamma}(t, t_1 \vee t_2, \mathcal{R}_1 \vee
            \mathcal{R}_2, \vee, \Delta'), \mathcal{R}_1 \vee \mathcal{R}_2
             \bigr) \Bigr\}  \\
            \cup \!\! \begin{array}[t]{l}
             \biggl(\mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t_1)
              \bigr), g^{\Gamma}\bigl(\Delta'(t_1) \bigr), m \Bigr) \\
              \ \ \cup \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t_2)
               \bigr), g^{\Gamma}\bigl(\Delta'(t_2) \bigr), m' \Bigr)
                \biggr)
            \end{array}  \\
            \quad \text{\it where}\ m' = \text{\it id}\biggl(
            \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_1) \bigr), m
            \Bigr) \biggr) + 1
         \end{array}  \\
       
       G^{\Gamma}\bigl(t, \{\}, \mathcal{R}^*, \text{\it nil}, \phi \bigr)
       & \stackrel{\mathrm{def}}{:=}
       & \biggl\{\Bigl(g^{\Gamma}\bigl(t, \{\}, {\mathcal{R}_1}^*,
          \text{\it nil}, \phi \bigr), {\mathcal{R}_1}^* \Bigr)
           \biggr\}  \\ 
     \end{array}
  \]
  \[ \begin{array}{rll}
       
       G^{\Gamma}(t, t', \mathcal{R}^*, \text{\it sol}, \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \biggl\{\bigl(g^{\Gamma}(t, t', {\mathcal{R}_1}^*, \text{\it sol},
          \Delta'), {\mathcal{R}_1}^* \bigr) \biggr\} \cup
           \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t') \bigr),
            g^{\Gamma}\bigl(\Delta'(t') \bigr), m \Bigr)  \\
       
       G^{\Gamma}(t, t_h \wedge t_t, {\mathcal{R}_1}^*, \infty, \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \!\!\! \begin{array}[t]{l}
           \Bigl\{\bigl(g^{\Gamma}(t, t_h \wedge t_t, {\mathcal{R}_1}^*,
            \infty, \Delta'), {\mathcal{R}_1}^* \bigr) \Bigr\}  \\
           \cup \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t_h) \bigr),
            g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m \Bigr)  \\
           \quad \text{\it if}\;\; \text{\it carv}\Bigl(g^{\Gamma}\bigl(
            \Delta'(t_t) \bigr), m' \Bigr) = \{\}  \\
           \quad \text{\it s.t.} \! \begin{array}[t]{l}
             \Delta'(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1,
              \text{\it fin}_h, \Delta'_h) \bigr\}  \\
             \Delta'(t_t) = \bigl\{(t_t, t'_t, {\mathcal{R}_1}^*,
              \text{\it fin}_t, \Delta'_t) \bigr\}
           \end{array}  \\
           \quad \text{\it where}\ m' = \text{\it id}\biggl(
            \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m
             \Bigr) \biggr) + 1
       \end{array}  \\
       
       G^{\Gamma}(t, t_h \wedge t_t, {\mathcal{R}_1}^*, \infty, \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \!\!\! \begin{array}[t]{l}
           \Bigl\{\bigl(g^{\Gamma}(t, t_h \wedge t_t, {\mathcal{R}_1}^*,
            \infty, \Delta'), {\mathcal{R}_1}^* \bigr) \Bigr\}  \\
           \cup \biggl(\mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t_h)
            \bigr), g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m \Bigr) \cup
             \Gamma' \biggr)  \\
           \quad \text{\it if}\;\; \text{\it carv}\Bigl(g^{\Gamma}\bigl(
            \Delta'(t_t) \bigr), m' \Bigr) = \{t_1 \cdots t_n \}
       \end{array}  \\
       \multicolumn{3}{r}{
         \begin{array}{l}
           \text{\it where}\ \Gamma' = \mathpzc{adj}\Bigl(
            G^{\Gamma}\bigl(\Delta'(t_t) \bigr), g^{\Gamma}\bigl(
             \Delta'(t_t) \bigr), m' \Bigr) \setminus \Biggl\{\biggl(
              \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_t) \bigr), m'
               \Bigr), {\mathcal{R}_1}^* \biggr) \Biggr\}  \\
           \hphantom{\text{\it where}}\ m' = \text{\it id}\biggl(
            \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m
             \Bigr) \biggr) + 1  \\
           
           \text{\it s.t.} \! \begin{array}[t]{l}
             \Delta'(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1,
              \text{\it fin}_h, \Delta'_h ) \bigr\}  \\
             \Delta'(t_t) = \bigl\{(t_t, t'_t, {\mathcal{R}_1}^*,
              \text{\it fin}_t, \Delta'_t ) \bigr\}  \\
           \end{array}
         \end{array}
       }  \\
       
       G^{\Gamma}(t, t', \mathcal{R}^+, \text{\it sol}, \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \biggl\{\bigl(g^{\Gamma}(t, t', {\mathcal{R}_1}^+, \text{\it sol},
          \Delta'), {\mathcal{R}_1}^+ \bigr) \biggr\} \cup
           \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t') \bigr),
            g^{\Gamma}\bigl(\Delta'(t') \bigr), m \Bigr)  \\
       
       G^{\Gamma}(t, t_h \wedge t_t, {\mathcal{R}_1}^+, \infty, \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \!\!\! \begin{array}[t]{l}
           \Bigl\{\bigl(g^{\Gamma}(t, t_h \wedge t_t, {\mathcal{R}_1}^+,
            \infty, \Delta'), {\mathcal{R}_1}^+ \bigr) \Bigr\}  \\
           \cup \biggl(\mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t_h)
            \bigr), g^{\Gamma}\bigl(\Delta'(t_t) \bigr), m \Bigr) \cup
             \Gamma' \biggr)  \\
           \quad \text{\it if}\;\; \text{\it carv}\Bigl(g^{\Gamma}\bigl(
            \Delta'(t_t) \bigr), m' \Bigr) = [t_1 \cdots t_n ]
       \end{array}  \\
       \multicolumn{3}{r}{
         \begin{array}{l}
           \text{\it where}\ \Gamma' = \mathpzc{adj}\Bigl(
            G^{\Gamma}\bigl(\Delta'(t_t) \bigr), g^{\Gamma}\bigl(
             \Delta'(t_t) \bigr), m' \Bigr) \setminus \Biggl\{\biggl(
              \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_t) \bigr), m'
               \Bigr), {\mathcal{R}_1}^+ \biggr) \Biggr\}  \\
           \hphantom{\text{\it where}}\ m' = \text{\it id}\biggl(
            \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m
             \Bigr) \biggr) + 1  \\              
           
           \text{\it s.t.} \! \begin{array}[t]{l}
             \Delta'(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1,
              \text{\it fin}_h, \Delta'_h ) \bigr\}  \\
             \Delta'(t_t) = \bigl\{(t_t, t'_t, {\mathcal{R}_1}^+,
              \text{\it fin}_t, \Delta'_t ) \bigr\}  \\
           \end{array}
         \end{array}
       }   \\
       
       G^{\Gamma}(t, t', \mathcal{R}^{\downarrow}, \text{\it sol}, \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \biggl\{\bigl(g^{\Gamma}(t, t', {\mathcal{R}_1}^{\downarrow},
          \text{\it sol}, \Delta'), {\mathcal{R}_1}^{\downarrow} \bigr)
           \biggr\} \cup \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t')
            \bigr), g^{\Gamma}\bigl(\Delta'(t') \bigr), m \Bigr)  \\
       
       G^{\Gamma}(t, t_h \vee t_t, {\mathcal{R}_1}^{\downarrow}, \infty,
        \Delta')
       & \stackrel{\mathrm{def}}{:=}
       & \!\!\! \begin{array}[t]{l}
          \Bigl\{\bigl(g^{\Gamma}(t, t_h \vee t_t,
           {\mathcal{R}_1}^{\downarrow}, \infty, \Delta'),
            {\mathcal{R}_1}^{\downarrow} \bigr) \Bigr\}  \\
          \cup \biggl(\mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t_h)
            \bigr), g^{\Gamma}\bigl(\Delta'(t_t) \bigr), m \Bigr) \cup
             \Gamma' \biggr)  \\
           \quad \text{\it if}\;\; \text{\it carv}\Bigl(g^{\Gamma}\bigl(
            \Delta'(t_t) \bigr), m' \Bigr) =
             \langle t_1 \cdots t_n \rangle
       \end{array}  \\
       \multicolumn{3}{r}{
         \begin{array}{l}
           \text{\it where}\ \Gamma' = \mathpzc{adj}\Bigl(
            G^{\Gamma}\bigl(\Delta'(t_t) \bigr), g^{\Gamma}\bigl(
             \Delta'(t_t) \bigr), m' \Bigr) \setminus \Biggl\{\biggl(
              \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_t) \bigr), m'
               \Bigr), {\mathcal{R}_1}^{\downarrow} \biggr) \Biggr\}  \\
           \hphantom{\text{\it where}}\ m' = \text{\it id}\biggl(
            \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t_h) \bigr), m
             \Bigr) \biggr) + 1  \\
           \text{\it s.t.} \! \begin{array}[t]{l}
             \Delta'(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1,
              \text{\it fin}_h, \Delta'_h ) \bigr\}  \\
             \Delta'(t_t) = \bigl\{(t_t, t'_t, {\mathcal{R}_1}^{\downarrow},
              \text{\it fin}_t, \Delta'_t ) \bigr\}  \\
           \end{array}
         \end{array}
       }  \\

     \end{array}
  \]
  \[ \begin{array}{rll}
       
       G^{\Gamma}(t, \circ, {\mathcal{R}_1}^?, \text{\it nil}, \phi )
       & \stackrel{\mathrm{def}}{:=}
       & \Bigl\{\bigl(g^{\Gamma}(t, \circ, {\mathcal{R}_1}^?,
          \text{\it nil}, \phi ), {\mathcal{R}_1}^? \bigr) \Bigr\}  \\
       
       G^{\Gamma}(t, t', \mathcal{R}_1 | \mathcal{R}_2, \text{\it L},
        \Delta') 
       & \stackrel{\mathrm{def}}{:=}
       & \Bigl\{\bigl(g^{\Gamma}(t, t', \mathcal{R}_1 | \mathcal{R}_2,
          \text{\it L}, \Delta'), \mathcal{R}_1 | \mathcal{R}_2 \bigr)
           \Bigr\} \cup \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t')
            \bigr), g^{\Gamma}\bigl(\Delta'(t') \bigr), m \Bigr)  \\
       
       G^{\Gamma}(t, t', \mathcal{R}_1 | \mathcal{R}_2, \text{\it R},
        \Delta') 
       & \stackrel{\mathrm{def}}{:=}
       & \Bigl\{\bigl(g^{\Gamma}(t, t', \mathcal{R}_1 | \mathcal{R}_2,
          \text{\it R}, \Delta'), \mathcal{R}_1 | \mathcal{R}_2 \bigr)
           \Bigr\} \cup \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t')
            \bigr), g^{\Gamma}\bigl(\Delta'(t') \bigr), m \Bigr)
     \end{array}
  \]
\end{Definition}


\begin{Lemma}{soundness extended}
\label{soundness_extended}
  \[ \Delta \vdash t \triangleright \mathcal{R} \;\Rightarrow\;
      G^{\Gamma}\bigl(\Delta(t) \bigr) \vdash g^{\Gamma}\bigl(
       \Delta(t) \bigr): \mathcal{R}\;\;
        \text{\it s.t.}\ t \simeq g^{\Gamma}\bigl(\Delta(t) \bigr)
  \]
  \begin{Proof}
    Proof is induction on structure of derivation for
    $\Delta \vdash t \triangleright \mathcal{R}$.
    
    Case (T-Atom0-xtend):
    For this case, the judgement is
    $\bigl\{(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi) \bigr\} \vdash
    t \triangleright \mathcal{R}_0$ s.t. $t \simeq t'_0$ and
    $t'_0 \equiv t_0$ hold, where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    また$g^{\Gamma}(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi) = t'_0$
    and $G^{\Gamma}(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi) =
    \Bigl\{\bigl(g^{\Gamma}(t, t'_0, \mathcal{R}_0, \text{\it gnd}, \phi),
    \mathcal{R}_0 \bigr) \Bigr\} = \bigl\{(t'_0, \mathcal{R}_0) \bigr\}$,
    from def. of $g^{\Gamma}$ and $G^{\Gamma}$ respectively. ここで
    $t'_0 \equiv t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$より
    $\bigl\{(t'_0, \mathcal{R}_0 ) \bigr\} \vdash t'_0: \mathcal{R}_0$
    from (T-Atom0-canon), s.t. $G^{\Gamma}\bigl(\Delta(t) \bigr) = \bigl\{
    (t'_0, \mathcal{R}_0 ) \bigr\}$, and
    $g^{\Gamma}\bigl(\Delta(t) \bigr) = t'_0$ then
    $t \simeq t'_0 = g^{\Gamma}\bigl(\Delta(t) \bigr)$.

    Case (T-Atom1-xtend): Same as the case of (T-Atom0-xtend).

    Case (T-Cas-xtend): The judgement is
    $\Delta \vdash t \triangleright \mathcal{R}_1 \wedge \mathcal{R}_2$,
    which $\Delta = \Bigl\{\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge
    \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2) \bigr) \Bigr\} \cup
    (\Delta_1 \cup \Delta_2)$ s.t. $t \simeq t_1 \wedge t_2$ and
    $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$,
    $\Delta_2 \vdash t_2 \triangleright \mathcal{R}_2$ as
    its subderivations. ここで according to subderivations, we obtain both
    $G^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \vdash g^{\Gamma}\bigl(\Delta_1(
    t_1) \bigr): \mathcal{R}_1$ and
    $G^{\Gamma}\bigl(\Delta_2(t_2) \bigr) \vdash g^{\Gamma}\bigl(\Delta_2(
    t_2) \bigr): \mathcal{R}_2$ s.t.
    $t_1 \simeq g^{\Gamma}\bigl(\Delta_1(t_1) \bigr)$ and
    $t_2 \simeq g^{\Gamma}\bigl(\Delta_2(t_2) \bigr)$ respectively, by I.H.
    ここで we can make
    $G^{\Gamma}\bigl(\Delta_1(t_1) \bigr)$ and
    $G^{\Gamma}\bigl(\Delta_2(t_2) \bigr)$ disjoint using
    lemma \ref{domain_separator}.
    Then $\mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta_1(t_1) \bigr),
    g^{\Gamma}\bigl(\Delta_1(t_1) \bigr), m_1 \Bigr) \vdash
    \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_1(t_1) \bigr), m_1 \Bigr):
    \mathcal{R}_1$ and
    $\mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta_2(t_2) \bigr),
    g^{\Gamma}\bigl(\Delta_2(t_2) \bigr), $
    $m_2 \Bigr) \vdash \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_2(t_2)
    \bigr), m_2 \Bigr): \mathcal{R}_2$ s.t.
    $\mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \Bigr) \cap
    \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_2(t_2) \bigr) \Bigr) = \phi$,
    where we let
    $G'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) = \mathpzc{adj}\Bigl(
    G^{\Gamma}\bigl(\Delta_1(t_1) \bigr), g^{\Gamma}\bigl(\Delta_1(t_1)
    \bigr), m_1 \Bigr)$ and
    $G'^{\Gamma}\bigl(\Delta_2(t_2) \bigr) = \mathpzc{adj}\Bigl(
    G^{\Gamma}\bigl(\Delta_2(t_2) \bigr), g^{\Gamma}\bigl(\Delta_2(t_2)
    \bigr),$
    $m_2 \Bigr)$ および
    $m_j = \left\{ \!\! \begin{array}[c]{l}
       m\ \text{\it if}\;\; j = 1  \\
       \text{\it id}\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_1(t_1)
       \bigr), m_1 \Bigr) \biggr) + 1\ \text{\it if}\ j = 2.
     \end{array} \right. \!$ Here we also let
    $g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) = \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_1(t_1) \bigr), m_1 \Bigr)$ and
    $g'^{\Gamma}\bigl(\Delta_2(t_2) \bigr) = \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_2(t_2) \bigr), m_2 \Bigr)$.
    Now, from the above facts that
    $G'^\Gamma\bigl(\Delta_1(t_1) \bigr) \vdash g'^\Gamma\bigl(\Delta_1(
    t_1) \bigr): \mathcal{R}_1$, we have
    $\mathpzc{Dom}\Bigl(G'^\Gamma\bigl(\Delta_1(t_1) \bigr) \Bigr) =
    \mathpzc{sub}\Bigl(g'^\Gamma\bigl(\Delta_1(t_1) \bigr) \Bigr)$,
    from lemma \ref{environment_extension}, which
    $\mathpzc{sub}\Bigl(g'^\Gamma\bigl(\Delta_1(t_1) \bigr) \Bigr)$ of
    r.h.s doesn't include $g'^\Gamma\bigl(\Delta_1(t_1) \bigr) \wedge
    g'^\Gamma\bigl(\Delta_2(t_2) \bigr)$, since size of
    $g'^\Gamma\bigl(\Delta_1(t_1) \bigr) \wedge g'^\Gamma\bigl(
    \Delta_2(t_2) \bigr)$ is properly greater than
    $\mathpzc{sub}\Bigl(g'^\Gamma\bigl(\Delta_1(t_1) \bigr) \Bigr)$. Then
    we found that $g'^\Gamma\bigl(\Delta_1(t_1) \bigr) \wedge
    g'^\Gamma\bigl(\Delta_2(t_2) \bigr) \not\in
    \mathpzc{sub}\Bigl(g'^\Gamma\bigl(\Delta_1(t_1) \bigr) \Bigr) =
    \mathpzc{Dom}\Bigl(G'^\Gamma\bigl(\Delta_1(t_1) \bigr) \Bigr)$.
    同様に$g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \wedge g'^{\Gamma}\bigl(
    \Delta_2(t_2) \bigr) \not\in \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(
    \Delta_2(t_2) \bigr) \Bigr)$ for
    $G'^\Gamma\bigl(\Delta_2(t_2) \bigr) \vdash g'^\Gamma\bigl(
    \Delta_2(t_2) \bigr): \mathcal{R}_2$も成立するので
    $g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \wedge g'^{\Gamma}\bigl(
    \Delta_2(t_2) \bigr) \not\in
    \biggl(\mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_1(t_1) \bigr)
    \Bigr) \cup \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_2(t_2) \bigr)
    \Bigr) \biggr) =
    \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \cup
    G'^{\Gamma}\bigl(\Delta_2(t_2) \bigr) \Bigr)$である by
    corollary \ref{dom_bin_join}. For all of above, we can apply
    (T-Cas-canon) to obtain the judgement
    $\Gamma' \vdash {\Bigl(g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \wedge
    g'^{\Gamma}\bigl(\Delta_2(t_2) \bigr) \Bigr)}^i:
    \mathcal{R}_1 \wedge \mathcal{R}_2$ which
    $\Gamma' = \Biggl\{\biggl({\Bigl(g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr)
    \wedge g'^{\Gamma}\bigl(\Delta_2(t_2) \bigr) \Bigr)}^i,
    \mathcal{R}_1 \wedge \mathcal{R}_1 \biggr) \Biggr\} \cup
    \Bigl(G'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \cup
    G'^{\Gamma}\bigl(\Delta_2(t_2) \bigr) \Bigr)$, where
    $i = \mathpzc{id}\Bigl(g'^\Gamma\bigl(\Delta_2(t_2) \bigr) \Bigr) + 1$
    as term identifier. ここで from def. of $g^{\Gamma}$ and $G^{\Gamma}$,
    $g^{\Gamma}\bigl(\Delta(t) \bigr) =
    g^{\Gamma}\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
    \wedge, (\Delta_1 \cup \Delta_2) \bigr) =
    \mathpzc{carv}\Bigl(g^\Gamma\bigl((\Delta_1 \cup \Delta_2)(t_1) \bigr)
    \wedge g^\Gamma\bigl((\Delta_1 \cup \Delta_2)(t_2) \bigr) \Bigr) =
    {\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl((\Delta_1 \cup \Delta_2)(t_1)
    \bigr), m \Bigr) \wedge \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
    (\Delta_1 \cup \Delta_2)(t_2) \bigr), m' \Bigr) \biggr)}^i =
    \biggl(\mathpzc{carv}\Bigl($
    ${g^{\Gamma}\bigl(\Delta_1(t_1) \bigr), m
    \Bigr) \wedge \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_2(t_2) \bigr),
    m' \Bigr) \biggr)}^i = 
    {\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
    \Delta_1(t_1) \bigr), m_1 \Bigr) \wedge 
    \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_2(t_2) \bigr), m_2
    \Bigr) \biggr)}^i =
    {\Bigl(g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \wedge g'^{\Gamma}\bigl(
    \Delta_2(t_2) \bigr) \Bigr)}^i$, here we let $m_1 = m$,
    $m_2 = m' = \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
    (\Delta_1 \cup \Delta_2)(t_1) \bigr), m \Bigr) \biggr) + 1 =
    \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_1(t_1)
    \bigr), m_1 \Bigr) \biggr) + 1$, and
    $i = \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(g^\Gamma\bigl(
    (\Delta_1 \cup \Delta_2)(t_2) \bigr), m' \Bigr) \biggr) + 1 =
    \mathpzc{id}\biggl(\mathpzc{carv}\Bigl(g^\Gamma\bigl($
    $\Delta_2(t_2) \bigr), m_2 \Bigr) \biggr) + 1 =
    \mathpzc{id}\Bigl(g'^\Gamma\bigl(\Delta_2(t_2) \bigr) \Bigr) + 1$.
    Note that subderivation
    $\Delta_1 \vdash t_1 \triangleright \mathcal{R}_1$より
    $t_1 \in \mathpzc{Dom}(\Delta_1)$, since
    $\Delta_1(t_1) = \bigl\{(t_1, \exists t'_1, \mathcal{R}_1,
    \exists \text{\it fin}_1, \exists \Delta'_1) \bigr\}$ from
    lemma \ref{polymorphic_environment_retrieving}, かつ
    $\mathpzc{Dom}(\Delta_1) \cap \mathpzc{Dom}(\Delta_2)$
    $= \phi$より
    $t_1 \not\in \mathpzc{Dom}(\Delta_2)$, then
    $\bigl(\Delta_1 \cup \Delta_2)(t_1) = \Delta_1(t_1)$.
    $\bigl(\Delta_1 \cup \Delta_2)(t_2) = \Delta_2(t_2)$ is similar.
    一方$G^{\Gamma}\bigl(\Delta(t) \bigr) =
    G^{\Gamma}\bigl(t, t_1 \wedge t_2, \mathcal{R}_1 \wedge \mathcal{R}_2,
    \wedge, (\Delta_1 \cup \Delta_2) \bigr) =
    \biggl\{\Bigl(g^{\Gamma}\bigl(t, t_1 \wedge t_2,
    \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge, (\Delta_1 \cup \Delta_2)
    \bigr), \mathcal{R}_1 \wedge \mathcal{R}_2 \Bigr) \biggr\} \cup \biggl(
    \mathpzc{adj}\Bigl(G^{\Gamma}\bigl((\Delta_1 \cup \Delta_2)(t_1) \bigr),
    g^{\Gamma}\bigl((\Delta_1 \cup \Delta_2)(t_1) \bigr), m \Bigr) \cup
    \mathpzc{adj}\Bigl(G^{\Gamma}\bigl((\Delta_1 \cup \Delta_2)(t_2) \bigr),
    g^{\Gamma}\bigl((\Delta_1 \cup \Delta_2)(t_2) \bigr), m' \Bigr)
    \biggr) =
    \Biggl\{\Biggl({\biggl(\mathpzc{carv}\Bigl(g^\Gamma \bigl(
    \Delta_1(t_1)\bigr), m_1 \Bigr) \wedge \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_2(t_2) \bigr),m_2 \Bigr) \biggr)}^i,
    \mathcal{R}_1 \wedge \mathcal{R}_2 \Biggr) \Biggr\} \cup
    \biggl(\mathpzc{adj}\Bigl($
    $G^{\Gamma}\bigl(\Delta_1(t_1) \bigr),
    g^{\Gamma}\bigl(\Delta_1(t_1) \bigr), m_1 \Bigr) \cup
    \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta_2(t_2)
    \bigr), g^{\Gamma}\bigl(\Delta_2(t_2) \bigr),m_2 \Bigr) \biggr) =
    \Biggl\{\biggl(\Bigl(g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \wedge
    g'^{\Gamma}\bigl($
    ${\Delta_2(t_2) \bigr) \Bigr)}^i,
    \mathcal{R}_1 \wedge \mathcal{R}_2 \biggr) \Biggr\} \cup
    \Bigl(G'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \cup G'^{\Gamma}\bigl(
    \Delta_2(t_2) \bigr) \Bigr) = \Gamma'$. また
    INTUITIONISTIC EQUIVALENCE に関し, まず
    $g^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \equiv \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_1(t_1) \bigr), m_1 \Bigr)$ from lemma
    \ref{equivalence_preservation_on_instantiation} より
    $g^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \simeq \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_1(t_1) \bigr), m_1 \Bigr)$ from (Identity).
    これと$t_1 \simeq g^{\Gamma}\bigl(\Delta_1(t_1) \bigr)$ by I.H. より
    $t_1 \simeq \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_1(t_1) \bigr),$
    $m_1 \Bigr)$を得る, from (Transitivity). 同様に
    $t_2 \simeq \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_2(t_2) \bigr),
    m_2 \Bigr)$も成立. これらより
    $t_1 \wedge t_2 \simeq \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
    \Delta_1(t_1) \bigr), m_1 \Bigr) \wedge \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_2(t_2) \bigr), m_2 \Bigr) =
    g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \wedge g'^{\Gamma}\bigl(
    \Delta_2(t_2) \bigr)$を得る,
    from (Transparency-Cas). ここで we attach appripriate term identifiers
    to both l.h.s and r.h.s. まず we have
    ${\Bigl(g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \wedge g'^{\Gamma}\bigl(
    \Delta_2(t_2) \bigr) \Bigr)}^i \simeq t_1 \wedge t_2$ which
    $i = \mathpzc{id}\Bigl(g'^\Gamma\bigl(\Delta_2(t_2) \bigr) \Bigr) + 1$,
    by (Instantiation) and (Symmetry), then we eventually get
    $t = {(t_1 \wedge t_2)}^j \simeq
    {\Bigl(g'^{\Gamma}\bigl(\Delta_1(t_1) \bigr) \wedge g'^{\Gamma}\bigl(
    \Delta_2(t_2) \bigr) \Bigr)}^i = g^\Gamma\bigl(\Delta(t) \bigr)$ which
    $j = \mathpzc{id}(t)$, by applying (Instantiation) and (Symmetry)
    again. 
    
    Case (T-Par-xtend): Same as the case of (T-Cas-xtend).
    
    Case (T-Cat0-xtend-nil): The judgement reveals as
    $\Bigl\{\bigl(t, \{\}, {\mathcal{R}_1}^*, \text{\it nil}, \phi \bigr)
    \Bigr\} \vdash t \triangleright {\mathcal{R}_1}^*$ s.t.
    $t \simeq \{\}$ from (T-Cat0-xtend-nil). ここで from def. of
    $G^{\Gamma}$ and $g^{\Gamma}$, we obtain
    $G^{\Gamma}\bigl(\Delta(t) \bigr) =
    G^{\Gamma}\bigl(t, \{\}, {\mathcal{R}_1}^*, \text{\it nil},$
    $\phi \bigr) =
    \biggl\{\Bigl(g^{\Gamma}\bigl(t, \{\}, {\mathcal{R}_1}^*,
    \text{\it nil}, \phi \bigr), {\mathcal{R}_1}^* \Bigr) \biggr\} =
    \biggl\{\Bigl(g^\Gamma\bigl(\Delta(t) \bigr), {\mathcal{R}_1}^*
    \Bigr) \biggr\}$, where
    $g^{\Gamma}\bigl(\Delta(t) \bigr) =
    g^{\Gamma}\bigl(t, \{\}, {\mathcal{R}_1}^*, \text{\it nil},$
    $\phi \bigr) = \{\}$より
    $g^{\Gamma}\bigl(\Delta(t) \bigr) \equiv \{\}$, from lemma
    \ref{nil_equivalence}. Then
    $\biggl\{\Bigl(g^\Gamma\bigl(\Delta(t) \bigr), {\mathcal{R}_1}^*
    \Bigr) \biggr\} \vdash g^{\Gamma}\bigl(\Delta(t) \bigr):
    {\mathcal{R}_1}^*$ from (T-Cat0-canon-nil). また
    $g^\Gamma\bigl(\Delta(t) \bigr) = \{\}$ s.t. $t \simeq \{\}$より
    $g^\Gamma\bigl(\Delta(t) \bigr) \equiv \{\}$ from lemma
    \ref{identity_on_structual_equivalence}, then
    $g^\Gamma\bigl(\Delta(t) \bigr) \simeq \{\}$ s.t. $t \simeq \{\}$
    by (Identity). よって we finally obtain
    $t \simeq g^\Gamma\bigl(\Delta(t) \bigr)$ by (Transitivity) and
    twice (Symmetry)s.
    
    Case (T-Cat0-xtend-sol): For this case, the judgement
    $\Delta \vdash t \triangleright {\mathcal{R}_1}^*$ has
    $\Delta = \bigl\{(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta')
    \bigr\}$
    $\cup \Delta'$ s.t. $t \simeq t'$, and
    $\Delta' \vdash t' \triangleright \mathcal{R}_1$ as subderivation.
    ここで for its subderivation
    $\Delta' \vdash t' \triangleright \mathcal{R}_1$,
    $G^{\Gamma}\bigl(\Delta'(t') \bigr) \vdash g^{\Gamma}\bigl(\Delta'(t')
    \bigr): \mathcal{R}_1$成立, which satisfies
    $t' \simeq g^{\Gamma}\bigl(\Delta'(t') \bigr)$ by I.H. Moreover, we can
    derive $G'^{\Gamma}\bigl(\Delta'(t') \bigr) \vdash
    g'^{\Gamma}\bigl(\Delta'(t') \bigr): \mathcal{R}_1$, where
    we let $G'^{\Gamma}\bigl(\Delta'(t') \bigr) =
    \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t') \bigr),
    g^{\Gamma}\bigl(\Gamma'(t') \bigr), m \Bigr)$ and
    $g'^{\Gamma}\bigl(\Delta'(t') \bigr) = \mathpzc{carv}\Bigl(g^{\Gamma}
    \bigr(\Delta'(t') \bigr), m \Bigr)$ using lemma \ref{domain_flush}.
    ここで we found that $\mathpzc{Dom}\Bigl(G'^\Gamma\bigl(\Delta'(t')$
    $\bigr) \Bigr) = \mathpzc{sub}\Bigl(g'^\Gamma\bigl(\Delta'(t') \bigr)
    \Bigr)$ from lemma \ref{environment_extension}, which
    $\mathpzc{sub}\Bigl(g'^\Gamma\bigl(\Delta'(t') \bigr) \Bigr)$ doesn't
    have $\Bigl\{g'^\Gamma\bigl(\Delta'(t') \bigr) \Bigr\}$ since
    size of $\Bigl\{g'^\Gamma\bigl(\Delta'(t') \bigr) \Bigr\}$ is greater
    than $g'^\Gamma\bigl(\Delta'(t') \bigr)$. Then we have
    $\Bigl\{g'^\Gamma\bigl(\Delta'(t') \bigr) \Bigr\} \not\in
    \mathpzc{Dom}\Bigl(G'^\Gamma\bigl($
    $\Delta'(t') \bigr) \Bigr)$.
    故に we can apply (T-Cat0-canon-$\infty$) on
    $G'^{\Gamma}\bigl(\Delta'(t') \bigr) \vdash g'^{\Gamma}\bigl(
    \Delta'(t') \bigr): \mathcal{R}_1$ and
    $\Bigl\{g'^{\Gamma}\bigl(\Delta'(t')$
    $\bigr) \Bigr\} \not\in \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta'(t')
    \bigr) \Bigr)$
    from the above facts, to obtain new judgement
    $\Gamma' \vdash {\Bigl\{g'^{\Gamma}\bigl(\Delta'(t') \bigr) \Bigr\}}^i:
    {\mathcal{R}_1}^*$ which
    $\Gamma' = \Biggl\{\biggl({\Bigl\{g'^{\Gamma}\bigl(\Delta'(t') \bigr)
    \Bigr\}}^i, {\mathcal{R}_1}^* \biggr) \Biggr\} \cup
    G'^{\Gamma}\bigl(\Delta'(t') \bigr)$ where
    $i = \mathpzc{id}\Bigl(g'^\Gamma\bigl(\Delta'(t') \bigr) \Bigr) + 1$
    as term identifier. また from def. of $g^{\Gamma}$ and $G^{\Gamma}$,
    $g^{\Gamma}\bigl(\Delta(t) \bigr) =
    g^{\Gamma}(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta') =
    {\biggl\{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta'(t') \bigr), m
    \Bigr) \biggr\}}^i =
    {\Bigl\{g'^{\Gamma}\bigl(\Delta'(t') \bigr) \Bigr\}}^i$ where
    $i = \mathpzc{id}\Bigl(g'^{\Gamma}\bigl(\Delta'(t') \bigr) \Bigr) + 1$
    and $G^{\Gamma}\bigl(\Delta(t) \bigr) =
    G^{\Gamma}(t, t', {\mathcal{R}_1}^*, \text{\it sol}, \Delta' ) =
    \Bigl\{\bigl(g^{\Gamma}(t, t',$
    ${\mathcal{R}_1}^*, \text{\it sol}, \Delta' ), {\mathcal{R}_1}^* \bigr)
    \Bigr\} \cup \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t') \bigr),
    g^{\Gamma}\bigl(\Delta'(t') \bigr), m \Bigr) =
    \Biggl\{\biggl(\Bigl\{g'^{\Gamma}\bigl(\Delta'(t') \bigr)
    \Bigr\}, {\mathcal{R}_1}^* \biggr) \Biggr\} \cup G'^{\Gamma}\bigl(
    \Delta'(t') \bigr) = \Gamma'$ since
    $G'^{\Gamma}\bigl(\Delta'(t') \bigr) =
    \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta'(t') \bigr),
    g^{\Gamma}\bigl(\Delta'(t') \bigr), m \Bigr)$ in the beginning of
    proof. 一方 for INTUITIONISTIC EQUIVALENCE, recall that
    $t' \simeq g^\Gamma\bigl(\Delta'(t') \bigr)$より
    $t' \simeq \Bigl\{g^\Gamma\bigl(\Delta'(t') \bigr) \Bigr\}$ by
    (Associativity-$\text{\it Cat0}_1$). And we attach term identifier
    to $\Bigl\{g^\Gamma\bigl(\Delta'(t') \bigr) \Bigr\}$ of r.h.s, then
    $t' \simeq {\Bigl\{g^\Gamma\bigl(\Delta'(t') \bigr) \Bigr\}}^i$ by
    (Instantiation). よって $t \simeq t'$より we obtain
    $t \simeq {\Bigl\{g^\Gamma\bigl(\Delta'(t') \bigr) \Bigr\}}^i$ by
    (Transitivity).
    
    Case (T-Cat0-xtend-$\infty$):
    This case's judgement $\Delta \vdash t \triangleright
    {\mathcal{R}_1}^*$ has
    $\Delta = \Bigl\{\bigl(t, t_h \wedge t_t, {\mathcal{R}_1}^*, \infty,
    (\Delta_h \cup \Delta_t) \bigl) \Bigr\} \cup (\Delta_h \cup \Delta_t)$
    s.t. $t \simeq t_h \wedge t_t, \mathpzc{Dom}(\Delta_h) \cap
    \mathpzc{Dom}(\Delta_t) = \phi$, and
    $\Delta_h \vdash t_h \triangleright \mathcal{R}_1$ \&
    $\Delta_t \vdash t_t \triangleright {\mathcal{R}_1}^*$ as
    subderivations 成立. かつ For its subderivations
    $\Delta_h \vdash t_h \triangleright \mathcal{R}_1$ および
    $\Delta_t \vdash t_t \triangleright {\mathcal{R}_1}^*$ より
    $G^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \vdash g^{\Gamma}\bigl(
    \Delta_h(t_h) \bigr): \mathcal{R}_1$ s.t.
    $t_h \simeq g^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$, and
    $G^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \vdash g^{\Gamma}\bigl(
    \Delta_t(t_t) \bigr): {\mathcal{R}_1}^*$ s.t.
    $t_t \simeq g^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$成立 respectively,
    both are by I.H. ここで we can make
    $G^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ and
    $G^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ disjoint using lemma
    \ref{domain_separator}, as
    $G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \vdash
    g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr): \mathcal{R}_1$ and
    $G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \vdash
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr): {\mathcal{R}_1}^*$成立 with
    $\mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr) \cap
    \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \Bigr) = \phi$,
    here we let $G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) =
    \mathpzc{adj}\Bigl(G^{\Gamma}(\Delta_h($
    $t_h) \bigr), g^{\Gamma}\bigl(\Delta_h(t_h) \bigr), m_1 \Bigr)$,
    $G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) =
    \mathpzc{adj}\Bigl(G^{\Gamma}(\Delta_t(t_t) \bigr), g^{\Gamma}\bigl(
    \Delta_t(t_t) \bigr), m_2 \Bigr)$ and
    $g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) =
    \mathpzc{carv}\Bigl($
    $g^{\Gamma}\bigl(\Delta_h(t_h) \bigr),m_1 \Bigr)$,
    $g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) =
    \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_t(t_t) \bigr), m_2 \Bigr)$
    where \\ $m_j = \left\{ \!\! \begin{array}[c]{l}
       m\ \text{\it if}\;\; j = 1  \\
       \text{\it id}\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_h(t_h)
       \bigr), m_1 \Bigr) \biggr) + 1\ \text{\it if}\ j = 2.
    \end{array} \right. \!$
    また$G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \vdash
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr): {\mathcal{R}_1}^*$において
    from syntax directness on typematching with ${\mathcal{R}_1}^*$,
    we can assume that its finalizer is (T-Cat0-canon-nil) or
    (T-Cat0-canon-$\infty$).
    subcase (T-Cat0-canon-nil):
    Now we suppose the former case which finalizer is (T-Cat0-canon-nil),
    then $g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \equiv \{\}$ from
    (T-Cat0-canon-nil) より
    $g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) = {\{\}}^j$ for some $j$ as
    term identifier 成立, by lemma \ref{nil_equivalence}. 一方
    $G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \vdash g'^{\Gamma}\bigl(
    \Delta_h(t_h) \bigr): \mathcal{R}_1$より we have
    $\mathpzc{Dom}\Bigl(G'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr) =
    \mathpzc{sub}\Bigl(g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr)$ from
    lemma \ref{environment_extension}, ここで we found that
    $\Bigl\{g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr\} \not\in
    \mathpzc{sub}\Bigl(g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr)$ since
    size of $\Bigl\{g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr\}$ is
    properly greater than $g'^\Gamma\bigl(\Delta_h(t_h) \bigr)$, then
    we got $\Bigl\{g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr\} \not\in
    \mathpzc{Dom}\Bigl(G'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr)$. 故に
    we obtain that
    $\Gamma' \vdash {\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr\}}^i:
    {\mathcal{R}_1}^*$ which $\Gamma' =
    \Biggl\{\biggl({\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr\}}^i,
    {\mathcal{R}_1}^* \biggr) \Biggr\} \cup G'^{\Gamma}\bigl(\Delta_h(t_h)
    \bigr)$ which $i = \mathpzc{id}\Bigl(g'^\Gamma\bigl(\Delta_h(t_h) \bigr)
    \Bigr) + 1$ by applying (T-Cat0-canon-$\infty$), since
    $G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \vdash g'^{\Gamma}\bigl(\Delta_h
    (t_h) \bigr): \mathcal{R}_1$ as above. また
    $\Delta_h \vdash t_h \triangleright \mathcal{R}_1$より
    $t_h \in \mathpzc{Dom}(\Delta_h)$ since
    $\Delta_h(t_h) = \bigl\{(t_h, t'_h, \mathcal{R}_1, \text{\it fin}_h,
    \Delta'_h) \bigr\}$
    from lemma \ref{polymorphic_environment_retrieving}, かつ
    $\mathpzc{Dom}(\Delta_h) \cap \mathpzc{Dom}(\Delta_t) = \phi$より
    $t_h \not\in \mathpzc{Dom}(\Delta_t)$. 同様に
    $\Delta_t \vdash t_t \triangleright {\mathcal{R}_1}^*$より
    $t_t \in \mathpzc{Dom}(\Delta_t)$ and
    $t_t \not\in \mathpzc{Dom}(\Delta_h)$. よって
    $(\Delta_h \cup \Delta_t)(t_h) = \Delta_h(t_h) =
    \bigl\{(t_h, t'_h, \mathcal{R}_1, \text{\it fin}_h, \Delta'_h )
    \bigr\}$および
    $(\Delta_h \cup \Delta_t)(t_t) = \Delta_t(t_t) =
    \bigl\{(t_t, t'_t, {\mathcal{R}_1}^*, \text{\it fin}_t, \Delta'_t )
    \bigr\}$. Then from these facts, we can derive that
    $\mathpzc{carv}\Bigl(g^{\Gamma}\bigl((\Delta_h \cup \Delta_t)(t_t)
    \bigr), m_2 \Bigr) =
    \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_t(t_t) \bigr), m_2 \Bigr) =
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) = {{\{\}}}^j$ for some j,
    as above より
    $g^{\Gamma}\bigl(\Delta(t) \bigr) =
    g^{\Gamma}\bigl(t, t_h \wedge t_t, {\mathcal{R}_1}^*, \infty,
    (\Delta_h \cup \Delta_t) \bigr) =
    {\biggl\{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl((\Delta_h \cup\Delta_t)(t_h)
    \bigr) , m \Bigr) \biggr\}}^i =
    {\biggl\{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_h(t_h) \bigr) , m_1
    \Bigr) \biggr\}}^i =
    {\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr\}}^i$ where
    $i = \mathpzc{id}\Bigl(g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr) + 1$.
    および we also can derive that $\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
    (\Delta_h \cup \Delta_t)(t_t) \bigr), m_2 \Bigr) =
    \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_t(t_t) \bigr), m_2 \Bigr) =
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) = {\{\}}^j$より
    $G^{\Gamma}\bigl(\Delta(t) \bigr) =
    \biggl\{\Bigl(g^{\Gamma}\bigl(t, t_h \wedge t_t, {\mathcal{R}_1}^*,
    \infty, (\Delta_h \cup \Delta_t) \bigr), {\mathcal{R}_1}^* \Bigr)
    \biggr\} \cup \mathpzc{adj}\Bigl(G^{\Gamma}\bigl((\Delta_h \cup
    \Delta_t)(t_h) \bigr), g^{\Gamma}\bigl((\Delta_h \cup \Delta_t)(t_h)
    \bigr), m \Bigr) =
    \Biggl\{\biggl({\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr\}}^i,
    {\mathcal{R}_1}^* \biggr) \Biggr\} \cup \mathpzc{adj}\Bigl(
    G^{\Gamma}\bigl(\Delta_h(t_h) \bigr),
    g^{\Gamma}\bigl(\Delta_h(t_h) \bigr), m_1 \Bigr) =
    \Biggl\{\biggl(\Bigl\{g'^{\Gamma}\bigl(\Delta_h($
    ${t_h) \bigr) \Bigr\}}^i, {\mathcal{R}_1}^* \biggr) \Biggr\} \cup
    G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) = \Gamma'$.
    一方 INTUITIONISTIC EQUIVALENCE に関し, 先ず
    $t_t \simeq g^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ given in beginning
    of proof, および
    $g^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \equiv \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_t(t_t) \bigr), m_2 \Bigr) =
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ from lemma
    \ref{equivalence_preservation_on_instantiation}, then
    $g^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \simeq
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ by (Identity) より
    $t_t \simeq g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ by (Transitivity).
    かつ$g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \equiv \{\}$ from
    lemma \ref{nil_equivalence}, for
    $g'^\Gamma\bigl(\Delta_t(t_t) \bigr) = \{\}^j$ as above より
    $g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \simeq \{\}$成立 by (Identity).
    よって we found that $t_t \simeq \{\}$ by (Transitivity). 同様に
    $t_h \simeq g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ by (Transitivity) for
    $t_h \simeq g^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ in the beginning
    of proof, and $g^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \simeq g'^{\Gamma}
    \bigl(\Delta_h(t_h) \bigr)$ by (Identity), since
    $g^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \equiv \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_h(t_h) \bigr), m_1 \Bigr) =
    g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ from lemma
    \ref{equivalence_preservation_on_instantiation}. Therefore,
    we obtain $t_h \wedge t_t \simeq g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)
    \wedge \{\}$ by applying (Transparency-Cas) on
    $t_h \simeq g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ and
    $t_t \simeq \{\}$. Then
    ${(t_h \wedge t_t)}^j \simeq \Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h)
    \bigr) \Bigr\}$成立, since we have
    $g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \simeq t_h \wedge t_t$
    by (RevealT-Cas) with (Symmetry), and attaching appropriate term
    identifier $j = \mathpzc{id}(t_h \wedge t_t)$ to r.h.s, by
    (Instantiation), then ${(t_h \wedge t_t)}^j \simeq
    \Bigl\{g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr\}$ which
    $j = \mathpzc{id}(t_1 \wedge t_2)$, by
    ($\text{\it Associativity-Cat0}_1$) with (Symmetry). Then
    we eventually have ${(t_h \wedge t_t)}^j \simeq
    {\Bigl\{g'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr\}}^i$ which
    $i = \mathpzc{id}\Bigl(g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)
    \Bigr) + 1$, by (Instantiation). Hence we finally got that
    $t \simeq {\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr\}}^i$
    for $t \simeq {(t_h \wedge t_t)}^j$ in begining of proof
    by (Transitivity).
    subcase (T-Cat0-canon-$\infty$):
    we assume the case of that finalizer is (T-Cat0-canon-$\infty$),
    for this case, the judgement is
    $G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \vdash g'^{\Gamma}\bigl(
    \Delta_t(t_t) \bigr): {\mathcal{R}_1}^*$, then we can predicate that
    the form of $g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ is
    $g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) = \{t_1 \cdots t_n \}$
    from syntax directness. また
    $G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) =
    \biggl\{\Bigl(g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr), {\mathcal{R}_1}^*
    \Bigr) \biggr\} \cup \bigcup_{j=1}^{n}\Gamma'_j =
    \Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^* \bigr) \Bigr\} \cup
    \bigcup_{j=1}^{n}\Gamma'_j$ および
    $\Gamma'_j \vdash t_j: \mathcal{R}_1$ as subderivations s.t.
    $\mathpzc{Dom}(\Gamma'_j) \cap \mathpzc{Dom}(\Gamma'_k) = \phi$
    if $j \neq k$ where $1 \le j \le n$, $1 \le k \le n$, and
    $g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) = \{t_1 \cdots t_n\} \not\in
    \bigcup_{j=1}^{n}\mathpzc{Dom}(\Gamma'_j)$成立
    from def. of (T-Cat0-xtend-$\infty$). ここで
    $\mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr) \cap
    \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \Bigr) = \phi$
    as above より
    $\mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr) \cap
    \mathpzc{Dom}\biggl(\Bigl\{\bigl(\{t_1 \cdots t_n \}, {\mathcal{R}_1}^*
    \bigr) \Bigr\} \cup \bigcup_{j=1}^{n}\Gamma'_j \biggr) =
    \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr) \cap
    \Bigl(\{t_1 \cdots t_n \} \cup \mathpzc{Dom}\bigl(
    \bigcup_{j=1}^{n}\Gamma'_j \bigr) \Bigr) =
    \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr) \cap
    \Bigl(\{t_1 \cdots t_n \} \cup \bigl(\bigcup_{j=1}^{n}\mathpzc{Dom}(
    \Gamma'_j) \bigr) \Bigr) = \phi$成立 using corollary \ref{dom_mul_join},
    then $\mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr)
    \cap \mathpzc{Dom}(\Gamma'_j) = \phi$ where $1 \le j \le n$を得る
    since $\mathpzc{Dom}(\Gamma'_j) \subseteq
    \bigcup_{j=1}^{n}\mathpzc{Dom}(\Gamma'_j) \subseteq \Bigl(
    \{t_1 \cdots t_n \} \cup \bigl(\bigcup_{j=1}^{n}\mathpzc{Dom}(\Gamma'_j)
    \bigr) \Bigr)$. かつ
    $\mathpzc{Dom}(\Gamma'_j) \cap \mathpzc{Dom}(\Gamma'_k) = \phi$
    if $j \neq k$ where $1 \le j \le n$, $1 \le k \le n$ as above より
    $\mathpzc{Dom}(\Gamma'_j) \cap \mathpzc{Dom}(\Gamma'_k) = \phi$ 
    if $j \neq k$ where $0 \le j \le n$, $0 \le k \le n$を得る note that
    here we let $\Gamma'_0 = G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$.
    一方 $G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \vdash g'^{\Gamma}\bigl(
    \Delta_t(t_t) \bigr): {\mathcal{R}_1}^*$ in the beginning of this case
    of proof より
    $\mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \Bigr) =
    \mathpzc{sub}\Bigl(g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \Bigr)$ from
    lemma \ref{environment_extension} であり
    $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n \Bigr\}
    \not\in \mathpzc{sub}\bigl(\{t_1 \cdots t_n \} \bigr) =
    \mathpzc{sub}\Bigl(g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \Bigr) =
    \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \Bigr)$を得る
    since size of
    $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n \Bigr\}$
    is properly greater than $\{t_1 \cdots t_n \}$. 同様にして
    $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr),$
    $t_1 \cdots t_n \Bigr\} \not\in \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(
    \Delta_h(t_h) \bigr) \Bigr)$ を得る with lemma
    \ref{environment_extension}, for
    $G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \vdash g'^{\Gamma}\bigl(
    \Delta_h(t_h) \bigr): \mathcal{R}_1$ as above. よって
    $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n \Bigr\}
    \not\in \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \Bigr)$
    より $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n
    \Bigr\} \not\in \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr)
    \Bigr) =
    \mathpzc{Dom}\Biggl(\biggl\{\Bigl(g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr),
    {\mathcal{R}_1}^* \Bigr) \biggr\} \cup \bigcup_{j=1}^{n} \Gamma'_j
    \Biggr) =
    \mathpzc{Dom}\Biggl( \biggl\{\Bigl(g'^{\Gamma}\bigl(\Delta_t(t_t)
    \bigr), {\mathcal{R}_1}^* \Bigr) \biggr\} \Biggr) \cup
    \mathpzc{Dom}\bigl(\bigcup_{j=1}^{n}\Gamma'_j \bigr) =
    \Bigl\{g'^\Gamma\bigl(\Delta_t(t_t) \bigr) \Bigr\} \cup
    \bigcup_{j=1}^{n}\mathpzc{Dom}(\Gamma'_j)$ using corollary
    \ref{dom_bin_join} and \ref{dom_mul_join}, then
    $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr),$
    $t_1 \cdots t_n \Bigr\} \not\in \bigcup_{j=1}^{n}\mathpzc{Dom}(
    \Gamma'_j)$が成立する. かつ
    $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n \Bigr\}
    \not\in \mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \Bigr)$
    成立故
    $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n \Bigr\}
    \not\in \biggl(\mathpzc{Dom}\Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h)
    \bigr)\Bigr) \cup \bigcup_{j=1}^{n}\mathpzc{Dom}(\Gamma'_j ) \biggr) =
    \biggl(\mathpzc{Dom}\Bigl(G'^\Gamma\bigl(\Delta_h(t_h) \bigr) \Bigr)
    \cup \mathpzc{Dom}\bigl(\bigcup_{j=1}^n\Gamma'_j \bigr) \biggr) =
    \mathpzc{Dom}\Bigl(G'^\Gamma\bigl(\Delta_h(t_h) \bigr) \cup
    \bigcup_{j=1}^n\Gamma'_j \Bigr)$を得る.    
    Eventually, For all of above facts as
    $G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \vdash g'^{\Gamma}\bigl(
    \Delta_h(t_h) \bigr): \mathcal{R}_1$,
    $\Gamma'_j \vdash t_j: \mathcal{R}_1$ where $1 \le j \le n$ and
    $\mathpzc{Dom}(\Gamma'_l) \cap \mathpzc{Dom}(\Gamma'_m) = \phi$
    if $l \neq m$ where $\Gamma'_0 = G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$,
    $0 \le l \le n$, $0 \le m \le n$,
    $\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n \Bigr\}
    \not\in \mathpzc{Dom}\Bigl(G'^\Gamma\bigl(\Delta_h(t_h) \bigr) \cup
    \bigcup_{j=1}^n\Gamma'_j \Bigr)$, then we obtain that
    $\Biggl\{\biggl(\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr),
    t_1 \cdots t_n \Bigr\}, {\mathcal{R}_1}^* \biggr) \Biggr\} \cup
    \Bigl(G'^{\Gamma}\bigl(\Delta_h($
    $t_h) \bigr) \cup \bigcup_{j=1}^{n}\Gamma'_j \Bigr) \vdash
    \Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n \Bigr\}:
    {\mathcal{R}_1}^*$, from (T-Cat0-canon-$\infty$). ここで
    $\mathpzc{carv}\Bigl(g^{\Gamma}\bigl((\Delta_h \cup \Delta_t)(t_t)
    \bigr), m_2 \Bigr) =
    \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_t(t_t) \bigr), m_2 \Bigr) =
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ $= \{t_1 \cdots t_n \}$
    in the beginning of this case of proof より
    $g^{\Gamma}\bigl(\Delta(t) \bigr) =
    g^{\Gamma}\bigl(t, t_h \wedge t_t, {\mathcal{R}_1}^*, \infty,
    (\Delta_h \cup \Delta_t) \bigr) =
    \biggl\{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(
    (\Delta_h \cup \Delta_t)(t_h)\bigr), m \Bigr), t_1 \cdots t_n \biggr\} =
    \biggl\{\mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_h(t_h)\bigr), m_1
    \Bigr), t_1 \cdots t_n \biggr\} =
    {\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n
    \Bigr\}}^i$ where
    $i' = \mathpzc{id}\bigl(\{t_1 \cdots t_n\} \bigr) =
    \mathpzc{id}\Bigl(g'^\Gamma\bigl($
    $\Delta_t(t_t) \bigr) \Bigr)$. および
    $G^{\Gamma}\bigl(\Delta(t) \bigr) =
    G^{\Gamma}\bigl(t, t_h \wedge t_t, {\mathcal{R}_1}^*, \infty,
    (\Delta_h \cup \Delta_t) \bigr) =
    \biggl\{\Bigl(g^{\Gamma}\bigl(t, t_h \wedge t_t, {\mathcal{R}_1}^*,
    \infty, (\Delta_h \cup \Delta_t) \bigr), {\mathcal{R}_1}^* \Bigr)
    \biggr\} \cup
    \biggl(\mathpzc{adj}\Bigl(G^{\Gamma}\bigl((\Delta_h \cup \Delta_t)(t_h)
    \bigr), g^{\Gamma}\bigl((\Delta_h \cup \Delta_t)(t_h) \bigr), m \Bigr)
    \cup \Gamma' \biggr) =
    \Biggl\{\biggl(\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr),
    t_1 \cdots t_n \Bigr\},$
    ${\mathcal{R}_1}^* \biggr) \Biggr\} \cup
    \biggl(\mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta_h(t_h) \bigr),
    g^{\Gamma}\bigl(\Delta_h(t_h) \bigr), m_1 \Bigr) \cup \Gamma' \biggr) =
    \Biggl\{\biggl(\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr),
    t_1 \cdots t_n \Bigr\}, {\mathcal{R}_1}^* \biggr) \Biggr\} \cup
    \Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \cup \Gamma' \Bigr) =
    \Biggl\{\biggl(\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr),
    t_1 \cdots t_n \Bigr\}, {\mathcal{R}_1}^* \biggr) \Biggr\} \cup
    \Bigl(G'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \cup
    \bigcup_{j=1}^{n}\Gamma'_j \Bigr)$, since
    $\Gamma' = \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(
    (\Delta_h \cup \Delta_t)(t_t)\bigr), g^{\Gamma}\bigl(
    (\Delta_h \cup \Delta_t)(t_t) \bigr), m_2 \Bigr) \setminus
    \Biggl\{\biggl(\mathpzc{carv}\Bigl(g^{\Gamma}\bigl((\Delta_h \cup
    \Delta_t)(t_t) \bigr), m_2 \Bigr), {\mathcal{R}_1}^* \biggr) \Biggr\} =
    \mathpzc{adj}\Bigl(G^{\Gamma}\bigl(\Delta_t(t_t) \bigr),
    g^{\Gamma}\bigl(\Delta_t(t_t) \bigr), m_2 \Bigr) \setminus \Biggl\{\biggl(
    \mathpzc{carv}\Bigl(g^{\Gamma}\bigl(\Delta_t(t_t) \bigr), m_2 \Bigr),
    {\mathcal{R}_1}^* \biggr) \Biggr\} =
    G'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \setminus
    \biggl\{\Bigl(g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr),$
    ${\mathcal{R}_1}^* \Bigr) \biggr\} =
    \Biggl(\biggl\{\Bigl(g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr),
    {\mathcal{R}_1}^* \Bigr) \biggr\} \cup \bigcup_{j=1}^{n}\Gamma'_j
    \Biggr) \setminus
    \biggl\{\Bigl(g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr), {\mathcal{R}_1}^*
    \Bigr) \biggr\} = \bigcup_{j=1}^{n}\Gamma'_j$.
    一方 INTUITIONISTIC EQUIVALENCE に関して,
    先ず$g^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \equiv \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_h(t_h) \bigr), m_1 \Bigr) =
    g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ by lemma
    \ref{equivalence_preservation_on_instantiation} より
    $g^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \simeq
    g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ by (Identity), および
    $t_h \simeq g^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ in beginning of proof
    より$t_h \simeq g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ by (Transitivity).
    同様にして$t_t \simeq \{t_1 \cdots t_n \}$を得る since
    $g^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \simeq
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ for
    $g^{\Gamma}\bigl(\Delta_t(t_t) \bigr) \equiv \mathpzc{carv}\Bigl(
    g^{\Gamma}\bigl(\Delta_t(t_t) \bigr), m_2 \Bigr) =
    g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$, かつ
    $g'^{\Gamma}\bigl(\Delta_t(t_t) \bigr) = \{t_1 \cdots t_n \}$ in
    beginning of this case of proof より$t_t \simeq \{t_1 \cdots t_n \}$
    for $t_t \simeq g^{\Gamma}\bigl(\Delta_t(t_t) \bigr)$ by (Transitivity). 
    よって $t_h \simeq g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr)$ and
    $t_t \simeq \{t_1 \cdots t_n \}$より
    $g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \wedge \{t_1 \cdots t_n \}
    \simeq t_h \wedge t_t$ by (Transparency-Cat) \& (Symmetry), then
    we give $t_h \wedge t_t$ of r.h.s, appropriate term identifier
    using (Instantiation) ,as
    $g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \wedge \{t_1 \cdots t_n \}
    \simeq {(t_h \wedge t_t)}^k$ which $k = \mathpzc{id}(t_h \wedge t_t)$.
    And by (Symmetry) again, ${(t_h \wedge t_t)}^k \simeq
    g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \wedge \{t_1 \cdots t_n \}$を得る.
    および$t \simeq t_h \wedge t_t$ in beginning of proof より
    $t \simeq g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr) \wedge
    \{t_1 \cdots t_n \}$成立 by (Transitivity), then
    $t \simeq \Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n
    \Bigr\}$ by ($\text{\it AssociativityH-Cat0}_\infty$). よって
    we finally obtain that
    $t \simeq {\Bigl\{g'^{\Gamma}\bigl(\Delta_h(t_h) \bigr), t_1 \cdots t_n
    \Bigr\}}^i$, which $i$ is appropriate term identifier attached using
    (Instantiation).
    
    Case (T-Cat1-xtend-sol): Similar to the case of (T-Cat0-xtend-sol).

    Case (T-Cat1-xtend-$\infty$): Similar to the case of
    (T-Cat0-xtend-$\infty$).

    Case (T-Dup-xtend-sol): Similar to the case of (T-Cat1-xtend-sol).

    Case (T-Dup-xtend-$\infty$): Similar to the case of
    (T-Cat1-xtend-$\infty$).

    Case (T-Opt-xtend-nil): Similar to the case of (T-Cat0-xtend-nil).
    
    Case (T-Opt-xtend-sol): Similar to the case of (T-Cat0-xtend-sol).

    Case (T-Alt-xtend-L): Similar to the case of (T-Opt-xtend-sol).

    Case (T-Alt-xtend-R): Similar to the case of (T-Alt-xtend-L).
    $\Box$
  \end{Proof}
  
\end{Lemma}


\pagebreak
\begin{Definition}{項の内部表現(INTERNAL FORM OF TERMS)}
\label{term_internal_form} 
  項$\,t$の内部形式(INTERNAL FORM OF TERMS) $T \in \mathscr{T}$を,
  以下のように定義する.
  \begin{displaymath}
    \begin{array}{lrl}
      T & \stackrel{\mathrm{def}}{:=}
      & t_0\ \text{\it where}\ (t_0, \mathcal{R}_0) \!\in\! \Gamma_{gnd} \\
      &  | & t_1\ \text{\it where}\ (t_1, \mathcal{R}_1) \!\in\!
                   \Gamma_{def}  \\
      &  | & T \wedge \bot \;\; |\;\; \bot \wedge T  \\
      &  | & \bot \vee T  \\
      &  | & T_1 \wedge T_2  \\
      &  | & T_1 \vee T_2  \\
      &  | & \circ  \\
      &  | & {T_1}^?  \\
      &  | & {T_1}^{\leftarrow} \;\; |\;\; {T_1}^{\rightarrow}  \\
      &  | & \epsilon
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Definition} \label{size_of_internal_terms}
  項$T$のサイズ(SIZE)を, 以下のように定義する.
  \begin{displaymath}
    \begin{array}{l}
      
      \mathpzc{Size}_T(T) \,\stackrel{\mathrm{def}}{:=}\,
       \left\{ \begin{array}{ll}
         1
         & T \equiv \mathcal{C}_{const},\, \mathcal{C}_{ident},\,
            \epsilon.  \\
         
         \mathpzc{Size}_T(T_1) + \mathpzc{Size}_T(T_2) + 1
         & T \equiv T_1 \!\wedge\! T_2,\, T_1 \!\vee\! T_2.
       \end{array} \right.  \\
      \\
      
      \mathpzc{Size}_\mathcal{R}(\mathcal{R})
       \,\stackrel{\mathrm{def}}{:=}\, \left\{ \begin{array}{ll}
         1
         & \mathcal{R} \equiv \mathcal{R}_0,\ \text{\it s.t.}\;
            \exists T @_j \mathcal{R}_0 \!\in\! \Gamma  \\
         
         \mathpzc{Size}_\mathcal{R}(\mathcal{R}_1) +
          \mathpzc{Size}_\mathcal{R}(\mathcal{R}_2) + 1
         & \mathcal{R} \!\equiv\! \,\mathcal{R}_1 \!\wedge\!
            \mathcal{R}_2,\, \mathcal{R}_1 \!\vee\! \mathcal{R}_2.  \\
         
         \mathpzc{Size}_\mathcal{R}(\mathcal{R}_1) + 1
         & \mathcal{R} \!\equiv\! \mathcal{R}_0^*,\,
            \mathcal{R} \!\equiv\! \mathcal{R}_0^+,\,
             \mathcal{R} \!\equiv\! \mathcal{R}_0^\downarrow,\,
              \mathcal{R} \!\equiv\! \mathcal{R}_0?
       \end{array} \right.
      
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Definition}{内部形式項の部分項}(SUBTERMS OF INTENAL FORM TERMS)
  内部形式項$T$の部分項(SUBTERMS OF INTERNAL FORM TERMS)を以下のように
  定義する.
  \begin{displaymath}
    \begin{array}{rll}
      \mathpzc{Sub}(t_0) &\stackrel{\mathrm{def}}{:=} &\{t_0\}\
       \text{\it s.t.}\ (t_0, \mathcal{R}_0) \in \Gamma_{gnd}  \\
      
      \mathpzc{Sub}(t_1) &\stackrel{\mathrm{def}}{:=} &\{t_1\}\
       \text{\it s.t.}\ (t_1, \mathcal{R}_1) \in \Gamma_{def}  \\
      \\
      
      \mathpzc{Sub}(T_1 \wedge T_2) &\stackrel{\mathrm{def}}{:=}
      &\left\{\!\! \begin{array}{l}
         \{T_1 \wedge T_2\} \cup \mathpzc{Sub}_{\{\}}(T_1 \wedge T_2)
          \;\; \mathpzc{if}\ \mathpzc{id}(T_2) =
           \mathpzc{id}(T_1 \wedge T_2)  \\
         \{T_1 \wedge T_2\} \cup \bigl(\mathpzc{Sub}(T_1) \cup
          \mathpzc{Sub}(T_2) \bigr)
           \;\; \text{\it otherwise}
      \end{array} \right.  \\
      
      \mathpzc{Sub}_{\{\}}(T) &\stackrel{\mathrm{def}}{:=}
      &\left\{\!\! \begin{array}{ll}
         \mathpzc{Sub}(T_1) \cup \mathpzc{Sub}_{\{\}}(T_2)
          & \mathpzc{if} \left\{\!\! \begin{array}{l}
            T = \exists T_1 \wedge \exists T_2  \\
            \mathpzc{id}(T_2) = \mathpzc{id}(T_1 \wedge T_2)
          \end{array} \right.  \\
         \mathpzc{Sub}(T_1) \cup \mathpzc{Sub}(T_2)
          & \mathpzc{if} \left\{\!\! \begin{array}{l}
            T = \exists T_1 \wedge \exists T_2  \\
            \mathpzc{id}(T_2) \neq \mathpzc{id}(T_1 \wedge T_2)
          \end{array} \right.  \\
         \mathpzc{Sub}(T) & \text{\it if}\;\;
          T \neq \exists T_1 \wedge \exists T_2
       \end{array} \right.  \\
      \\
      
      \mathpzc{Sub}(T_1 \vee T_2) &\stackrel{\mathrm{def}}{:=}
      &\left\{\!\! \begin{array}{l}
          \{T_1 \vee T_2\} \cup \mathpzc{Sub}_{\langle\rangle}(
           T_1 \vee T_2)
            \;\; \mathpzc{if}\ \mathpzc{id}(T_2) =
             \mathpzc{id}(T_1 \vee T_2)  \\
         \{T_1 \vee T_2\} \cup \bigl(\mathpzc{Sub}(T_1) \cup
          \mathpzc{Sub}(T_2) \bigr)
           \;\; \text{\it otherwise}
       \end{array} \right.  \\
      
      \mathpzc{Sub}_{\langle\rangle}(T) &\stackrel{\mathrm{def}}{:=}
      &\left\{\!\! \begin{array}{ll}
         \mathpzc{Sub}(T_1) \cup \mathpzc{Sub}_{\{\}}(T_2)
          & \mathpzc{if} \left\{\!\! \begin{array}{l}
            T = \exists T_1 \vee \exists T_2  \\
            \mathpzc{id}(T_2) = \mathpzc{id}(T_1 \vee T_2)
          \end{array} \right.  \\
         \mathpzc{Sub}(T_1) \cup \mathpzc{Sub}(T_2)
          & \mathpzc{if} \left\{\!\! \begin{array}{l}
            T = \exists T_1 \vee \exists T_2  \\
            \mathpzc{id}(T_2) \neq \mathpzc{id}(T_1 \vee T_2)
          \end{array} \right.  \\
         \mathpzc{Sub}(T) & \text{\it if}\;\;
          T \neq \exists T_1 \vee \exists T_2
      \end{array} \right.  \\
      \\
      
      \mathpzc{Sub}(\epsilon) &\stackrel{\mathrm{def}}{:=}
       & \{\epsilon\}
    \end{array}
  \end{displaymath}
\end{Definition}


\pagebreak
\begin{Definition}{内部表現項に関する型照合規則(PATTERNMATCHING RULES ON
    INTERNAL TERMS)} \label{inference_rules_for_internal}
  内部表現項$T$に関する型照合規則(PATTERNMATCHING RULES ON INTERNAL TERMS)を
  以下のように定義する.
  \begin{displaymath}
    \begin{array}{c}
      \begin{array}{rl}
        \dfrac{
          \Delta_1 \vdash T_1 : \mathcal{R}_1
           \quad \Delta_2 \vdash T_2 : \mathcal{R}_2
        }{
          \bigl\{(T_1 \!\wedge\! T_2, \mathcal{R}_1 \!\wedge\!
           \mathcal{R}_2) \bigr\} \cup (\Delta_1 \cup \Delta_2) \vdash
            T_1 \wedge T_2 : \mathcal{R}_1 \wedge \mathcal{R}_2
        }  &  \mbox{(T-Cas-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \Delta_1 \vdash T_1 : \mathcal{R}_1
           \quad \Delta_2 \vdash T_2 : \mathcal{R}_2
        }{
          \bigl\{(T_1 \!\vee\! T_2, \mathcal{R}_1 \!\vee\! \mathcal{R}_2)
           \bigr\} \cup (\Delta_1 \cup \Delta_2) \vdash
            T_1 \vee T_2 : \mathcal{R}_1 \vee \mathcal{R}_2
        }  &  \mbox{(T-Para-inter)}
      \end{array}  \\
      \\

      \begin{array}{rl}
        \left.\begin{array}{c}
        \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{}{ \bigl\{(\epsilon, \mathcal{R}_1^*) \bigr\} \vdash
            \epsilon : \mathcal{R}_1^*
             \quad \mathcal{R}_1\,\text{\it is}\, \text{\it Any}.
          }  &  (\epsilon)  \\
        \end{array}
        
        & \begin{array}{rl}
          \dfrac{
            T \!\not\equiv \epsilon
             \quad \Delta \vdash T : \mathcal{R}_1
          }{
            \{(T, \mathcal{R}_1^*) \} \cup \Delta \vdash
             T : \mathcal{R}_1^*
          }  &  (\alpha)  \\
        \end{array}
        \end{array}  \\
        \\
        \begin{array}{rl}
          \dfrac{
             \Delta_h \vdash T_h : \mathcal{R}_1
              \quad \Delta_t \vdash T_t : \mathcal{R}_1^*
               \quad (\Delta_h \cup \Delta_t) \vdash
                T_h \wedge T_t \,\neg\, \mathcal{R}_1
          }{
            \bigl\{(T_h \!\wedge\! T_t, \mathcal{R}_1^*) \bigr\} \cup
             (\Delta_h \cup \Delta_t) \vdash T_h
              \wedge T_t : \mathcal{R}_1^*
          }  &  (\beta)
        \end{array}
        \end{array} \right\}  &  \mbox{(T-Cat0-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left.\begin{array}{c}
        \begin{array}{rl}
          \dfrac{
            \Delta \vdash T : \mathcal{R}_1
          }{
            \bigl\{(T, \mathcal{R}_1^+) \bigr\} \cup \Delta \vdash
             T : \mathcal{R}_1^+
          }  &  (\alpha)
        \end{array}  \\
        \\
        \begin{array}{rl}
          \dfrac{
            \Delta_h \vdash T_h : \mathcal{R}_1
             \quad \Delta_t \vdash T_t : \mathcal{R}_1^+
              \quad (\Delta_h \cup \Delta_t) \vdash
               T_h \wedge T_t \,\neg\, \mathcal{R}_1
          }{
            \bigl\{(T_h \!\wedge\! T_t, \mathcal{R}_1^+) \bigr\} \cup
             (\Delta_h \cup \Delta_t) \vdash
              T_h \wedge T_t : \mathcal{R}_1^+
          }  &  (\beta)
        \end{array}
        \end{array} \right\}  &  \mbox{(T-Cat1-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left.\begin{array}{c}
        \begin{array}{rl}
          \dfrac{
            \Delta \vdash T : \mathcal{R}_1
          }{
            \bigl\{(T, \mathcal{R}_1^\downarrow) \bigr\} \cup \Delta \vdash
             T : \mathcal{R}_1^\downarrow
          }  &  (\alpha)
        \end{array}  \\
        \\
        \begin{array}{rl}
          \dfrac{
            \Delta_h \vdash T_h : \mathcal{R}_1
             \quad \Delta_t \vdash T_t : \mathcal{R}_1^\downarrow
              \quad (\Delta_h \cup \Delta_t) \vdash
               T_h \vee T_t \,\neg\, \mathcal{R}_1
          }{
            \bigl\{(T_h \!\vee\! T_t, \mathcal{R}_1^\downarrow) \bigr\}
             \cup (\Delta_h \cup \Delta_t) \vdash
              T_h \vee T_t : \mathcal{R}_1^\downarrow
          }  &  (\beta)
        \end{array}
        \end{array} \right\}  &  \mbox{(T-Dup-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left.\begin{array}{c}
        \begin{array}{rl}
          \dfrac{}{ \bigl\{(\epsilon, \mathcal{R}_1?) \bigr\} \vdash
            \epsilon : \mathcal{R}_1?
             \quad \mathcal{R}_1\,\text{\it is}\, \text{\it Any}.
          }  &  (\epsilon)
        \end{array}  \\
        \\
        \begin{array}{rl}
          \dfrac{ T \!\not\equiv\! \epsilon
            \quad \Delta \vdash T : \mathcal{R}_1
          }{
            \bigl\{(T, \mathcal{R}_1?) \bigr\} \cup \Delta \vdash
             T : \mathcal{R}_1?
          }  &  (\alpha)
        \end{array}
        \end{array} \right\}  &  \mbox{(T-Opt-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{
            \dfrac{}{
              (t_0, \mathcal{R}_0) \in \Gamma_0
               %\quad \mathcal{R} \in \text{\it Base}
            }
          }{
            \Bigl\{\bigl(\mathcal{F}(t_0), \mathcal{R}_0 \bigr) \Bigr\}
            \vdash \mathcal{F}(t_0) : \mathcal{R}_0
          }  &  \mbox{(T-Atom0-inter)}
        \end{array}
        
        & \begin{array}{rl}
            \dfrac{
              \dfrac{}{
                (t_1, \mathcal{R}_1) \in \Gamma_1
                 %\quad \mathcal{R} \not\in \text{\it Base}
              }
            }{
              \Bigl\{\bigl(\mathcal{F}(t_1), \mathcal{R}_1 \bigr) \Bigr\}
              \vdash \mathcal{F}(t_1) : \mathcal{R}_1
            }  &  \mbox{(T-Atom1-inter)}
          \end{array}
      \end{array}
    \end{array}
  \end{displaymath}
\end{Definition}


\pagebreak
\begin{Definition}
  \begin{displaymath}
    \begin{array}{lll}
      \Gamma_1 @ \Gamma_2  &\stackrel{\mathrm{def}}{:=}
      & \left\{ \begin{array}{ll}
          [\gamma_{11} \cdots \gamma_{1n},\, \gamma_{21} \cdots \gamma_{2m}]
          & \text{\it if}\;\; \Gamma_1 \equiv [\gamma_{11} \cdots
             \gamma_{1n}],\, \Gamma_2 \equiv [\gamma_{21} \cdots \gamma_{2m}
              ]  \\
          \bot  &  \text{\it otherwize}
        \end{array} \right.
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Definition}{型照合(PATTERNMATCHING)}
  型照合判定(PATTERNMATCHING DETERMINANT)
  $\mathpzc{m}:(T, \mathcal{R}) \rightarrow
  (T, \mathcal{R})\,\text{\it list}$を以下のように定義する.
  \begin{displaymath}
    \begin{array}{rll}
      
      \mathpzc{m}(T, \mathcal{R} \!\in\! \text{\it base}) &:=
      & \text{\it if}\ T \equiv \mathcal{C}_{const}\; \text{\it then}\
        \bigl[ (T, \mathcal{R}) \bigr]\; \text{\it else}\ \bot  \\
      \mathpzc{m}(T, \mathcal{R} \!\in\! \text{\it ident}) &:=
      & \text{\it if}\ T \equiv \mathcal{C}_{ident}\; \text{\it then}\
         \bigl[(T, \mathcal{R}) \bigr]\; \text{\it else}\ \bot  \\
      \mathpzc{m}(T, \mathcal{R}_1 \wedge \mathcal{R}_2) &:=
      & \!\!\! \begin{array}[t]{l}
          \text{\it if}\ T \equiv \exists T_1 \wedge \exists T_2\;
           \text{\it then}  \\
          \quad \bigl[(T, \mathcal{R}_1 \wedge \mathcal{R}_2) \bigr] @
          \bigl(\mathpzc{m}(T_1, \mathcal{R}_1) @
           \mathpzc{m}(T_2, \mathcal{R}_2) \bigr)  \\
          \text{\it else}\ \bot
        \end{array}  \\
      \mathpzc{m}(T, \mathcal{R}_1 \vee \mathcal{R}_2) &:=
      & \!\!\! \begin{array}[t]{l}
          \text{\it if}\ T \equiv \exists T_1 \vee \exists T_2\;
           \text{\it then}  \\
          \quad \bigl[(T, \mathcal{R}_1 \vee \mathcal{R}_2) \bigr] @
           \bigl(\mathpzc{m}(T_1, \mathcal{R}_1) @
            \mathpzc{m}(T_2, \mathcal{R}_2) \bigr)  \\
          \text{\it else}\ \bot
        \end{array}  \\
      \mathpzc{m}(T, \mathcal{R}_1^*)  &:=
      & \!\!\! \begin{array}[t]{l}
          \text{\it if}\ T \equiv \epsilon\; \text{\it then}\
           \bigl[(T, \mathcal{R}_1^*) \bigr]  \\
          \text{\it else} \! \begin{array}[t]{l}
            \text{\it if}\ \mathpzc{m}(T, \mathcal{R}_1) \neq \bot \;
             \text{\it then}\ \bigl[(T, \mathcal{R}_1^*) \bigr] @
              \mathpzc{m}(T, \mathcal{R}_1)  \\
            \text{\it else} \! \begin{array}[t]{l}
              \text{\it if}\ T \equiv \exists T_h \wedge \exists T_t\;
               \text{\it then}  \\
              \quad \bigl[(T, \mathcal{R}_1^*) \bigr] @
               \bigl(\mathpzc{m}(T_h, \mathcal{R}_1) @
                \mathpzc{m}(T_t, \mathcal{R}_1^*) \bigr)  \\
              \text{\it else}\ \bot
            \end{array}
          \end{array}
        \end{array}  \\
      \mathpzc{m}(T, \mathcal{R}_1^+)  &:=
      & \!\!\! \begin{array}[t]{l}
        \text{\it if}\ \mathpzc{m}(T, \mathcal{R}_1) \neq \bot\;
         \text{\it then}\ \bigl[(T, \mathcal{R}_1^+) \bigr] @
          \mathpzc{m}(T, \mathcal{R}_1)  \\
        \text{\it else} \! \begin{array}[t]{l}
          \text{\it if}\ T \equiv \exists T_h \wedge \exists T_t\;
           \text{\it then}  \\
          \quad \bigl[(T, \mathcal{R}_1^+) \bigr] @
           \bigl(\mathpzc{m}(T_h, \mathcal{R}_1) @
            \mathpzc{m}(T_t, \mathcal{R}_1^+) \bigr)  \\
          \text{\it else}\ \bot
        \end{array}
      \end{array}  \\
      \mathpzc{m}(T, \mathcal{R}_1^\downarrow)  &:=
      & \!\!\! \begin{array}[t]{l}
        \text{\it if}\ \mathpzc{m}(T, \mathcal{R}_1) \neq \bot\;
         \text{\it then}\; \bigl[(T, \mathcal{R}_1^\downarrow) \bigr] @
          \mathpzc{m}(T, \mathcal{R}_1)  \\
        \text{\it else} \! \begin{array}[t]{l}
          \text{\it if}\ T \equiv \exists T_h \vee \exists T_t\;
           \text{\it then}  \\
           \quad \bigl[(T, \mathcal{R}_1^\downarrow) \bigr] @
            \bigl(\mathpzc{m}(T_h, \mathcal{R}_1) @
             \mathpzc{m}(T_t, \mathcal{R}_1^\downarrow) \bigr)  \\
           \text{\it else}\ \bot
        \end{array}
      \end{array}  \\
      \mathpzc{m}(T, \mathcal{R}?)  &:=
      & \text{\it if}\ T \equiv \epsilon\; \text{\it then}\
         \bigl[(T, \mathcal{R}?) \bigr]\; \text{\it else}\
          \bigl[(T, \mathcal{R}?) \bigr] @ \mathpzc{m}(T, \mathcal{R})
      
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Property}
  \[ \Gamma \vdash T : \mathcal{R} \,\Leftrightarrow\,
      \Gamma = \mathpzc{m}(T, \mathcal{R}).
  \]
  \begin{Proof}
    Proof is simply, by double induction on structure of
    $(T, \mathcal{R})$, for both $\Rightarrow$ and $\Leftarrow$.
    $\Box$
  \end{Proof}
\end{Property}


\pagebreak
\begin{Definition}{項形式変換(TERM TRANSDUCER)} \label{term_tranceducer}
  項形式変換$\mathcal{F}: t \rightarrow T$を以下のように定義する.
  \begin{displaymath}
    \begin{array}{rll}
      \mathcal{F}(t_0) &\stackrel{\mathrm{def}}{:=} &t_0\
       \text{\it s.t.}\ (t_0, \mathcal{R}_0) \in \Gamma_{gnd}  \\
       
      \mathcal{F}(t_1) &\stackrel{\mathrm{def}}{:=} &t_1\
       \text{\it s.t.}\ (t_1, \mathcal{R}_1) \in \Gamma_{def}  \\
      \\
       
      \mathcal{F}(t_1 \wedge t_2) &\stackrel{\mathrm{def}}{:=}
      & {\bigl(\mathcal{F}(t_1) \wedge \mathcal{F}(t_2) \bigr)}^{
         \mathpzc{id}(t_1 \wedge t_2)}  \\
      
      \mathcal{F}(t_1 \vee t_2) &\stackrel{\mathrm{def}}{:=}
      & {\bigl(\mathcal{F}(t_1) \vee \mathcal{F}(t_2) \bigr)}^{
         \mathpzc{id}(t_1 \vee t_2)}  \\
      
      \mathcal{F}\bigl(\{t_1 \ldots t_n\} \bigr) &\stackrel{\mathrm{def}}{:=}
      & \left\{ \begin{array}{ll}
         \bigl(\epsilon^{\mathpzc{id}(\{\})} \wedge \bot \bigr)^{
          \mathpzc{id}(\{\})}
           & \text{\it if}\ n \!=\! 0  \\
         {\bigl(\mathcal{F}(t_1) \wedge \bot \bigr)}^{\mathpzc{id}(\{t_1\})}
           & \text{\it if}\ n \!=\! 1  \\
         {\Bigl(\mathcal{F}(t_1) \wedge \mathcal{F}\bigl({
          \{t_2 \ldots t_n\}}^i \bigr) \Bigr)}^i\;\; \text{\it where}\
           i = \mathpzc{id}\bigl(\{t_1 \cdots t_n\} \bigr)
            & \text{\it if}\ n \!\ge\! 2
        \end{array} \right. \\
      
      \mathcal{F}\bigl([t_1 \ldots t_n] \bigr) &\stackrel{\mathrm{def}}{:=}
      & \left\{ \begin{array}{ll}
        {\bigl(\bot \wedge \mathcal{F}(t_1) \bigr)}^{\mathpzc{id}([t_1])}
         & \text{\it if}\ n \!=\! 1  \\
        {\Bigl(\mathcal{F}\bigl({[t_2 \ldots t_n]}^i \bigr) \wedge
         \mathcal{F}(t_1) \Bigr)}^i\;\; \text{\it where}\
          i = \mathpzc{id}\bigl([t_1 \cdots t_n] \bigr)
           & \text{\it if}\ n \!\ge\! 2
       \end{array} \right.  \\
      
      \mathcal{F}\bigl(\langle t_1 \ldots t_n \rangle \bigr)
      &\stackrel{\mathrm{def}}{:=}
      & \left\{ \begin{array}{ll}
         {\bigl(\bot \vee \mathcal{F}(t_1) \bigr)}^{\mathpzc{id}(
           \langle t_1 \rangle)}
            & \text{\it if}\ n \!=\! 1  \\
         {\Bigl(\mathcal{F}\bigl({\langle t_2 \ldots t_n \rangle}^i
          \bigr) \vee \mathcal{F}(t_1) \Bigr)}^i\;\;
           \text{\it where}\ i = \mathpzc{id}\bigl(
            \langle t_1 \cdots t_n \rangle \bigr)
             & \text{\it if}\ n \!\ge\! 2
       \end{array} \right.  \\
      \\
      
      \mathcal{F}(\circ) &\stackrel{\mathrm{def}}{:=}
      & \epsilon^{\mathpzc{id}(\circ)}  \\
      
      \mathcal{F}({t_1}^?) &\stackrel{\mathrm{def}}{:=}
      & {\bigl({\mathcal{F}(t_1)}^? \bigr)}^{\mathpzc{id}({t_1}^?)}  \\
      
      \mathcal{F}(t^\leftarrow_1) &\stackrel{\mathrm{def}}{:=}
      & {\bigl({\mathcal{F}(t_1)}^\leftarrow \bigr)}^{\mathpzc{id}(
         {t_1}^\leftarrow)}  \\
      
      \mathcal{F}(t^\rightarrow_1) &\stackrel{\mathrm{def}}{:=}
      & {\bigl({\mathcal{F}(t_1)}^\rightarrow \bigr)}^{\mathpzc{id}(
         {t_1}^\rightarrow)}  \\
      
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Corollary}{existenz} \label{existenz}
  \begin{center}
    For any $T$, there is some t s.t. $\mathcal{F}(t) = T$.
  \end{center}
  
  \begin{Proof}
    Proof is induction on structure of $T$.
    
    Case $t_0$ s.t. $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    Trivially OK. from def. of $\mathcal{F}$,
    since $\mathcal{F}(t_0) \equiv t_0$.
    
    Case $t_1$ s.t. $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same way as the case of
    $t_0$ s.t. $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case $T_1 \wedge T_2$:
    Now we can assume existences of $t_1,\, t_2$, s.t.
    $T_1 = \mathcal{F}(t_1)$ and $T_2 = \mathcal{F}(t_2)$ by I.H.
    respectively. Here we suppose $t = t_1 \wedge t_2$, then we obtain 
    $\mathcal{F}(t) = \mathcal{F}(t_1) \wedge \mathcal{F}(t_2) =
    T_1 \wedge T_2 = T$, from def. of $\mathcal{F}$.
    
    Case $T_1 \vee T_2$:
    Same way as the case of $T_1 \wedge T_2$.
    
    Case $\epsilon$:
    Trivially OK. since $\mathcal{F}\bigl(\{\} \bigr) \equiv \epsilon$.
    $\Box$
  \end{Proof}
\end{Corollary}


\begin{Corollary} \label{connectivity_preservation_Cat}
  \[ \mathcal{F}(t) \equiv T_1 \wedge T_2 \Rightarrow
      \exists t_1, \exists t_2.\bigl[\mathcal{F}(t_1) \equiv T_1,\,
       \mathcal{F}(t_2) \equiv T_2,\ t \simeq t_1 \!\wedge\! t_2 \bigr]
  \]
  \begin{Proof}
    Proof is induction on structure of $t$
    
    From def. of $\mathcal{F}$, $\mathcal{F}(t) \equiv T_1 \wedge T_2$を
    得るのは,
    $t \equiv t_1 \wedge t_2$, 或いは$t \equiv \{t_1 \cdots t_n \}$ where
    $n \ge 1$, $t \equiv [t_1 \cdots t_m ]$, 或は
    $t \equiv \langle t_1 \rangle$の何れか.
    
    Case $t \equiv t_1 \wedge t_2$: From def. of $\mathcal{F}$,
    $\mathcal{F}(t_1 \wedge t_2) \equiv \mathcal{F}(t_1) \wedge
    \mathcal{F}(t_2)$, Then we can let $T_1 \equiv \mathcal{F}(t_1)$,
    $T_2 \equiv \mathcal{F}(t_2)$, from prerequisite, and we obtain
    $t_1 \wedge t_2 \simeq t_1 \wedge t_2$, from (Identity).
    
    Case $t \equiv \{t_1 \}$:
    subcase $\mathcal{F}(t_1) \equiv T_1 \wedge T_2$:
    前提より$\mathcal{F}\bigl(\{t_1 \} \bigr) \equiv \mathcal{F}(t_1)
    \equiv T_1 \wedge T_2$, from def. of $\mathcal{F}$.
    Then from I.H. we can assume existences of $t'_1,\, t'_2$,
    which satisfy
    $T_1 \equiv \mathcal{F}(t'_1),\, T_2 \equiv \mathcal{F}(t'_2)$, and
    $t_1 \simeq t'_1 \wedge t'_2$. さらに $\{t_1 \} \simeq t_1$, from
    $(\text{\it Associativity-Cat0}_1)$ and (Symmetry).
    故に $\{t_1 \} \simeq t'_1 \wedge t'_2$, from (Transitivity).
    subcase $\mathcal{F}(t_1) \not\equiv T_1 \wedge T_2$: Trivially O.K.
    for 前提不成立.
    
    Case $t \equiv \{t_1 \cdots t_n \}$, where $n \ge 2$: From def. of
    $\mathcal{F}$, $\mathcal{F}\bigl(\{t_1 \cdots t_n \} \bigr) \equiv
    \mathcal{F}(t_1) \wedge \mathcal{F}\bigl(\{t_2 \cdots t_n \} \bigr)$.
    Then we can let $T_1 \equiv \mathcal{F}(t_1)$,
    $T_2 \equiv \mathcal{F}\bigl(\{t_2 \cdots t_n \} \bigr)$,
    and $\{t_1 \cdots t_n \} \simeq t_1 \wedge \{t_2 \cdots t_n \}$,
    from $(\text{\it Associativity-Cat0}_n)$.
    
    Case $t \equiv [t_1 \cdots t_m ]$:
    $t \equiv \{t_1 \cdots t_n \}$, where $n \ge 1$のCaseと同様.
    
    Case $t \equiv \langle t_1 \rangle$:
    $t \equiv \{t_1 \}$のCaseと同様.
    $\Box$
  \end{Proof}
\end{Corollary}


\begin{Corollary} \label{connectivity_preservation_Para}
  \[ \mathcal{F}(t) \equiv T_1 \vee T_2 \Rightarrow
      \exists t_1, \exists t_2.\bigl[\mathcal{F}(t_1) \equiv T_1,\,
       \mathcal{F}(t_2) \equiv T_2,\ t \simeq t_1 \!\vee\! t_2 \bigr]
  \]
  \begin{Proof}
    Proof is same way as the Corollary \ref{connectivity_preservation_Cat}.
    $\Box$
  \end{Proof}
\end{Corollary}


\begin{Definition}{虚項(PHONY TERMS)} \label{phony_terms}
  $\epsilon$のみから構成される項$T_\epsilon \in \mathcal{E}$を,
  虚項(PHONY TERMS)と定義する.
  \[ T_{\epsilon} \stackrel{\mathrm{def}}{:=}
       \begin{array}[t]{l}
         \hphantom{|}\ T_{\epsilon1} \wedge T_{\epsilon2} \;|\;
                         T_{\epsilon1} \vee T_{\epsilon2} \\
         |\ {T_{\epsilon}}^?  \\
         |\ {T_{\epsilon}}^\leftarrow \;|\; {T_{\epsilon}}^\rightarrow  \\
         |\ T_{\epsilon} \wedge \bot \;|\; \bot \wedge T_{\epsilon}  \\
         |\ \bot \vee T_{\epsilon}  \\
         |\ \epsilon \wedge \bot\ \text{\it s.t.}\
             \mathpzc{id}(\epsilon) = \mathpzc{id}(\epsilon \wedge \bot) \\
         |\ \epsilon
       \end{array}
  \]
\end{Definition}


\begin{Lemma}{void consistency} \label{void_consistency}
  \[ \mathcal{F}(t) \in \mathcal{E} \,\Rightarrow\, t \simeq \{\} \]
  \begin{Proof}
    Proof is induction on structure of $t$.
    
    Case $t_0$ s.t. $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    From def. of $\mathcal{F}$, $\mathcal{F}(t) \not\in \mathcal{E}$.
    Then, 前提不成立.
    
    Case $t_1$ s.t. $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Same as the case of
    $t_0$ s.t. $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case $t_1 \wedge t_2$: From def. of $\mathcal{F}$,
    $\mathcal{E} \ni \mathcal{F}(t_1 \wedge t_2) = \mathcal{F}(t_1)
    \wedge \mathcal{F}(t_2)$. Here we can let
    $\mathcal{E} \ni T_{\epsilon1} = \mathcal{F}(t_1)$ and
    $\mathcal{E} \ni T_{\epsilon2} = \mathcal{F}(t_2)$ from def. of
    $T_{\epsilon}$. Then,
    $t_1 \simeq \{\}$ and $t_2 \simeq \{\}$ by I.H. for
    $T_{\epsilon1},\, T_{\epsilon2} \in \mathcal{E}$.
    よって$t_1 \simeq \{\}$, $t_2 \simeq \{\}$より
    $t_1 \wedge t_2 \simeq \{\} \wedge \{\}$ from (Transparency-Cas).
    さらに $\{\} \wedge \{\} \simeq \{\}$ from (PhonyH-Cas) with
    (E-Cat0-canon), we obtain
    $t = t_1 \wedge t_2 \simeq \{\}$, by (Transitivity).
    
    Case $t_1 \vee t_2$:
    Same way as the case of $t_1 \wedge t_2$.
    
    Case $\{t_1 \cdots t_n\}$:
    subcase $n = 0$: Trivially OK, since
    $\mathcal{F}\bigl(\{\} \bigr) = \epsilon \in \mathcal{E}$, from
    def. of $\mathcal{F}$, and $\{\} \simeq \{\}$ by
    lemma \ref{nil_equivalence} with (Identity).
    subcase $n = 1$: Now we suppose $t = \{t_1\}$, よって
    $\mathcal{F}(t) = \mathcal{F}\bigl(\{t_1\} \bigr) = \mathcal{F}(t_1)
    \in \mathcal{E}$ from def. of $\mathcal{F}$, then $t_1 \simeq \{\}$
    by I.H. これより we get $\{\} \simeq \{t_1\}$ by (Symmetry) and
    ($\text{\it Associativity-Cat0}_1$), then we finally obtain that
    $t = \{t_1\} \simeq \{\}$ by (Instantiation) and (Symmetry),
    since $\{t_1\}$ of l.h.s. has the term identifier of $t = \{t_1\}$
    given by (Instantiation).
    subcase $n \ge 2$: Now we can suppose $t = \{t_1 \cdots t_n \}$,
    よって$\mathcal{F}(t) = \mathcal{F}\bigl(\{t_1 \cdots t_n \}
    \bigr) = \mathcal{F}(t_1) \wedge \mathcal{F}\bigl(\{t_2 \cdots
    t_n \} \bigr) \in \mathcal{E}$ from def. of $\mathcal{F}$.
    ここで we can let $T_{\epsilon1} = \mathcal{F}(t_1)$ and
    $T_{\epsilon2} = \mathcal{F}\bigl(\{t_2 \cdots t_n \} \bigr)$ from
    def. of $T_\epsilon$. Then both $t_1 \simeq \{\}$ and
    $\{t_2 \cdots t_n \} \simeq \{\}$ by I.H.
    for $T_{\epsilon1},\, T_{\epsilon2} \in \mathcal{E}$.
    よって$t_1 \wedge \{t_2 \cdots t_n \} \simeq \{\} \wedge \{\}$を得る
    by (Transparency-Cas). 一方
    $\{t_1 \cdots t_n \} \simeq t_1 \wedge \{t_2 \cdots t_n \}$成立,
    since $t_1 \simeq t_1$ is by lemma
    \ref {identity_on_structual_equivalence} with (Identity). And
    we can construct  $\{t_2 \cdots t_n\} \simeq \{t_2 \cdots t_n\}$
    which r.h.s is instantiated with the term identifier
    $\mathpzc{id}\bigl(\{t_1 \cdots t_n\} \bigr)$ as below.
    先ず for each $t_j \equiv t_j$ s.t. $2 \le j \le n$ are by
    lemma \ref {identity_on_structual_equivalence}, then we just get
    $\{t_2 \cdots t_n\} \simeq \{t_2 \cdots t_n\}$ by (E-Cat0-canon)
    with (Identity), and we have that
    $\{t_2 \cdots t_n\} \simeq {\{t_2 \cdots t_n\}}^j$ where
    $j = \mathpzc{id}\bigl(\{t_1 \cdots t_n\} \bigr)$ by (Instantiation).
    よってwe have that $t_1 \wedge \{t_2 \cdots t_n\} \simeq
    t_1 \wedge {\{t_2 \cdots t_n\}}^j$ which
    $j = \mathpzc{id}\bigl(\{t_1 \cdots t_n\} \bigr)$ by
    (Transparency-Cas). From these facts, we eventually get that
    $\{t_1, t_2 \cdots t_n\} \simeq t_1 \wedge \{t_2 \cdots t_n\}$,
    which $\{t_1, t_2 \cdots t_n\}$ of l.h.s and $\{t_2 \cdots t_n\}$
    in r.h.s. are instantiated with term identifier of given term
    $\mathpzc{id}(t) = \mathpzc{id}\bigl(\{t_1 \cdots t_n\} \bigr)$,
    applying ($\text{\it AssociativityH-Cat0}_\infty$) \& (Instantiation)
    between twice (Symmetry)s. よって we obtain
    $t = \{t_1 \cdots t_n \} \simeq \{\} \wedge \{\}$ from (Transitivity).
    さらに$\{\} \wedge \{\} \simeq \{\}$ from
    (PhonyH-Cas) with (E-Cat0-canon), then
    $t = \{t_1 \cdots t_n \} \simeq \{\}$成立 by (Transitivity).
    
    Case $[t_1 \cdots t_n]$:
    Same way as the case of $\{t_1 \cdots t_n \}$,
    where $n \ge 1$.
    
    Case $\langle t_1 \cdots t_n \rangle$:
    Same way as the case of $[t_1 \cdots t_n]$.

    Case $\circ$:
    Same way as the case of $\{\}$.

    Case ${t_1}^?$:
    Same way as the case of $\{t_1\}$.
    
    Case $t^\leftarrow_1$: We obtain
    $\mathcal{F}(t) = \mathcal{F}({t_1}^\leftarrow) = \mathcal{F}(t_1)
    \in \mathcal{E}$ from def. of $\mathcal{F}$. ここで
    $t_1 \simeq \{\}$ by I.H. より
    $t = {t_1}^\leftarrow \simeq \{\}$ by (Alt-L) and (Instantiation) with
    twice (Symmetry).
    
    Case $t^\rightarrow_1$:
    Same as the case of $t^\leftarrow_1$.
    $\Box$
  \end{Proof}
\end{Lemma}


\pagebreak
\begin{displaymath}
  \begin{array}{l}
  \mathpzc{Carv}_{\{\}}(T, m) \,\stackrel{\mathrm{def}}{:=}\,
   \left\{ \begin{array}{l}
     {(\epsilon^m \wedge \bot)}^m
      \quad \text{\it if}\;\; T = (\epsilon \wedge \bot),\
       \mathpzc{id}(\epsilon) = \mathpzc{id}(\epsilon \wedge \bot)  \\
     {\bigl(T_1 \wedge \mathpzc{Carv}_{\{\}}(T_2, m) \bigr)}^m
      \quad \text{\it if}\;\; T = (T_1 \wedge T_2)\
       \text{\it s.t.}\ T_2 \neq \bot,\
        \mathpzc{id}(T_2) = \mathpzc{id}(T_1 \wedge T_2)  \\
         \multicolumn{1}{r}{\text{\it for some}\ T_1, T_2 }  \\
     T^m \quad \text{\it otherwise}
   \end{array} \right.  \\
   \\
  \mathpzc{Carv}_{[]}(T, m) \,\stackrel{\mathrm{def}}{:=}\,
   \left\{ \begin{array}{l}
     {(\bot \wedge T_2)}^m \quad \text{\it if}\;\; T = (\bot \wedge T_2)\
      \text{\it for some}\ T_2  \\
     {\bigl(\mathpzc{Carv}_{[]}(T_1, m) \wedge T_2 \bigr)}^m
      \quad \text{\it if}\;\; T = (T_1 \wedge T_2)\
       \text{\it s.t.}\ T_1 \neq \bot,\
        \mathpzc{id}(T_1) = \mathpzc{id}(T_1 \wedge T_2)  \\
         \multicolumn{1}{r}{\text{\it for some}\ T_1, T_2 }  \\
     T^m \quad \text{\it otherwise}
   \end{array} \right.  \\
   \\
  \mathpzc{Carv}_{\langle\rangle}(T, m) \,\stackrel{\mathrm{def}}{:=}\,
   \left\{ \begin{array}{l}
     {(\bot \vee T_2)}^m \quad \text{\it if}\;\; T = (\bot \vee T_2)\
      \text{\it for some}\ T_2  \\
     {\bigl(\mathpzc{Carv}_{\langle\rangle}(T_1, m) \vee T_2 \bigr)}^m
      \quad \text{\it if}\;\; T = (T_1 \vee T_2)\
       \text{\it s.t.}\ T_1 \neq \bot,\
        \mathpzc{id}(T_1) = \mathpzc{id}(T_1 \vee T_2)  \\
         \multicolumn{1}{r}{\text{\it for some}\ T_1, T_2 }  \\
     T^m \quad \text{\it otherwise}
   \end{array} \right.
  \end{array}
\end{displaymath}


\begin{displaymath}
  \begin{array}{l}
  \mathpzc{App}_{\{\}}(T_1, T_2, m) \,\stackrel{\mathrm{def}}{:=}\,
   \left\{ \begin{array}{l}
     {(T_2 \wedge \bot)}^m \quad \text{\it if}\;\; T_1 = \bot  \\
     {\bigl(T_{11} \wedge {(T_2 \wedge \bot)}^m \bigr)}^m
      \quad \text{\it if} \begin{array}[t]{l}
        T_1 = T_{11} \wedge \bot\
         \text{\it s.t.}\ \mathpzc{id}(T_{11}) \neq \mathpzc{id}(T_1),\
          \text{\it for some}\ T_{11}
      \end{array}  \\
     {\bigl(T_{11} \wedge \mathpzc{App}_{\{\}}(T_{12}, T_2, m) \bigr)}^m
      \quad \text{\it if} \begin{array}[t]{l}
        T_1 = T_{11} \wedge T_{12}\ \text{\it s.t.}\ T_{12} \neq \bot,\
         \mathpzc{id}(T_{12}) = \mathpzc{id}(T_1)  \\
        \multicolumn{1}{r}{ \text{\it for some}\ T_{11}, T_{22} }
      \end{array}  \\
     {T_1}^m \quad \text{\it otherwise}
   \end{array} \right.  \\
   \\
  \mathpzc{App}_{[]}(T_1, T_2, m) \,\stackrel{\mathrm{def}}{:=}\,
   \left\{ \begin{array}{l}
     {(\bot \wedge T_2)}^m \quad \text{\it if}\;\; T_1 = \bot  \\
     {\bigl({(\bot \wedge T_2)}^m \wedge T_{11} \bigr)}^m
      \quad \text{\it if} \begin{array}[t]{l}
        T_1 = \bot \wedge T_{11}\
         \text{\it s.t.}\ \mathpzc{id}(T_{11}) \neq \mathpzc{id}(T_1),\
          \text{\it for some}\ T_{11}
      \end{array}  \\
     {\bigl(\mathpzc{App}_{[]}(T_{12}, T_2, m) \wedge T_{11} \bigr)}^m
      \quad \text{\it if} \begin{array}[t]{l}
        T_1 = T_{12} \wedge T_{11}\ \text{\it s.t.}\ T_{12} \neq \bot\
         \mathpzc{id}(T_{12}) = \mathpzc{id}(T_1)  \\
        \multicolumn{1}{r}{ \text{\it for some}\ T_{11}, T_{22} }
      \end{array}  \\
     {T_1}^m \quad \text{\it otherwise}
   \end{array} \right.  \\
   \\
  \mathpzc{App}_{\langle\rangle}(T_1, T_2, m)
   \,\stackrel{\mathrm{def}}{:=}\, \left\{ \begin{array}{l}
     {(\bot \vee T_2)}^m \quad \text{\it if}\;\; T_1 = \bot  \\
     {\bigl({(\bot \vee T_2)}^m \vee T_{11} \bigr)}^m
      \quad \text{\it if} \begin{array}[t]{l}
        T_1 = \bot \vee T_{11}\
         \text{\it s.t.}\ \mathpzc{id}(T_{11}) \neq \mathpzc{id}(T_1),\
          \text{\it for some}\ T_{11}
      \end{array}  \\
     {\bigl(\mathpzc{App}_{\langle\rangle}(T_{12}, T_2, m) \vee T_{11}
      \bigr)}^m \quad \text{\it if} \begin{array}[t]{l}
        T_1 = T_{12} \vee T_{11}\ \text{\it s.t.}\ T_{12} \neq \bot\
         \mathpzc{id}(T_{12}) = \mathpzc{id}(T_1)  \\
        \multicolumn{1}{r}{ \text{\it for some}\ T_{11}, T_{22} }
      \end{array}  \\
     {T_1}^m \quad \text{\it otherwise}
   \end{array} \right.
  \end{array}
\end{displaymath}


\pagebreak
\begin{Definition}{論理的同値性(INTUITIONISTIC EQUIVALENCE OVER INTERNAL
TERMS)}
\label{equality_on_INTERNALS}
  項$T$の論理的同値項(INTUITIONISTIC EQUIVALENTS OVER INTERNAL TERMS) $T'$
  を以下のように定義する.
  $T'$が$T$論理的同値項であることを$T \cong T'$と表記する.
  \begin{displaymath}
    \begin{array}{c}

      \begin{array}{rl}
        \dfrac{T \equiv T'}{
          T \cong T'
        }  &  (\text{\it Identity-inter})
      \end{array}  \\
      \\
      
      \begin{array}{lll}
        \begin{array}{rl}
          \dfrac{T \cong T'} {
            T' \cong T
          }  &  (\text{\it Symmetry-inter})
        \end{array}
        & \begin{array}{rl}
        \dfrac{T_1 \cong T_2 \quad T_2 \cong T_3}{
          T_1 \cong T_3
        }  &  (\text{\it Transitivity-inter})
        \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{T_1 \cong T_1' \quad T_2 \cong T_2'}{
            T_1 \!\wedge\! T_2 \cong T_1' \!\wedge\! T_2'
          }  &  (\text{\it Transparency-Cas-inter})
        \end{array}
        & \begin{array}{rl}
            \dfrac{T_1 \cong T_1' \quad T_2 \cong T_2'}{
              T_1 \!\vee\! T_2 \cong T_1' \!\vee\! T_2'
            }  &  (\text{\it Transparency-Par-inter})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{ T \cong T_1 \!\wedge\! (T_2 \!\wedge\! T_3) \quad
          T' \cong (T_1 \!\wedge\! T_2) \!\wedge\! T_3}{
          T \cong T'
        }  &  (\text{\it Associativity-Cas-inter})
      \end{array}  \\
      \\
      \begin{array}{rl}
        \dfrac{T \cong T_1 \!\vee\! (T_2 \!\vee\! T_3) \quad
          T' \cong (T_1 \!\vee\! T_2) \!\vee\! T_3}{
          T \cong T'
        }  &  (\text{\it Associativity-Par-inter})
      \end{array}  \\
      \\
      \\
      
      \begin{array}{rl}
        \dfrac{T \cong T'}{
          T \cong (T' \wedge \bot)\ \text{\it s.t.}\
           \mathpzc{id}(T') \neq \mathpzc{id}(T' \wedge \bot)
        }  &  \text{\it (Link-Cat0}_1\text{\it -inter)}
      \end{array}  \\
      \\
      \begin{array}{l}
        \text{\it (LinkH-Cat0}_\infty\text{\it -inter):}  \\
        \qquad \dfrac{
          \begin{array}{l}
            T \cong T_1 \wedge (T_2 \wedge T_3)\
             \text{\it where} \!\begin{array}[t]{l}
               \mathpzc{id}(T_3) = \mathpzc{id}(T_2 \wedge T_3)\ \mbox{或}\
                \mathpzc{id}(T_2) \neq \mathpzc{id}(T_2 \wedge T_3),\, T_3
                 = \bot  \\
               \text{\it s.t.} \!\begin{array}[t]{l}
                 (T_2 \wedge T'_3) = \mathpzc{Carv}_{\{\}}
                  \bigl((T_2 \wedge T_3), \mathpzc{id}(T_2 \wedge T'_3)
                   \bigr)  \\
                  \mathpzc{id}(T_2 \wedge T'_3) \not\in
                   \mathpzc{id}(T_2 \wedge T_3) \setminus \bigl\{
                    \mathpzc{id}(T_2 \wedge T_3) \bigr\}
               \end{array}
             \end{array}  \\
            T' \cong T_1 \wedge (T_2 \wedge T'_3)\
             \text{\it where} \!\begin{array}[t]{l}
              \mathpzc{id}(T'_3) = \mathpzc{id}(T_2 \wedge T'_3)\ \mbox{或}\
               \mathpzc{id}(T_2) \neq \mathpzc{id}(T_2 \wedge T'_3),\,
                T'_3 = \bot  \\
              \mathpzc{id}(T_2 \wedge T'_3) =
               \mathpzc{id}\bigl(T_1 \wedge (T_2 \wedge T'_3) \bigr)
             \end{array}
          \end{array}
        }{
          T \cong T'
        }
      \end{array}  \\
      \\
      \begin{array}{l}
        \text{\it (LinkT-Cat0}_\infty\text{\it -inter):}  \\
        \qquad \dfrac{
          \begin{array}{l}
            T \cong (T_1 \wedge T_2) \wedge T_3\
             \text{\it where} \!\begin{array}[t]{l}
               T_2 = \bot\ \text{\it s.t.}\
                \mathpzc{id}(T_1) \neq \mathpzc{id}(T_1 \wedge T_2)  \\
               \mbox{或}\ T_2 = \exists T_{21} \wedge \bot\ \text{\it s.t.}\
                \mathpzc{id}(T_{21}) \neq \mathpzc{id}(T_2),\
                 \mathpzc{id}(T_2) = \mathpzc{id}(T_1 \wedge T_2)  \\
               \mbox{或}\ T_2 = \exists T_{21} \wedge \exists T_{22},\
                T_{22} \neq \bot\ \text{\it s.t.} \!\begin{array}[t]{l}
                  \mathpzc{id}(T_{22}) = \mathpzc{id}(T_2)  \\
                  \mathpzc{id}(T_2) = \mathpzc{id}(T_1 \wedge T_2)
                \end{array}  \\
             \end{array}  \\
            T' \cong T_1 \wedge T'_2\ \text{\it where}\
             \mathpzc{id}(T'_2) = \mathpzc{id}(T_1 \wedge T'_2)  \\
             \hphantom{T' \cong T_1 \wedge T'_2\ \text{\it where}\ }
              \text{\it s.t.} \!\begin{array}[t]{l}
                T'_2 = \mathpzc{App}_{\{\}}\bigl(T_2, T_3,
                        \mathpzc{id}(T'_2) \bigr)  \\
                \mathpzc{id}(T'_2) \not\in \mathpzc{id}\bigl((T_1 \wedge
                 T_2) \wedge T_3 \bigr) {\large \setminus} \Bigl\{
                  \mathpzc{id}(T_1 \wedge T_2), \mathpzc{id}\bigl(
                   (T_1 \wedge T_2) \wedge T_3 \bigr) \Bigr\}
               \end{array}
          \end{array}
        }{
          T \cong T'
        }
      \end{array}
      
    \end{array}
  \end{displaymath}
  
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \dfrac{T \cong T'}{
          T \cong (\bot \wedge T')\ \text{\it s.t.}\
           \mathpzc{id}(T') \neq \mathpzc{id}(\bot \wedge T')
        }  &  \text{\it (Link-Cat1}_1\text{\it -inter)}
      \end{array}  \\
      \\
      \begin{array}{rl}
        \dfrac{
          \begin{array}{l}
            T \cong T_1 \wedge (T_3 \wedge T_2)\
             \text{\it where} \!\begin{array}[t]{l}
               \mathpzc{id}(T_3) = \mathpzc{id}(T_3 \wedge T_2)\ \mbox{或}\
                T_3 = \bot  \\
               \text{\it s.t.}\ (T'_3 \wedge T_2) = \mathpzc{Carv}_{[]}
                \bigl((T_3 \wedge T_2), \mathpzc{id}(T'_3 \wedge T_2)
                 \bigr)  \\
               \hphantom{\text{\it s.t.}\ } \mathpzc{id}(T'_3 \wedge T_2)
                \not\in \mathpzc{id}(T_3 \wedge T_2) \setminus \{
                 \mathpzc{id}(T_3 \wedge T_2) \}
             \end{array}  \\
            T' \cong (T'_3 \wedge T_2) \wedge T_1\
             \text{\it where} \!\begin{array}[t]{l}
              \mathpzc{id}(T'_3) = \mathpzc{id}(T'_3 \wedge T_2)\ \mbox{或}\
               T'_3 = \bot  \\
              \mathpzc{id}(T'_3 \wedge T_2) =
               \mathpzc{id}\bigl((T'_3 \wedge T_2) \wedge T_1 \bigr)
             \end{array}
          \end{array}
        }{
          T \cong T'
        }  &  \!\!\text{\it (LinkH-Cat1}_\infty\text{\it -inter)}
      \end{array}  \\
      \\
      \begin{array}{l}
        \text{\it (LinkT-Cat1}_\infty\text{\it -inter):}  \\
        \qquad \dfrac{
          \begin{array}{l}
            T \cong (T_2 \wedge T_1) \wedge T_3\
             \text{\it where} \!\begin{array}[t]{l}
               T_2 = \bot\ \text{\it s.t.}\
                \mathpzc{id}(T_1) \neq \mathpzc{id}(T_2 \wedge T_1)  \\
               \mbox{或}\ T_2 = \bot \wedge \exists T_{21}\ \text{\it s.t.}\
                \mathpzc{id}(T_{21}) \neq \mathpzc{id}(T_2),\
                 \mathpzc{id}(T_2) = \mathpzc{id}(T_2 \wedge T_1)  \\
               \mbox{或}\ T_2 = \exists T_{22} \wedge \exists T_{21},\
                T_{22} \neq \bot\ \text{\it s.t.} \!\begin{array}[t]{l}
                  \mathpzc{id}(T_{22}) = \mathpzc{id}(T_2)  \\
                  \mathpzc{id}(T_2) = \mathpzc{id}(T_2 \wedge T_1)
                \end{array}  \\
             \end{array}  \\
            T' \cong T'_2 \wedge T_1\ \text{\it where}\
             \mathpzc{id}(T'_2) = \mathpzc{id}(T'_2 \wedge T_1)  \\
             \hphantom{T' \cong T_1 \wedge T'_2\ \text{\it where}\ }
              \text{\it s.t.} \!\begin{array}[t]{l}
                T'_2 = \mathpzc{App}_{[]}\bigl(T_2, T_3,
                        \mathpzc{id}(T'_2) \bigr)  \\
                \mathpzc{id}(T'_2) \not\in \mathpzc{id}\bigl((T_2 \wedge
                 T_1) \wedge T_3 \bigr) {\large \setminus} \Bigl\{
                  \mathpzc{id}(T_2 \wedge T_1), \mathpzc{id}\bigl(
                   (T_2 \wedge T_1) \wedge T_3 \bigr) \Bigr\}
               \end{array}
          \end{array}
        }{
          T \cong T'
        }
      \end{array}  \\
      \\
      \\
      
      \begin{array}{rl}
        \dfrac{T \cong T'}{
          T \cong (\bot \vee T')\ \text{\it s.t.}\
           \mathpzc{id}(T') \neq \mathpzc{id}(\bot \vee T')
        }  &  \text{\it (Link-Dup}_1\text{\it -inter)}
      \end{array}  \\
      \\
      \begin{array}{rl}
        \dfrac{
          \begin{array}{l}
            T \cong T_1 \vee (T_3 \vee T_2)\
             \text{\it where} \!\begin{array}[t]{l}
               \mathpzc{id}(T_3) = \mathpzc{id}(T_3 \vee T_2)\ \mbox{或}\
                T_3 = \bot  \\
               \text{\it s.t.}\ (T'_3 \vee T_2) =
                \mathpzc{Carv}_{\langle\rangle}\bigl((T_3 \vee T_2),
                 \mathpzc{id}(T'_3 \vee T_2) \bigr)  \\
               \hphantom{\text{\it s.t.}\ } \mathpzc{id}(T'_3 \vee T_2)
                \not\in \mathpzc{id}(T_3 \vee T_2) \setminus \{
                 \mathpzc{id}(T_3 \vee T_2) \}
             \end{array}  \\
            T' \cong (T'_3 \vee T_2) \vee T_1\
             \text{\it where} \!\begin{array}[t]{l}
               \mathpzc{id}(T'_3) = \mathpzc{id}(T'_3 \vee T_2)\ \mbox{或}\
                T'_3 = \bot  \\
               \mathpzc{id}(T'_3 \vee T_2) =
                \mathpzc{id}\bigl((T'_3 \vee T_2) \vee T_1 \bigr)
             \end{array}
          \end{array}
        }{
          T \cong T'
        }  &  \!\!\text{\it (LinkH-Dup}_\infty\text{\it -inter)}
      \end{array}  \\
      \\
      \begin{array}{l}
        \text{\it (LinkT-Dup}_\infty\text{\it -inter):}  \\
        \qquad \dfrac{
          \begin{array}{l}
            T \cong (T_2 \vee T_1) \vee T_3\
             \text{\it where} \!\begin{array}[t]{l}
               T_2 = \bot\ \text{\it s.t.}\
                \mathpzc{id}(T_1) \neq \mathpzc{id}(T_2 \vee T_1)  \\
               \mbox{或}\ T_2 = \bot \vee \exists T_{21}\ \text{\it s.t.}\
                \mathpzc{id}(T_{21}) \neq \mathpzc{id}(T_2),\
                 \mathpzc{id}(T_2) = \mathpzc{id}(T_2 \vee T_1)  \\
               \mbox{或}\ T_2 = \exists T_{22} \vee \exists T_{21},\
                T_{22} \neq \bot\ \text{\it s.t.} \!\begin{array}[t]{l}
                  \mathpzc{id}(T_{22}) = \mathpzc{id}(T_2)  \\
                  \mathpzc{id}(T_2) = \mathpzc{id}(T_2 \vee T_1)
                \end{array}  \\
             \end{array}  \\
            T' \cong T'_2 \vee T_1\ \text{\it where}\
             \mathpzc{id}(T'_2) = \mathpzc{id}(T'_2 \vee T_1)  \\
             \hphantom{T' \cong T_1 \wedge T'_2\ \text{\it where}\ }
              \text{\it s.t.} \!\begin{array}[t]{l}
                T'_2 = \mathpzc{App}_{[]}\bigl(T_2, T_3,
                        \mathpzc{id}(T'_2) \bigr)  \\
                \mathpzc{id}(T'_2) \not\in \mathpzc{id}\bigl((T_2 \vee
                 T_1) \vee T_3 \bigr) {\large \setminus} \Bigl\{
                  \mathpzc{id}(T_2 \vee T_1), \mathpzc{id}\bigl(
                   (T_2 \vee T_1) \vee T_3 \bigr) \Bigr\}
               \end{array}
          \end{array}
        }{
          T \cong T'
        }
      \end{array}
      
    \end{array}
  \end{displaymath}
  
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{\bigl(\epsilon^{\mathpzc{id}(\epsilon \wedge \bot)} \wedge
                  \bot \bigr) \wedge T \cong T'}{
            T \cong T'
          }  &  (\text{\it RevealH-Cas-inter})
        \end{array}
        & \begin{array}{rl}
            \dfrac{T \wedge \bigl(\epsilon^{\mathpzc{id}
             (\epsilon \wedge \bot)} \wedge \bot \bigr) \cong T'}{
              T \cong T'
            }  &  (\text{\it RevealT-Cas-inter})
          \end{array}
      \end{array}  \\
      \\
      \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{\bigl(\epsilon^{\mathpzc{id}(\epsilon \wedge \bot)} \wedge
                  \bot \bigr) \vee T \cong T'}{
            T \cong T'
          }  &  (\text{\it RevealH-Par-inter})
        \end{array}
        & \begin{array}{rl}
            \dfrac{T \vee \bigl(\epsilon^{\mathpzc{id}(
              \epsilon \wedge \bot)} \wedge \bot \bigr) \cong T'}{
              T \cong T'
            }  &  (\text{\it RevealT-Par-inter})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{T \cong T'}{
            \bigl(\epsilon^{\mathpzc{id}(\epsilon \wedge \bot)} \wedge
             \bot \bigr) \wedge T \cong T'
          }  &  (\text{\it PhonyH-Cas-inter})
        \end{array}
        & \begin{array}{rl}
            \dfrac{T \cong T'}{
              T \wedge \bigl(\epsilon^{\mathpzc{id}(\epsilon \wedge \bot)}
               \wedge \bot \bigr) \cong T'
            }  &  (\text{\it PhonyT-Cas-inter})
          \end{array}
      \end{array}  \\
      \\
      \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{T \cong T'}{
            \bigl(\epsilon^{\mathpzc{id}(\epsilon \wedge \bot)} \wedge
             \bot \bigr) \wedge T \cong T'
          }  &  (\text{\it PhonyH-Par-inter})
        \end{array}
        & \begin{array}{rl}
            \dfrac{T \cong T'}{
              T \vee \bigl(\epsilon^{\mathpzc{id}(\epsilon \wedge \bot)}
               \wedge \bot \bigr) \cong T'
            }  &  (\text{\it PhonyT-Par-inter})
          \end{array}
      \end{array}
      
    \end{array}
  \end{displaymath}
\end{Definition}


\begin{Claim} \label{equ_on_phony_terms1}
  \[ T \cong T_\epsilon \,\Rightarrow\, T \in \mathcal{E} \]
  \begin{Proof}
    Proof is induction on size of derivation for $T \cong T_\epsilon$.
    
    Case (Identity-inter):
    Trivially OK. since $T \equiv T_\epsilon$ from (Identity-inter), then
    $T \in \mathcal{E}$ from def. of $\mathcal{E}$.
    
    Case (Symmetry-inter):
    In this case, we proceed by cases on num. of application times of
    (Symmetry-inter). Here we can predicate its PROPER subderivation
    (e.g. the subderivation which is derived by a rule excepting
    Symmetry-inter) according to the times of (Symmetry-inter)
    applications.
    $2m$ s.t. $m \in \mathbb{N}$: Now we can suppose that
    $T \cong T_\epsilon$ is the result of $2m$ times of (Symmetry-inter)
    applications, then the (PROPER) subderivation is also
    $T \cong T_\epsilon$ which size of derivation is proper smaller than
    original $T \cong T_\epsilon$.
    よって we have $T \in \mathcal{E}$ by appling I.H. on the subderivation
    $T \cong T_\epsilon$.
    $2m + 1$: The reason is similar as above case, we can assume that
    the (PROPER) subderivation is $T_\epsilon \cong T$, since the num. of
    applications of (Symmetry-inter) is odd times. Then now we proceed
    by cases on the applied rule on its (PROPER) subderivation
    $T_\epsilon \cong T$.
    subcase (Identity-inter):
    It's trivial, since $T_\epsilon \equiv T$成立 from (Identity-inter),
    then $T \in \mathcal{E}$ from def. of $\mathcal{E}$.
    subcase (Symmetry-inter):
    Don't mention this case, for the meaning of PROPER subderivation.
    (PROPER) subderivation is derived by a rule other than
    (Symmetry-inter).
    subcase (Transitivity-inter):
    In this case, we have subderivations $T_\epsilon \cong T'$ and
    $T' \cong T$ from (Transitivity-inter). Here we can apply
    (Symmetry-inter) on the former subderivation $T_\epsilon \cong T'$,
    then we have $T' \cong T_\epsilon$ on which we can apply I.H to get
    $T' \in \mathcal{E}$. Since derivation size of newly constructed
    derivation $T' \cong T_\epsilon$ by (Symmetry-inter) is still purely
    smaller than $T \cong T_\epsilon$.
    From this fact, we can suppose
    $T' = T'_\epsilon \cong T$ for some $T'_\epsilon \in \mathcal{E}$,
    and apply (Symmetry-inter) again to have $T \cong T'_\epsilon$ which
    size of derivation is also smaller than $T \cong T_\epsilon$. Hence
    we can apply I.H. on it, then eventually obtain $T \in \mathcal{E}$.
    subcase (Transparency-Cas-inter):
    From (Transparency-Cas-inter), we can assume that
    $T_\epsilon = T_{\epsilon_1} \wedge T_{\epsilon_2}$ for some
    $T_{\epsilon_1}, T_{\epsilon_2} \in \mathcal{E}$, and
    $T = T_1 \wedge T_2$ for some $T_1, T_2$, かつ
    $T_{\epsilon_1} \simeq T_1$ and $T_{\epsilon_2} \simeq T_2$成立 as
    its subderivations. Here we apply (Symmetry-inter) on both
    subderivations
    $T_{\epsilon_1} \simeq T_1$ and $T_{\epsilon_2} \simeq T_2$,
    then we got $T_1 \cong T_{\epsilon_1}$ and $T_2 \cong T_{\epsilon_2}$
    respectively. ここで their total size of derivations are still smaller
    than $T \cong T_\epsilon$, then we have $T_1 \in \mathcal{E}$ and
    $T_2 \in \mathcal{E}$ respectively, by I.H. From this facts, we also
    suppose that $T_1 = T'_{\epsilon_1}$ and $T_2 = T'_{\epsilon_2}$ for
    some $T'_{\epsilon_1}, T'_{\epsilon_2} \in \mathcal{E}$.故に we found
    $T = T_1 \wedge T_2 = T'_{\epsilon_1} \wedge T'_{\epsilon_2} \in
    \mathcal{E}$.
    subcase (Transparency-Par-inter):
    Similar to the subcase of (Transparency-Cas-inter).
    subcase (Associativity-Cas-inter):
    From (Associativity-Cas-inter), we have
    $T_\epsilon \cong T_{\epsilon_1} \wedge (T_{\epsilon_2} \wedge
    T_{\epsilon_3})$ for some $T_{\epsilon_1}, T_{\epsilon_2}, T_{\epsilon_3}
    \in \mathcal{E}$, and
    $T \cong (T_1 \wedge T_2) \wedge T_3$ for some $T_1, T_2, T_3$ as
    prerequisites. Then we found that
    $T \cong (T_{\epsilon_1} \wedge T_{\epsilon_2}) \wedge T_{\epsilon_3}
    \in \mathcal{E}$, from syntax definition of (Associativity-Cas-inter)
    s.t. $T_1 = T_{\epsilon_1}, T_2 = T_{\epsilon_2}, T_3 = T_{\epsilon_3}$.
    Hence we can apply I.H. on
    $T \cong (T_{\epsilon_1} \wedge T_{\epsilon_2}) \wedge T_{\epsilon_3}$,
    and obtain $T \in \mathcal{E}$.
    subcase (Associativity-Par-inter):
    Similar to the subcase of (Associativity-Cas-inter).
    subcase (RevealH-Cas-inter):
    From (RevealH-Cas-inter), we can assume
    $\epsilon \wedge T_\epsilon \cong T$ as prerequisite. And we apply
    (Symmetry-inter) on $\epsilon \wedge T_\epsilon \cong T$ to get
    $T \cong \epsilon \wedge T_\epsilon$, which deduction size is smaller
    than $T \cong T_\epsilon$ in beginning of this case, then can
    apply I.H. on $T \cong \epsilon \wedge T_\epsilon$ to obtain
    $T \in \mathcal{E}$ for $\epsilon \wedge T_\epsilon \in \mathcal{E}$.
    subcase (RevealT-Cas-inter): Similar to the subcase of
    (RevealH-Cas-inter).
    subcase (RevealH-Par-inter) and (RevealT-Par-inter):
    Similar to the subcases of (RevealH-Cas-inter) and (RevealT-Cas-inter)
    respectively.
    subcase (PhonyH-Cas-inter):
    From (PhonyH-Cas-inter), we assume
    $T_\epsilon = \epsilon \wedge T'_\epsilon$ for some
    $T'_\epsilon \in \mathcal{E}$, then
    $T_\epsilon = \epsilon \wedge T_\epsilon' \cong T$. よって
    we have $T'_\epsilon \cong T$成立 from (PhonyH-Cas-inter), and we apply
    (Symmetry-inter) to get $T \cong T'_\epsilon$, which size of deduction
    is smaller than $T \cong T_\epsilon$, then we can apply I.H. to obtain
    $T \in \mathcal{E}$.
    subcase (PhonyT-Cas-inter):
    Similar to the subcase of (PhonyH-Cas-inter).
    subcase (PhonyH-Par-inter) and (PhonyT-Par-inter):
    Similar to the subcases of (PhonyH-Cas-inter) and (PhonyT-Cas-inter)
    respectively.
    subcase (Instantiation):
    From (Instantiation), we can assume that $T = {T_1}^i$ which $i$ is
    its term identifier, and $T_\epsilon \cong T_1$ as prerequisite.
    And we apply (Symmetry-inter) on $T_\epsilon \cong T_1$ to get
    $T_1 \cong T_\epsilon$, which size of deduction is smaller than
    $T \cong T_\epsilon$, then we eventually have $T_1 \in \mathcal{E}$
    by I.H. From this fact, we found that $T = {T_1}^i \in \mathcal{E}$
    also 成立.
    
    Case (Transitivity-inter),
    (Transparency-Cas-inter), (Transparency-Par-inter),
    (Associativity-Cas-inter), (Associativity-Par-inter):
    Similar to the corresponding subcases in the case of (Symmetry-inter).
    
    Case (RevealH-Cas-inter):
    In this case, we can assume that $\epsilon \wedge T \cong T_\epsilon$
    as prerequisite from (RevealH-Cas-inter).
    Then we got $\epsilon \wedge T \in \mathcal{E}$ by I.H. that implies
    $T \in \mathcal{E}$ from def. of $\mathcal{E}$.
    
    Case (RevealT-Cas-inter):
    Similar to the case of (RevealH-Cas-inter).
    
    Case (RevealH-Par-inter), (RevealT-Par-inter):
    Similar to the cases of (RevealH-Cas-inter) and (RevealT-Cas-inter)
    respectively.
    
    Case (PhonyH-Cas-inter):
    From (PhonyH-Cas-inter), we can assume that $T = \epsilon \wedge T'$
    for some $T'$, then we found that
    $T = \epsilon \wedge T' \cong T_\epsilon$成立 and its prerequisite is
    $T' \cong T_\epsilon$. Then we apply I.H. on $T' \cong T_\epsilon$
    to have $T' \in \mathcal{E}$. According to this fact,
    $T = \epsilon \wedge T' \in \mathcal{E}$ also 成立 from def. of
    $\mathcal{E}$.
    
    Case (PhonyT-Cas-inter):
    Similar to the case of (PhonyH-Cas-inter).
    
    Case (PhonyH-Par-inter), (PhonyT-Par-inter).
    Similar to the cases of (PhonyH-Cas-inter) and (PhonyT-Cas-inter)
    respectively.
    
    Case (Instantiation):
    From (Instantiation-inter), we can assume that
    $T_\epsilon = {T_{\epsilon_1}}^i$ which $i$ is the term identifier,
    for some $T_{\epsilon_1} \in \mathcal{E}$, and
    $T \cong T_{\epsilon_1}$ as prerequisite 成立. According to this fact,
    we found that $T \in \mathcal{E}$ by simply applying I.H.
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Claim} \label{equ_on_phony_terms2}
  \[ T_\epsilon \cong T \,\Rightarrow\, T \in \mathcal{E} \]
  \begin{Proof}
    Proof is similar to Claim \ref{equ_on_phony_terms1}.
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Lemma}{membership on phony terms}\label{membership_on_phony_terms}
  \[ T \cong \epsilon\ \mbox{或}\ \epsilon \cong T
      \,\Leftrightarrow\, T \in \mathcal{E}
  \]
  \begin{Proof}
    \
    
    $(\Rightarrow)$:
    Proof is straightforward by claim \ref{equ_on_phony_terms1} \&
    \ref{equ_on_phony_terms2} for $\epsilon \in \mathcal{E}$.
    
    $(\Leftarrow)$:
    Proof is simple induction on structure of $T \in \mathcal{E}$.
    
    Case $\epsilon$: Trivially OK, since we have
    $\epsilon \cong \epsilon^i = T$, which $i = \mathpzc{id}(T)$,
    by applying (Identity-inter) and (Insitantiation-inter) on
    $\epsilon \equiv \epsilon$.
    
    Case $T_{\epsilon1} \wedge T_{\epsilon2}$:
    In this case, we can apply I.H. on each $T_{\epsilon_1}$ and
    $T_{\epsilon_2}$ s.t. $T = {(T_{\epsilon_1} \wedge T_{\epsilon_2})}^i$
    which $i$ is term identifier of $T$, then have
    $T_{\epsilon_1} \cong \epsilon$ 或 $\epsilon \cong T_{\epsilon_1}$
    and $T_{\epsilon_2} \cong \epsilon$ 或 $\epsilon \cong T_{\epsilon_2}$
    respectively. ここで we proceed by cases on combination of above
    4 conditions (e.g.:
    $T_{\epsilon_1} \cong \epsilon$ 或 $\epsilon \cong T_{\epsilon_1}$
    and $T_{\epsilon_2} \cong \epsilon$ 或 $\epsilon \cong T_{\epsilon_2}$
    ). さらに taking (a kind of) restriction comes from meaning of 或 into
    account, it's enough to inspect these combinations as below.
    subcase $\epsilon \cong T_{\epsilon_1}$ and
    $\epsilon \cong T_{\epsilon_2}$: We have $\epsilon \wedge \epsilon \cong
    {(T_{\epsilon_1} \wedge T_{\epsilon_2})}^i = T$ s.t.
    $i = \mathpzc{id}(T)$ by (Transparency-Cas-inter) and
    (Instantiation-inter), then apply (Symmetry-inter) to get
    $T \cong \epsilon \wedge \epsilon$. 一方 we can find that
    $\epsilon \wedge \epsilon \cong \epsilon$成立 by (PhonyH-Cas-inter),
    since applying (Identity-inter) on $\epsilon \equiv \epsilon$ gives
    $\epsilon \cong \epsilon$. Hence we eventually obtain
    $T \cong \epsilon$, by applying (Transitivity-inter) on
    $T \cong \epsilon \wedge \epsilon$ and
    $\epsilon \wedge \epsilon \cong \epsilon$.
    subcase $\epsilon \cong T_{\epsilon_1}$ and
    $T_{\epsilon_2} \cong \epsilon$且$\epsilon \cong T_{\epsilon_2}$:
    subcase $T_{\epsilon_1} \cong \epsilon$且$\epsilon \cong T_{\epsilon_1}$
    and $\epsilon \cong T_{\epsilon_2}$:
    subcase $T_{\epsilon_1} \cong \epsilon$且$\epsilon \cong T_{\epsilon_1}$
    and $T_{\epsilon_2} \cong \epsilon$且$\epsilon \cong T_{\epsilon_2}$:
    These subcases imply the condition of
    $\epsilon \cong T_{\epsilon_1}$ \& $\epsilon \cong T_{\epsilon_2}$,
    which corresponds to above subcase.
    
    subcase $\epsilon \cong T_{\epsilon_1}$ and
    $T_{\epsilon_2} \cong \epsilon$:
    We have $\epsilon \wedge \epsilon \cong (T_{\epsilon_1} \wedge
    T_{\epsilon_2})^i = T$ by (Transparency-Cas-inter) and
    (Instantiation-inter), with application (Symmetry-inter) on
    $T_{\epsilon_2} \cong \epsilon$. On the other hand,
    $\epsilon \cong \epsilon \wedge \epsilon$成立 since
    applying (PhonyH-Cas-inter) on $\epsilon \cong \epsilon$, which comes
    from $\epsilon \equiv \epsilon$ with (Identity-inter), gives
    $\epsilon \wedge \epsilon \cong \epsilon$, then we eventually got
    $\epsilon \cong \epsilon \wedge \epsilon$ by (Symmetry-inter).
    From these facts, $\epsilon \cong \epsilon \wedge \epsilon$ and
    $\epsilon \wedge \epsilon \cong T$, we obtain $\epsilon \cong T$ by
    (Transitivity-inter).
    
    subcase $T_{\epsilon_1} \cong \epsilon$ and
    $\epsilon \cong T_{\epsilon_2}$:
    Proof for $T \simeq \epsilon$ in this case is similar to the subcase
    corresponding to $\epsilon \cong T_{\epsilon_1}$ \&
    $\epsilon \cong T_{\epsilon_2}$.
    
    subcase $T_{\epsilon_1} \cong \epsilon$ and
    $T_{\epsilon_2} \cong \epsilon$:
    Proof for $\epsilon \cong T$ in this case is similar to the subcase
    corresponding to $\epsilon \cong T_{\epsilon_1}$ \&
    $T_{\epsilon_2} \cong \epsilon$.
    
    subcase $T_{\epsilon_1} \cong \epsilon$ and
    $T_{\epsilon_2} \cong \epsilon$且$\epsilon \cong T_{\epsilon_2}$:
    subcase $T_{\epsilon_1} \cong \epsilon$且$\epsilon \cong T_{\epsilon_1}$
    and $T_{\epsilon_2} \cong \epsilon$:
    These subcases imply the condition of
    $T_{\epsilon_1} \cong \epsilon$ \& $T_{\epsilon_2} \cong \epsilon$,
    which corresponds to above subcase.
    
    Case $T_{\epsilon_1} \vee T_{\epsilon_2}$:
    Similar to the case of $T_{\epsilon_1} \wedge T_{\epsilon_2}$.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Claim} \label{claim2_for_equ_preserv}
  \[ T = T' \,\Rightarrow\, \exists t, \exists t'.\bigl[
      \mathcal{F}(t) \equiv T,\, \mathcal{F}(t') \equiv T'\
       \text{\it s.t.}\; t \simeq t' \bigr]
  \]
  \begin{Proof}
    Proof is induction on structure of derivation for $T = T'$.
    
    Case (Identity-inter): From def. of (Identity-inter), $T \equiv T'$.
    かつ$\mathcal{F}(t) \equiv T$ for some $t$, from Corollary
    \ref{existenz}. よって$T \equiv T'$より$\mathcal{F}(t) \equiv T'$.
    かつ $t \simeq t$, from (Identity).
    
    Case (Symmetry-inter): From def. of (Symmetry-inter), $T' = T$.
    Then, we can assume existences of some $t', t$ s.t.
    $\mathcal{F}(t') \equiv T'$, $\mathcal{F}(t) \equiv T$ and
    $t' \simeq t$, by I.H. よって $t \simeq t'$ from (Symmetry).
    
    Case (Transitivity-inter): $T = T'$, from prerequisite, then we can
    assume that there is some $T''$ s.t. $T = T''$ and $T'' = T'$,
    from (Transitivity-inter).
    ここで from I.H. $t,\, t''_1$ s.t. $\mathcal{F}(t) \equiv T$,
    $\mathcal{F}(t''_1) \equiv T''$ and $t \simeq t''_1$ および
    $t''_2,\, t'$ s.t. $\mathcal{F}(t''_2) \equiv T''$,
    $\mathcal{F}(t') \equiv T'$ and $t''_2 \simeq t'$なる
    $t, t''_1$と$t''_2, t'$が存在する.
    かつ$\mathcal{F}(t''_1) \equiv T'' \equiv \mathcal{F}(t''_2)$より
    $t''_1 \simeq t''_2$, from Claim \ref{equ_over_transduction}.
    よって$t \simeq t''_1$, $t''_1 \simeq t''_2$より$t_1 \simeq t''_2$,
    from (Transitivity). これと$t''_2 \simeq t'$より$t \simeq t'$, from
    (Transitivity), again.
    
    Case (Transparency-Cas-inter): $T = T'$, from prerequisite, then
    we can assume that there are the terms as $T_1 \wedge T_2$ s.t.
    $T \equiv T_1 \wedge T_2$ and $T'_1 \wedge T'_2$ s.t.
    $T' \equiv T'_1 \wedge T'_2$. よって we obtain $T_1 = T'_1$ and
    $T_2 = T'_2$,from (Transparency-Cas-inter).
    ここで from I.H. $t_1,\, t'_1$ s.t. $\mathcal{F}(t_1) \equiv T_1$,
    $\mathcal{F}(t'_1) \equiv T'_1$ and $t_1 \simeq t'_1$. および
    $t_2,\, t'_2$ s.t. $\mathcal{F}(t_2) \equiv T_2$,
    $\mathcal{F}(t'_2) \equiv T'_2$ and $t_2 \simeq t'_2$なる$t_1, t'_1$と
    $t_2, t'_2$ が存在する.
    よって$\mathcal{F}(t_1 \wedge t_2) \equiv
    \mathcal{F}(t_1) \wedge \mathcal{F}(t_2) \equiv T_1 \wedge T_2 \equiv T$
    and $\mathcal{F}(t'_1 \wedge t'_2) \equiv
    \mathcal{F}(t'_1) \wedge \mathcal{F}(t'_2) \equiv T'_1 \wedge T'_2
    \equiv T'$, from def. of $\mathcal{F}$.
    かつ$t_1 \simeq t'_1$ and $t_2 \simeq t'_2$より
    $t_1 \wedge t_2 \simeq t'_1 \wedge t'_2$, from (Transparency-Cas).
    
    Case (Transparency-Par-inter):
    Same way as the case of (Transparency-Cas-inter).
    
    Case (Associativity-Cas-inter): $T = T'$, from prerequisite, then
    there are some $T_1, T_2, T_3$ s.t $T = T_1 \wedge (T_2 \wedge T_3)$
    and $T' = (T_1 \wedge T_2) \wedge T_3$, from (Associativity-Cas-inter).
    ここで we let
    $T_4 \equiv T_2 \wedge T_3$として, $T = T_1 \wedge T_4$より
    $\mathcal{F}(t) \equiv T$, $\mathcal{F}(t''_1) \equiv T_1 \wedge T_4$
    and $t \simeq t''_1$, for some $t, t''_1$, by I.H.
    かつ $\mathcal{F}(t''_1) \equiv T_1 \wedge T_4$より
    $\mathcal{F}(t_1) \equiv T_1$, $\mathcal{F}(t_4) \equiv T_4$ and
    $t''_1 \simeq t_1 \wedge t_4$, for some $t_1, t_4$, from
    Corollary \ref{connectivity_preservation_Cat}.
    同様に$\mathcal{F}(t'_4) \equiv T_4 \equiv T_2 \wedge T_3$ for some
    $t'_4$, from Corollary \ref{existenz}, より
    $\mathcal{F}(t_2) \equiv T_2$, $\mathcal{F}(t_3) \equiv T_3$ and
    $t'_4 \simeq t_2 \wedge t_3$ for some $t_2, t_3$, by
    Corollary \ref{connectivity_preservation_Cat} again.
    また$\mathcal{F}(t_4) \equiv T_4 \equiv \mathcal{F}(t'_4)$より
    $t_4 \simeq t'_4$, from Claim \ref{equ_over_transduction}.
    これらより, まず$t_4 \simeq t'_4$ and $t'_4 \simeq t_2 \wedge t_3$より
    $t_4 \simeq t_2 \wedge t_3$, from (Transitivity). そして
    $t_1 \simeq t_1$, from (Identity), より
    $t_1 \wedge t_4 \simeq t_1 \wedge (t_2 \wedge t_3)$,
    from (Transparency-Cas). 一方$t \simeq t''_1$ and
    $t''_1 \simeq t_1 \wedge t_4$より$t \simeq t_1 \wedge t_4$, from
    (Transitivity). よって$t \simeq t_1 \wedge (t_2 \wedge t_3)$, from
    (Transitivity), again.
    同様に$T_5 \equiv T_1 \wedge T_2$として, $T' = T_5 \wedge T_3$より
    $\mathcal{F}(t') \equiv T'$, $\mathcal{F}(t''_2) \equiv T_5 \wedge T_3$
    and $t' \simeq t''_2$, for some $t', t''_2$, by I.H.
    かつ $\mathcal{F}(t''_2) \equiv T_5 \wedge T_3$より
    $\mathcal{F}(t_5) \equiv T_5$, $\mathcal{F}(t'_3) \equiv T_3$ and
    $t''_2 \simeq t_5 \wedge t'_3$, for some $t_5, t'_3$, from
    Corollary \ref{connectivity_preservation_Cat}. また
    $\mathcal{F}(t'_5) \equiv T_5 \equiv T_1 \wedge T_2$ for some $t'_5$,
    from Corollary \ref{existenz}, より
    $\mathcal{F}(t'_1) \equiv T_1$, $\mathcal{F}(t'_2) \equiv T_2$ and
    $t'_5 \simeq t'_1 \wedge t'_2$ for some $t'_1, t'_2$, by
    Corollary \ref{connectivity_preservation_Cat} again.
    かつ$\mathcal{F}(t_5) \equiv T_5 \equiv \mathcal{F}(t'_5)$より
    $t_5 \simeq t'_5$, from Claim \ref{equ_over_transduction}.
    これらより, まず$t_5 \simeq t'_5$ and $t'_5 \simeq t'_1 \wedge t'_2$より
    $t_5 \simeq t'_1 \wedge t'_2$, from (Transitivity). そして
    $t'_3 \simeq t'_3$, from (Identity), より
    $t_5 \wedge t'_3 \simeq (t'_1 \wedge t'_2) \wedge t'_3$,
    from (Transparency-Cas). 一方$t' \simeq t''_2$ and
    $t''_2 \simeq t_5 \wedge t'_3$より$t' \simeq t_5 \wedge t'_3$, from
    (Transitivity). よって$t' \simeq (t'_1 \wedge t'_2) \wedge t'_3$,
    also from (Transitivity).
    今$\mathcal{F}(t_1) \equiv T_1 \equiv \mathcal{F}(t'_1)$,
    $\mathcal{F}(t_2) \equiv T_2 \equiv \mathcal{F}(t'_2)$,
    $\mathcal{F}(t_3) \equiv T_3 \equiv \mathcal{F}(t'_3)$より
    $t_1 \simeq t'_1$, $t_2 \simeq t'_2$, $t_3 \simeq t'_3$,
    from Claim \ref{equ_over_transduction} for each. よって
    $t_1 \simeq t'_1$ and $t_2 \simeq t'_2$より$t'_1 \wedge t'_2 \simeq
    t_1 \wedge t_2$, from (Transparency-Cas) and (Symmetry). これと
    $t'_3 \simeq t_3$, from (Symmetry), より
    $(t'_1 \wedge t'_2) \wedge t'_3 \simeq (t_1 \wedge t_2) \wedge t_3$,
    from (Transparency-Cas).
    よって$t' \simeq (t'_1 \wedge t'_2) \wedge t'_3$より
    $t' \simeq (t_1 \wedge t_2) \wedge t_3$, from (Transitivity).
    故に$t \simeq t'$, from (Associativity-Cas), for
    $t \simeq t_1 \wedge (t_2 \wedge t_3)$ and
    $t' \simeq (t_1 \wedge t_2) \wedge t_3$.
    
    Case (Associativity-Par-inter):
    Same way as the case of (Associativity-Cas-inter).
    
    Case (RevealH-Cas-inter): $T = T'$, from prerequisite, then we obtain
    $\epsilon \wedge T = T'$, from (RevealH-Cas-inter).
    ここで$\epsilon \wedge T = T'$より
    $\mathcal{F}(t) \equiv \epsilon \wedge T$, $\mathcal{F}(t') \equiv T'$
    and $t \simeq t'$ for some $t, t'$, by I.H.
    また$\mathcal{F}(t) \equiv \epsilon \wedge T$より
    $\mathcal{F}(t_\epsilon) \equiv \epsilon$, $\mathcal{F}(t_1) \equiv T$
    and $t \simeq t_\epsilon \wedge t_1$ for some $t_\epsilon, t_1$,
    from Corollary \ref{connectivity_preservation_Cat}. かつ
    $\mathcal{F}(t_\epsilon) \equiv \epsilon \in \mathcal{E}$より
    $t_\epsilon \simeq \{\}$, from Lemma \ref{void_consistency}.
    これらより, まず$t_1 \simeq t_1$, from (Identity) および
    $t_\epsilon \simeq \{\}$より$t_\epsilon \wedge t_1 \simeq \{\} \wedge
    t_1$, from (Transparency-Cas). これと$t \simeq t_\epsilon \wedge t_1$
    より$t \simeq \{\} \wedge t_1$, from (Transitivity). かつ
    $t' \simeq t$, from (Symmetry), より$\{\} \wedge t_1 \simeq t'$, from
    (Transitivity) and (Symmetry). これより$t_1 \simeq t'$を得る,
    from (RevealH-Cas).
    
    Case (RevealT-Cas-inter): $T = T'$, from prerequisite, then we obtain
    $T \wedge \epsilon = T'$, from (RevealT-Cas-inter).
    ここで$T \wedge \epsilon = T'$より
    $\mathcal{F}(t) \equiv T \wedge \epsilon$, $\mathcal{F}(t') \equiv T'$
    and $t \simeq t'$ for some $t, t'$, by I.H.
    また$\mathcal{F}(t) \equiv T \wedge \epsilon$より
    $\mathcal{F}(t_1) \equiv T$, $\mathcal{F}(t_\epsilon) \equiv \epsilon$
    and $t \simeq t_1 \wedge t_\epsilon$ for some $t_1, t_\epsilon$,
    from Corollary \ref{connectivity_preservation_Cat}. かつ
    $\mathcal{F}(t_\epsilon) \equiv \epsilon \in \mathcal{E}$より
    $t_\epsilon \simeq \{\}$, from Lemma \ref{void_consistency}.
    これらより, まず$t_1 \simeq t_1$, from (Identity) および
    $t_\epsilon \simeq \{\}$より$t_1 \wedge t_\epsilon \simeq t_1 \wedge
    \{\}$, from (Transparency-Cas). これと$t \simeq t_1 \wedge t_\epsilon$
    より$t \simeq t_1 \wedge \{\}$, from (Transitivity). かつ
    $t' \simeq t$, from (Symmetry), より$t_1 \wedge \{\} \simeq t'$,
    from (Transitivity) and (Symmetry). これより$t_1 \simeq t'$を得る,
    from (RevealT-Cas).
    
    Case (RevealH-Par-inter), (RevealT-Par-inter):
    Same way as the case of (RevealH-Cas-inter) and (RevealT-Cas-inter)
    respectively.
    
    Case (PhonyH-Cas-inter): $T \equiv T'$, from prerequisite,
    We can assume existences of $T_1$ and $T'_1$
    s.t. $T \equiv \epsilon \wedge T_1$ and $T' \equiv T'_1$ that satisfy
    $\epsilon \wedge T_1 = T'_1$.
    Then we obtain $T_1 = T'_1$, from (PhonyH-Cas-inter), より
    $\mathcal{F}(t_1) \equiv T_1$,
    $\mathcal{F}(t'_1) \equiv T'_1$ and $t_1 \simeq t'_1$ for some
    $t_1, t'_1$, by I.H.
    また$\mathcal{F}(t) \equiv T \equiv \epsilon \wedge T_1$ for some $t$,
    from Corollary \ref{existenz}, より
    $\mathcal{F}(t_\epsilon) \equiv \epsilon$,
    $\mathcal{F}(t''_1) \equiv T_1$ and $t \simeq t_\epsilon \wedge t''_1$
    for some $t_\epsilon, t''_1$, from
    Corollary \ref{connectivity_preservation_Cat}. ここで
    $\mathcal{F}(t_\epsilon) \equiv \epsilon \in \mathcal{E}$より
    $t_\epsilon \simeq \{\}$, from Lemma \ref{void_consistency}.
    よって$\mathcal{F}(t''_1) \equiv T \equiv \mathcal{F}(t_1)$より
    $t_1 \simeq t''_1$, from Claim \ref{equ_over_transduction}.
    これらより, まず$t''_1 \simeq t_1$および$t_1 \simeq t'_1$より
    $t''_1 \simeq t'_1$, from (Transitivity). これと
    $t_\epsilon \simeq \{\}$より$t_\epsilon \wedge t''_1 \simeq \{\} \wedge
    t'_1$, from (Transparency-Cas). そして$t \simeq t_\epsilon \wedge t''_1$
    より$\{\} \wedge t'_1 \simeq t$, from (Transitivity) and
    (Symmetry), これより$t \simeq t'_1$を得る, from (RevealH-Cas) and
    (Symmetry).
    
    Case (PhonyT-Cas-inter): $T \equiv T'$, from prerequisite,
    we can assume existences of $T_1$ s.t.
    $T \equiv T_1 \wedge \epsilon$, and $T'_1$ s.t. $T' \equiv T'_1$, that
    also satisfy $T_1 \wedge \epsilon = T'_1$.
    Then we obtain $T_1 = T'_1$, from (PhonyT-Cas-inter), より
    $\mathcal{F}(t_1) \equiv T_1$, $\mathcal{F}(t'_1) \equiv T'_1$ and
    $t_1 \simeq t'_1$ for some $t_1, t'_1$, by I.H.
    また$\mathcal{F}(t) \equiv T \equiv T_1 \wedge \epsilon$ for some $t$,
    from Corollary \ref{existenz}, より$\mathcal{F}(t''_1) \equiv T_1$,
    $\mathcal{F}(t_\epsilon) \equiv \epsilon$
    and $t \simeq t''_1 \wedge t_\epsilon $ for some $t''_1, t_\epsilon$,
    from Corollary \ref{connectivity_preservation_Cat}. ここで
    $\mathcal{F}(t_\epsilon) \equiv \epsilon \in \mathcal{E}$より
    $t_\epsilon \simeq \{\}$, from Lemma \ref{void_consistency}.
    よって$\mathcal{F}(t''_1) \equiv T_1 \equiv \mathcal{F}(t_1)$より
    $t''_1 \simeq t_1$, from Claim \ref{equ_over_transduction}.
    これらより, まず$t''_1 \simeq t_1$および$t_1 \simeq t'_1$より
    $t''_1 \simeq t'_1$, from (Transitivity).
    これと$t_\epsilon \simeq \{\}$より
    $t''_1 \wedge t_\epsilon \simeq t'_1 \wedge \{\}$, from
    (Transparency-Cas). これと$t \simeq t''_1 \wedge t_\epsilon$
    より$t'_1 \wedge \{\} \simeq t$を得, from (Transitivity) and
    (Symmetry), これより$t \simeq t'_1$を得る, from
    (RevealT-Cas) and (Symmetry).
    
    Case (PhonyH-Par-inter), (PhonyT-Par-inter):
    Same way as the case of (PhonyH-Cas-inter) and (PhonyT-Cas-inter)
    respectively.
    
    Case (Strip-L-inter): $T = T'$, from prerequisite, we can assume
    exsistences of $T^\leftarrow_1$ s.t. $T \equiv T^\leftarrow_1$,
    and $T'_1$ s.t. $T' \equiv T'_1$, that also satisfy
    $T^\leftarrow_1 = T'_1$.
    Then we obtain $T_1 = T'_1$, from (Strip-L-inter) より,
    $\mathcal{F}(t_1) \equiv T_1$, $\mathcal{F}(t'_1) \equiv T'_1$ and
    $t_1 \simeq t'_1$, for some $t_1, t'_1$, by I.H.
    よって from def. of $\mathcal{F}$,
    $\mathcal{F}(t^\leftarrow_1) \equiv \mathcal{F}(t_1)^\leftarrow \equiv
    T_1 \equiv T$. かつ $t^\leftarrow_1 \simeq t'_1$, from (Strip-L).
    
    Case (Strip-R-inter): Same way as the case of (Strip-L-inter).
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Lemma}{equivalence preservation} \label{equivalence_preservation}
  \[ t \simeq t' \,\Leftrightarrow\, \mathcal{F}(t) = \mathcal{F}(t') \]
  \begin{Proof}
    Proof is induction on derivation for $t \simeq t'$,
    and simply from Claim \ref{equ_over_transduction}
    および\ref{claim2_for_equ_preserv}.
    
    $(\Rightarrow)$: Case (Identity): Now we can assume $t \equiv t'$, from
    def. of (Identity). Then $\mathcal{F}(t) \equiv \mathcal{F}(t')$ より
    $\mathcal{F}(t) = \mathcal{F}(t')$, by (Identity-inter).
    
    Case (Symmetry): 前提$t \simeq t'$より$t' \simeq t$, from def. of
    (Symmetry). Then $\mathcal{F}(t') = \mathcal{F}(t)$, by I.H. よって
    $\mathcal{F}(t) = \mathcal{F}(t')$, from (Symmetry-inter).
    
    Case (Transitivity): 前提$t \simeq t'$より we can assume the existences
    of $t''$ s.t. $t \simeq t''$ and $t'' \simeq t'$,
    from def. of (Transitivity).
    Then, $\mathcal{F}(t) = \mathcal{F}(t'')$ and
    $\mathcal{F}(t'') = \mathcal{F}(t')$, both are by I.H.
    よって$\mathcal{F}(t) = \mathcal{F}(t')$, from (Transitivity-inter).
    
    Case (Transparency-Cas): 前提$t \simeq t'$より we can assume that
    $t_1 \wedge t_2 \simeq t'_1 \wedge t'_2$ s.t.
    $t \equiv t_1 \wedge t_2$ and $t' \equiv t'_1 \wedge t'_2$.
    かつ$t_1 \simeq t'_1$ and $t_2 \simeq t'_2$, all are from
    def. of (Trasnsparency-Cas).
    よって$\mathcal{F}(t_1) = \mathcal{F}(t'_1)$ and
    $\mathcal{F}(t_2) = \mathcal{F}(t'_2)$, both are by I.H. より
    $\mathcal{F}(t_1) \wedge \mathcal{F}(t_2)$ =
    $\mathcal{F}(t'_1) \wedge \mathcal{F}(t'_2)$,
    from (Transparency-Cas-inter).
    ここで from def. of $\mathcal{F}$, $\mathcal{F}(t) \equiv
    \mathcal{F}(t_1 \wedge t_2) \equiv \mathcal{F}(t_1) \wedge
    \mathcal{F}(t_2)$および
    $\mathcal{F}(t') \equiv \mathcal{F}(t'_1 \wedge t'_2) \equiv
    \mathcal{F}(t'_1) \wedge \mathcal{F}(t'_2)$.
    ゆえに$\mathcal{F}(t) = \mathcal{F}(t')$.
    
    Case (Transparency-Para): Same way as the case of (Transparency-Cas).
    
    Case (Associativity-Cas): 前提$t \simeq t'$より we can assume
    the existences of $t_1,\, t_2,\, t_3$ s.t.
    $t \simeq t_1 \wedge (t_2 \wedge t_3)$ and
    $t' \simeq (t_1 \wedge t_2) \wedge t_3$,
    from def. of (Associativity-Cas).
    Then, $\mathcal{F}(t) = \mathcal{F}\bigl(t_1 \wedge (t_2 \wedge t_3)
    \bigr)$ and $\mathcal{F}(t') = \mathcal{F}\bigl((t_1 \wedge t_2)
    \wedge t_3 \bigr)$, both are by I.H.
    ここで$\mathcal{F}\bigl(t_1 \wedge (t_2 \wedge t_3) \bigr) \equiv
    \mathcal{F}(t_1) \wedge \mathcal{F}(t_2 \wedge t_3) \equiv
    \mathcal{F}(t_1) \wedge \bigl(\mathcal{F}(t_2) \wedge \mathcal{F}(t_3)
    \bigr)$であり,
    同様に$\mathcal{F}\bigl((t_1 \wedge t_2) \wedge t_3 \bigr) \equiv
    \mathcal{F}(t_1 \wedge t_2) \wedge \mathcal{F}(t_3) \equiv
    \bigl(\mathcal{F}(t_1) \wedge \mathcal{F}(t_2) \bigr) \wedge
    \mathcal{F}(t_3)$, from def. of $\mathcal{F}$. よって
    $\mathcal{F}(t) = \mathcal{F}(t_1) \wedge \bigl(\mathcal{F}(t_2)
    \wedge \mathcal{F}(t_3) \bigr)$,
    $\mathcal{F}(t') = \bigl(\mathcal{F}(t_1) \wedge \mathcal{F}(t_2)
    \bigr) \wedge \mathcal{F}(t_3)$より$\mathcal{F}(t) = \mathcal{F}(t')$,
    from (Associativity-Cas-inter).
    
    Case (Associativity-Par): Same way as the case of (Associativity-Cas).
    
    Case $(\text{\it Associativity-Cat0}_1)$: 前提$t \simeq t'$より,
    we can let $t \equiv t_1$ and $t' \equiv \{t_1\}$, from
    def. of $(\text{\it Associativity-Cat0}_1)$.
    ここで$\mathcal{F}(t) \equiv \mathcal{F}(t_1)$,
    from def. of $\mathcal{F}$, より
    $\mathcal{F}(t) = \mathcal{F}(t_1)$, by (Identity-inter).
    同様に$\mathcal{F}(t') \equiv \mathcal{F}\bigl(\{t_1 \} \bigr) \equiv
    \mathcal{F}(t_1)$, from def. of $\mathcal{F}$, より
    $\mathcal{F}(t_1) = \mathcal{F}(t')$, from (Identity-inter) and
    (Symmetry). よって$\mathcal{F}(t) = \mathcal{F}(t')$, from
    (Transitivity-inter).
    
    Case $(\text{\it Associativity-Cat0}_n)$: 前提$t \simeq t'$より,
    we can let $t \equiv t_1 \wedge \{t_2 \cdots t_n \}$ and
    $t' \equiv \{t_1 \cdots t_n \}$ where $n \ge 2$, from
    def. of $(\text{\it Associativity-Cat0}_n)$.
    ここで$\mathcal{F}(t) \equiv \mathcal{F}\bigl(t_1 \wedge
    \{t_2 \cdots t_n\} \bigr) \equiv \mathcal{F}(t_1) \wedge
    \mathcal{F}\bigl(\{t_2 \cdots t_n \} \bigr)$, from
    def. of $\mathcal{F}$, より
    $\mathcal{F}(t) \equiv \mathcal{F}(t_1) \wedge
    \mathcal{F}\bigl(\{t_2 \cdots t_n\} \bigr)$, from (Identity-inter).
    同様に$\mathcal{F}(t') \equiv \mathcal{F}\bigl(\{t_1 \cdots t_n \}
    \bigr) \equiv \mathcal{F}(t_1) \wedge
    \mathcal{F}\bigl(\{t_2 \cdots t_n \} \bigr)$, from
    def. of $\mathcal{F}$, より
    $\mathcal{F}(t_1) \wedge \mathcal{F}\bigl(\{t_2 \cdots t_n\}
    \bigr) = \mathcal{F}(t')$, from (Identity-inter) and (Symmetry).
    よって$\mathcal{F}(t) = \mathcal{F}(t')$, from (Transitivity-inter).
    
    Case $(\text{\it Associativity-Cat1}_1)$: Same way as the case of
    $(\text{\it Associativity-Cat0}_1)$.
    
    Case $(\text{\it Associativity-Cat1}_n)$: Same way as the case of
    $(\text{\it Associativity-Cat0}_n)$.
    
    Case $(\text{\it Associativity-Dup}_1)$: Same way as the case of
    $(\text{\it Associativity-Cat1}_1)$.
    
    Case $(\text{\it Associativity-Dup}_n)$: Same way as the case of
    $(\text{\it Associativity-Cat1}_n)$.
    
    Case (RevealH-Cas): 前提$t \simeq t'$より we can assume that
    $\{\} \wedge t \simeq t'$, from def. of (RevealH-Cas).
    Then, $\mathcal{F}\bigl(\{\} \wedge t \bigr) = \mathcal{F}(t')$,
    by I.H.
    また$\mathcal{F}\bigl(\{\} \wedge t \bigr) \equiv \mathcal{F}\bigl(
    \{\} \bigr) \wedge \mathcal{F}(t) \equiv
    \epsilon \wedge \mathcal{F}(t)$, from def. of $\mathcal{F}$.
    よって$\epsilon \wedge \mathcal{F}(t) = \mathcal{F}(t')$. ゆえに
    $\mathcal{F}(t) = \mathcal{F}(t')$, from (RevealH-Cas-inter).
    
    Case (RevealT-Cas): 前提$t \simeq t'$より we can assume that
    $t \wedge \{\} \simeq t'$, from def. of (RevealT-Cas).
    Then, $\mathcal{F}\bigl(t \wedge \{\} \bigr) = \mathcal{F}(t')$,
    by I.H.
    また$\mathcal{F}\bigl(t \wedge \{\} \bigr) \equiv \mathcal{F}\bigl(t)
    \wedge \mathcal{F}\bigl(\{\} \bigr) \equiv
    \mathcal{F}(t) \wedge \epsilon$, from def. of $\mathcal{F}$.
    よって$\mathcal{F}(t) \wedge \epsilon = \mathcal{F}(t')$. ゆえに
    $\mathcal{F}(t) = \mathcal{F}(t')$, from (RevealT-Cas-inter).
    
    Case (RevealH-Par): Same way as the case of (RevealH-Cas).
    
    Case (RevealT-Para): Same way as the case of (RevealT-Cas).
    
    Case (PhonyH-Cas): 前提$t \simeq t'$より
    we can let $t \equiv \{\} \wedge t_1$ and $t' \equiv t'_1$, s.t.
    $\{\} \wedge t_1 \simeq t'_1$.
    Then, $t_1 \simeq t'_1$, from def. of (PhonyH-Cas), より
    $\mathcal{F}(t_1) = \mathcal{F}(t'_1)$ by I.H. よって
    $\epsilon \wedge \mathcal{F}(t_1) = \mathcal{F}(t'_1) \equiv
    \mathcal{F}(t')$, from (PhonyH-Cas-inter). 故に
    $\mathcal{F}(t) \equiv \mathcal{F}\bigl(\{\} \wedge t_1 \bigr) \equiv
    \mathcal{F}\bigl(\{\} \bigr) \wedge \mathcal{F}(t_1) \equiv
    \epsilon \wedge \mathcal{F}(t_1) = \mathcal{F}(t'_1) \equiv
    \mathcal{F}(t')$, from def. of $\mathcal{F}$.
    
    Case (PhonyT-Cas): 前提$t \simeq t'$より
    we can let $t \equiv t_1 \wedge \{\}$ and $t' \equiv t'_1$, s.t.
    $t_1 \wedge \{\} \simeq t'_1$.
    Then $t_1 \simeq t'_1$, from def. of (PhonyT-Cas), より
    $\mathcal{F}(t_1) = \mathcal{F}(t'_1)$, by I.H. よって
    $\mathcal{F}(t_1) \wedge \epsilon = \mathcal{F}(t'_1) \equiv
    \mathcal{F}(t')$, from (PhonyT-Cas-inter). 故に
    $\mathcal{F}(t) \equiv \mathcal{F}\bigl(t_1 \wedge \{\} \bigr) \equiv
    \mathcal{F}(t_1) \wedge \mathcal{F}\bigl(\{\} \bigr) \equiv
    \mathcal{F}(t_1) \wedge \epsilon = \mathcal{F}(t'_1) \equiv
    \mathcal{F}(t')$, from def. of $\mathcal{F}$.
    
    Case (PhonyH-Par): Same way as the case of (PhonyH-Cas).
    
    Case (PhonyT-Par): Same way as the case of (PhonyT-Cas).
    
    Case (Strip-L): 前提$t \simeq t'$より, we can let
    $t \equiv t^\leftarrow_1$ and $t' \equiv t'_1$, s.t.
    $t^\leftarrow_1 \simeq t'_1$.
    Then $t_1 \simeq t'_1$, from def. of (Strip-L), より
    $\mathcal{F}(t_1) = \mathcal{F}(t'_1)$ by I.H.
    よって${\mathcal{F}(t_1)}^\leftarrow = \mathcal{F}(t'_1) \equiv
    \mathcal{F}(t')$, from (Strip-L-inter). 故に
    $\mathcal{F}(t) \equiv \mathcal{F}(t^\leftarrow_1) \equiv
    {\mathcal{F}(t_1)}^\leftarrow = \mathcal{F}(t'_1) \equiv
    \mathcal{F}(t')$,
    from def. of $\mathcal{F}$.
    
    Case (Strip-R): Same way as the case of (Strip-L).
    
    $(\Leftarrow)$: $\mathcal{F}(t) = \mathcal{F}(t')$,
    from prerequisite, we can assume the the existences of $t_1$ and $t'_1$,
    which satisfy $\mathcal{F}(t_1) \equiv \mathcal{F}(t)$,
    $\mathcal{F}(t'_1) \equiv \mathcal{F}(t')$ and $t_1 \simeq t'_1$,
    by Claim \ref{claim2_for_equ_preserv}.
    Then, we obtain $t_1 \simeq t$ for $\mathcal{F}(t_1) \equiv
    \mathcal{F}(t)$, and $t'_1 \simeq t'$ for
    $\mathcal{F}(t'_1) \equiv \mathcal{F}(t')$, both are from
    Claim \ref{equ_over_transduction}. よって$t_1 \simeq t'_1$より
    $t \simeq t'_1$, from (Symmetry) and (Transitivity). 故に$t \simeq t'$,
    from (Transitivity) again.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Lemma}{nil compatibility} \label{}
  \[ t \simeq \{\} \,\Leftrightarrow\, \mathcal{F}(t) \in \mathcal{E}
  \]
  \begin{Proof}
    Proof is straightforward from Lemma \ref{membership_on_phony_terms},
    \ref{equivalence_preservation} and \ref{void_consistency}.
    for ($\Rightarrow$) and ($\Leftarrow$) respectively.
    
    ($\Rightarrow$):
    $t \simeq \{\} \Rightarrow \mathcal{F}(t) = \mathcal{F}\bigl(\{\}
    \bigr)$, from Lemma \ref{equivalence_preservation},
    and $\mathcal{F}\bigl(\{\} \bigr) \equiv \epsilon$, from
    def. of $\mathcal{F}$. Then $\mathcal{F}(t) \in \mathcal{E}$, from
    Lemma \ref{membership_on_phony_terms}.
    
    ($\Leftarrow$):
    Directly from Lemma \ref{void_consistency}, we obtain
    $\mathcal{F}(t) \in \mathcal{E} \Rightarrow t \simeq \{\}$.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Definition}{項形式逆変換(TERM DISTRANSDUCER)}
\label{term_distranceducer}
  項形式逆変換$\mathcal{F}^{-1}: T \rightarrow t$を以下のように定義する.
  \begin{displaymath}
    \begin{array}{rll}
      \mathcal{F}^{-1}(T) &\stackrel{\mathrm{def}}{:=} &T \quad
       \text{\it if}\;\; T \cong t_0\ \text{\it s.t.}\ (t_0, \mathcal{R}_0)
        \!\in\! \Gamma_{gnd}  \\
      
      \mathcal{F}^{-1}(T) &\stackrel{\mathrm{def}}{:=} &T \quad
       \text{\it if}\;\; T \cong t_1\ \text{\it s.t.}\ (t_1, \mathcal{R}_1)
        \!\in\! \Gamma_{def}  \\
      
      \mathcal{F}^{-1}(T \wedge \bot)  &\stackrel{\mathrm{def}}{:=}
      &\left\{\begin{array}[c]{ll}
        {\{\}}^{\mathpzc{id}(\epsilon)}
        & \text{\it if}\;\; \mathpzc{id}(T \wedge \bot) = \mathpzc{id}(T),\
           T = \epsilon  \\
        {\bigl\{\mathcal{F}^{-1}(T) \bigr\}}^{\mathpzc{id}(T \wedge
         \bot)}
        & \text{\it otherwize}
      \end{array} \right.  \\
      
      \mathcal{F}^{-1}(\bot \wedge T)  &\stackrel{\mathrm{def}}{:=}
      & {\bigl[\mathcal{F}^{-1}(T) \bigr]}^{\mathpzc{id}(\bot \wedge T)} \\
      
      \mathcal{F}^{-1}(T_1 \wedge T_2) &\stackrel{\mathrm{def}}{:=}
      &\left\{\begin{array}[c]{ll}
         {\bigl\{\mathcal{F}^{-1}(T_1), t_2 \cdots t_n \bigr\}}^j
          & \!\!\! \begin{array}[t]{l}
            \text{\it if}\;\; \mathpzc{id}(T_1 \wedge T_2) =
             \mathpzc{id}(T_2) \\
            \text{\it where}\ {\{t_2 \cdots t_n \}}^j =
             \mathcal{F}^{-1}(T_2)
          \end{array}  \\
         {\bigl[\mathcal{F}^{-1}(T_2), t_2 \cdots t_n \bigr]}^j\
          & \!\!\! \begin{array}[t]{l}
            \text{\it if}\;\; \mathpzc{id}(T_1 \wedge T_2) =
             \mathpzc{id}(T_1) \\
            \text{\it where}\ {[t_2 \cdots t_n ]}^j =
             \mathcal{F}^{-1}(T_1)  \\ 
          \end{array}  \\
         {\bigl(\mathcal{F}^{-1}(T_1) \wedge
          \mathcal{F}^{-1}(T_2) \bigr)}^{\mathpzc{id}(T_1 \wedge T_2)}
         & \text{\it if}\;\; \mathpzc{id}(T_1 \wedge T_2) \neq
             \mathpzc{id}(T_1), \mathpzc{id}(T_2)
       \end{array} \right.  \\
      
      \mathcal{F}^{-1}(\bot \vee T)  &\stackrel{\mathrm{def}}{:=}
      & {\bigl\langle \mathcal{F}^{-1}(T) \bigr\rangle}^{\mathpzc{id}(
         \bot \vee T)} \\
      
      \mathcal{F}^{-1}(T_1 \vee T_2) &\stackrel{\mathrm{def}}{:=}
      &\left\{\begin{array}[c]{ll}
         {\bigl\langle \mathcal{F}^{-1}(T_2), t_2 \cdots
          t_n \bigr\rangle}^j\
         & \!\!\! \begin{array}[t]{l}
            \text{\it if}\;\; \mathpzc{id}(T_1 \wedge T_2) =
             \mathpzc{id}(T_1) \\
            \text{\it where}\ {\langle t_2 \cdots t_n \rangle}^j =
             \mathcal{F}^{-1}(T_1)  \\ 
          \end{array}  \\
         {\bigl(\mathcal{F}^{-1}(T_1) \vee
          \mathcal{F}^{-1}(T_2) \bigr)}^{\mathpzc{id}(T_1 \vee T_2)}
         & \text{\it if}\;\; \mathpzc{id}(T_1 \vee T_2) \neq
            \mathpzc{id}(T_1) 
       \end{array} \right.  \\
      
      \mathcal{F}^{-1}({T_1}^?)  &  \stackrel{\mathrm{def}}{:=}
      & {\bigl({\mathcal{F}^{-1}(T_1)}^? \bigr)}^{\mathpzc{id}({T_1}^?)} \\
      
      \mathcal{F}^{-1}({T_1}^\leftarrow)  &  \stackrel{\mathrm{def}}{:=}
      & {\bigl({\mathcal{F}^{-1}(T_1)}^\leftarrow \bigr)}^{\mathpzc{id}(
         {T_1}^\leftarrow)}  \\
      
      \mathcal{F}^{-1}({T_1}^\rightarrow)  &  \stackrel{\mathrm{def}}{:=}
      & {\bigl({\mathcal{F}^{-1}(T_1)}^\rightarrow \bigr)}^{\mathpzc{id}(
         {T_1}^\rightarrow)}  \\
      
      \mathcal{F}^{-1}(\epsilon)
      & \stackrel{\mathrm{def}}{:=}  &  \circ^{\mathpzc{id}(\epsilon)}
    \end{array}
  \end{displaymath}
\end{Definition}

\begin{Lemma}{regressiveness over transduction}
\label{regressiveness_over_transduction}
  \[ \mathcal{F}^{-1}\bigl(\mathcal{F}(t) \bigr) \simeq t
  \]
  \begin{Proof}
    Proof is induction on structure of t.
    
    Case $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$:
    Trivially O.K. from def. of $\mathcal{F}$ and $\mathcal{F}^{-1}$.
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_0) \bigr) =
    \mathcal{F}^{-1}(t_0) = t_0$. Then we have
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_0) \bigr) \simeq t_0$ by
    (Identity), since
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_0) \bigr) = t_0 \equiv t_0$ holds
    from lemma \ref{grandterm_equivalence}.
    
    Case $t_1$ where $(t_1, \mathcal{R}_1) \in \Gamma_{def}$:
    Similar to the case of
    $t_0$ where $(t_0, \mathcal{R}_0) \in \Gamma_{gnd}$.
    
    Case $t_1 \wedge t_2$:
    By I.H. we have
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \simeq t_1$ and
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \simeq t_2$.
    According to these facts,
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \wedge
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \simeq t_1 \wedge t_2$
    holds from (Transparency-Cas), then we have
    $(t_1 \wedge t_2)^{\mathpzc{id}(t_1 \wedge t_2)} \simeq
    {\Bigl(\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \wedge
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr)}^{\mathpzc{id}(
    t_1 \wedge t_2)}$ by applying twice (Instantiation)s on r.h.s and l.h.s
    with (Symmetry), and finally we obtain
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1 \wedge t_2) \bigr) =
    {\Bigl(\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \wedge
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr)}^{\mathpzc{id}(
    t_1 \wedge t_2)}$
    $\simeq {(t_1 \wedge t_2)}^{\mathpzc{id}(t_1 \wedge t_2)}$ by (Symmetry)
    again, for $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1 \wedge t_2) \bigr) = 
    \mathcal{F}^{-1}\Bigl({\bigl(\mathcal{F}(t_1) \wedge \mathcal{F}(t_2)
    \bigr)}^{\mathpzc{id}(t_1 \wedge t_2)} \Bigr) =
    {\Bigl(\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \wedge
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr)}^{\mathpzc{id}(
    t_1 \wedge t_2)}$ from def. of $\mathcal{F}$ \& $\mathcal{F}^{-1}$.
    
    Case $t_1 \vee t_2$: Similar to the case of $t_1 \wedge t_2$.
    
    Case $\{\}$:
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{\} \bigr) \Bigr) =
    \mathpzc{F}^{-1}\Bigl(\bigl(\epsilon^{\mathpzc{id}(\{\})} \wedge \bot
    \bigr)^{\mathpzc{id}(\{\})} \Bigr) =
    {\{\}}^{\mathpzc{id}(\{\})}$ holds from def. of
    $\mathcal{F}$ and $\mathcal{F}^{-1}$. Then we found that
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{\} \bigr) \Bigr) \simeq \{\}$
    because of $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{\} \bigr) \Bigr) =
    \{\} \equiv \{\}$ from lemma \ref{identity_on_structual_equivalence}
    with (Identity).

    Case $\{t_1, t_2\}$:
    In this case, we have a fact that
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1, t_2\} \bigr) \Bigr) =
    {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\}}^j$ where
    $j = \mathpzc{id}\bigl(\{t_1, t_2\} \bigr)$, since
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1, t_2\} \bigr) \Bigr) =
    \mathcal{F}^{-1}\biggl({\Bigl(\mathpzc{F}(t_1) \wedge \mathpzc{F}\bigl(
    {\{t_2\}}^j \bigr) \Bigr)}^j \biggr) =
    \mathcal{F}^{-1}\biggl(\Bigl(\mathcal{F}(t_1) \wedge $
    ${{\bigl(\mathcal{F}(t_2) \wedge \bot \bigr)}^j \Bigr)}^j \biggr) =
    {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\}}^j$ for
    $\mathcal{F}^{-1}\Bigl({\bigl(\mathcal{F}(t_2) \wedge \bot \bigr)}^j
    \Bigr) = {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr)
    \Bigr\}}^j$. Now taking that into account, we can derive
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1, t_2\} \bigr) \Bigr) =
    {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\}}^j \simeq       
    {\{t_1, t_2 \}}^j$ as below.
    From the fact that $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \simeq
    t_2$, which we obtain by I.H. we have
    $\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\} \simeq
    \{t_2\}$ by applying (Associativity-$\text{\it Cat0}_1$) \& (Symmetry)
    on its r.h.s and l.h.s. for each, then we eventually found that
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \wedge \Bigl\{
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\} \simeq
    t_1 \wedge \{t_2\}$ holds from (Transparency-Cas) because of
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \simeq t_1$ which also
    comes from I.H. And we may get
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \wedge
    \Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\} \simeq
    \{t_1, t_2 \}$ by (AssociativityH-$\text{\it Cat0}_\infty$), from which
    we may instantiate r.h.s appropriately as
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \wedge
    \Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\} \simeq
    {\{t_1, t_2\}}^j$ with (Instantiation). Consequently, after applying
    (Symmetry) which yields ${\{t_1, t_2\}}^j \simeq \Bigl\{
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\}$, we can proceed
    to derive ${\{t_1, t_2\}}^j \simeq {\Bigl\{\mathcal{F}^{-1}\bigl(
    \mathcal{F}(t_1) \bigr), \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr)
    \Bigr\}}^j$ by (AssociativityH-$\text{\it Cat0}_\infty$) and
    (Instantiation) according to similar scheme above.
    Then we are now in the position to find that
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1, t_2\} \bigr) \Bigr) =
    {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \Bigr\}}^j \simeq
    {\{t_1, t_2\}}^j$ after applying (Symmetry).
    
    Case $\{t_1 \cdots t_n\}$, $n \ge 3$:
    We first show that
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1 \cdots t_n\} \bigr) \Bigr)
    = \Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr)$
    ${\cdots \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\}}^j$ where
    $j = \mathpzc{id}\bigl(\{t_1 \cdots t_n\} \bigr)$, from def. of
    $\mathcal{F}$ and $\mathcal{F}^{-1}$ as follows,
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1 \cdots t_n\}$
    $\bigr) \Bigr) =
    \mathcal{F}^{-1}\biggl({\Bigl(\mathcal{F}(t_1) \wedge
    \mathcal{F}\bigl({\{t_2 \cdots t_n\}}^j \bigr) \Bigr)}^j \biggr) =
    {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \cdots
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\}}^j$ since
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl({\{t_1 \cdots t_n \}}^j \bigr)
    \Bigr) =
    {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \cdots
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\}}^j$ from claim
    \ref{regressiveness_over_transduction_claim}.
    Then we proceed to show that
    $\Bigr\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_{n-1}) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\} \simeq
    \{t_{n-1}, t_n\}$. Beginnig by the fact that
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \simeq t_n$, which
    comes from I.H. we can derive
    $\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\} \simeq
    \{t_n\}$ by applying (Associativity-$\text{\it Cat0}_1$) on both l.h.s.
    and r.h.s. using (Symmetry). According to the fact that
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_{n-1}) \bigr) \simeq t_{n-1}$ also
    holds by I.H. we have a construction of
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_{n-1}) \bigr) \wedge \Bigl\{
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\} \simeq
    t_{n-1} \wedge \{t_n\}$ by (Transparency-Cas), on which we can derive
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_{n-1}) \bigr) \wedge
    \bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\} \simeq
    \{t_{n-1}, t_n\}$ by applying
    (AssociativityH-$\text{\it Cat0}_\infty$). By similar scheme above,
    we may have $\Bigr\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_{n-1}) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\} \simeq
    \{t_{n-1}, t_n\}$, on which we can obtain that
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_{n-2}) \bigr) \wedge
    {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_{n-1}) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\}} \simeq
    t_{n-2} \wedge \{t_{n-1}, t_n\}$ by applying (Transparency-Cas), since
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_{n-2}) \bigr) \simeq t_{n-2}$ holds
    by I.H. (note that any of $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_j) \bigr)
    \simeq t_j$, $1 \le j \le n$ hold by I.H.).
    We continue to construct in this fashion, we can conclude that
    $\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \cdots
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\} \simeq
    \{t_1 \cdots t_n \}$ holds. Eventually it's time to show that
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1 \cdots t_n \} \bigr)
    \Bigr) = {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \cdots
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\}}^j \simeq
    {\{t_1 \cdots t_n \}}^j$ by applying (Instantiation) and (Symmetry) on
    $\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \cdots
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\} \simeq
    \{t_1 \cdots t_n \}$ to attach appropriate indexes on both r.h.s and
    l.h.s.
    
    Case $[t_1 \cdots t_n]$: Similar to the case of $\{t_1 \cdots t_n\}$.
    
    Case $\langle t_1 \cdots t_n \rangle$:
    Similar to the case of $[t_1 \cdots t_n]$.
    
    Case $\circ$:
    This case is trivial from def. of $\mathcal{F}$ and $\mathcal{F}^{-1}$
    as below.
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(\circ) \bigr) =
    \mathcal{F}^{-1}\bigl(\epsilon^{\mathpzc{id}(\circ)} \bigr) =
    {\circ}^{\mathpzc{id}(\circ)}$, then
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(\circ) \bigr) \simeq \circ$ holds
    from lemma \ref{identity_on_structual_equivalence}.
    
    Case ${t_1}^?$:
    We begin by the fact that
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \simeq t_1$ holds
    from I.H. then we have
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \simeq {{t_1}^?}^j$
    where $j = \mathpzc{id}\bigl({t_1}^? \bigr)$ by applying
    (Optional) and (Instantiation) on that.
    Consequently, we can obtain that ${{t_1}^?}^j \simeq
    {{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr)}^?}^j$ in this
    fashon, then we can conclude that
    $\mathcal{F}^{-1}\bigl(\mathcal{F}({t_1}^?) \bigr) =
    {\Bigl({\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr)}^? \Bigr)}^j
    \simeq {{t_1}^?}^j$ after applying (Symmtery), note that
    $\mathcal{F}^{-1}\Bigl({\mathcal{F}({t_1}^? )}^j \Bigr) =
    {\Bigl(\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1)^? \bigr) \Bigr)}^j$ holds
    from def. of $\mathcal{F}$ and $\mathcal{F}^{-1}$.  
    
    Case ${t_1}^\leftarrow$: Similar to the case of ${t_1}^?$.
    
    Case ${t_1}^\rightarrow$: Similar to the case of ${t_1}^\leftarrow$.
    $\Box$
  \end{Proof}
\end{Lemma}


\begin{Claim}
\label{regressiveness_over_transduction_claim}
  \[ \mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1 \cdots t_n\} \bigr)
      \Bigr) =
       {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \cdots
        \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\}}^j\
         \text{\it s.t.}\ j = \mathpzc{id}\bigl(\{t_1 \cdots t_n \} \bigr)
  \]
  \begin{Proof}
    Proof is simple induction on $n$ as num. of subterms $t_j$.

    B.C.) $n = 1$: Trivially O.K. directly from def. of
    $\mathcal{F}$ and $\mathcal{F}^{-1}$ as below.
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1\} \bigr) \Bigr) =
    \mathcal{F}^{-1}\Bigl({\bigl(\mathcal{F}(t_1) \wedge \bot \bigr)}^j
    \Bigr) = {\Big\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr)
    \Bigr\}}^j$ where $j = \mathpzc{id}\bigl(\{t_1\} \bigr)$.

    I.S.) $n \ge 2$: We begin by the fact that
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_2 \cdots t_n \} \bigr)
    \Bigr) = {\Bigr\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \cdots
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\}}^i$ where
    $i = \mathpzc{id}\bigl(\{t_2 \cdots t_n \} \bigr)$ by I.H.
    Taking that into account, we proceed to show that
    $\mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\{t_1 \cdots$
    $t_n \} \bigr) \Bigr) =
    \mathcal{F}^{-1}\biggl({\Bigl(\mathcal{F}(t_1) \wedge
    \mathcal{F}\bigl({\{t_2 \cdots t_n\}}^j \bigr) \Bigr)}^j \biggr) =
    {\Bigl\{\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr),
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_2) \bigr) \cdots
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\}}^j$ where
    $j = \mathpzc{id}\bigl(\{t_1 \cdots t_n \} \bigr)$ from
    def. of $\mathcal{F}$ and $\mathcal{F}^{-1}$.
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Claim}
  \[ \begin{array}{l}
       \mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl([t_1 \cdots t_n]\bigr)
        \Bigr) =
         {\Bigl[\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \cdots
          \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr]}^j\
           \text{\it s.t.}\ j = \mathpzc{id}\bigl([t_1 \cdots t_n ]
            \bigr)  \\
       [5pt]
       \mathcal{F}^{-1}\Bigl(\mathcal{F}\bigl(\langle t_1 \cdots t_n \rangle
        \bigr) \Bigr) =
         {\Bigl\langle\mathcal{F}^{-1}\bigl(\mathcal{F}(t_1) \bigr) \cdots
          \mathcal{F}^{-1}\bigl(\mathcal{F}(t_n) \bigr) \Bigr\rangle}^j\
           \text{\it s.t.}\ j =
            \mathpzc{id}\bigl(\langle t_1 \cdots t_n \rangle \bigr)
     \end{array}
  \]
  \begin{Proof}
    Proof is similar to claim \ref{regressiveness_over_transduction_claim}
    as above.
    $\Box$
  \end{Proof}
\end{Claim}


\begin{Claim}{equivalence over transduction} \label{equ_over_transduction}
  \[ \mathcal{F}(t) \equiv \mathcal{F}(t') \,\Rightarrow\, t \simeq t'
  \]
  \begin{Proof}
    From Lemma \ref{regressiveness_over_transduction},
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t) \bigr) \simeq t$.
    And $\mathcal{F}^{-1}\bigl(\mathcal{F}(t) \bigr) \simeq
    \mathcal{F}^{-1}\bigl(\mathcal{F}(t') \bigr)$, by (Identity), for
    $\mathcal{F}(t) \equiv \mathcal{F}(t')$.
    Then, $t \simeq \mathcal{F}^{-1}\bigl(\mathcal{F}(t') \bigr)$, from
    (Transitivity) and (Symmetry). かつ
    $\mathcal{F}^{-1}\bigl(\mathcal{F}(t') \bigr) \simeq t'$, from
    Lemma \ref{regressiveness_over_transduction} again, より $t \simeq t'$, from
    (Transitivity).
    $\Box$
  \end{Proof}
\end{Claim}


\pagebreak
\begin{Definition}{内部形式における型束縛(BINDING LIEZAGRAM)}
  内部形式における型束縛$\Lambda$を, 以下のように定義する.
  \[ \begin{array}{l}
     \Lambda\ \text{\it s.t.}\ \Lambda \!\vdash\! T
      \triangleright \!\mathcal{R} \;\stackrel{\mathrm{def}}{:=}
       \!\!\begin{array}[t]{l}
         \Bigl\{\bigl(T, T', \mathcal{R}, \text{\it Fin},
          \bigcup_{j=1}^{n} \Lambda_j \bigr) \Bigr\} \cup
           \bigl(\bigcup^n_{j=1} \Lambda_j \bigr)  \\
          \quad ,\text{\it where}\ \left\{ \begin{array}{l}
            T \cong T'  \\
            \text{\it Fin} \in \{\text{\it gnd}, \text{\it def},
             \wedge, \vee, \text{\it nil}, \text{\it sol}, \infty,
              \text{\it L}, \text{\it R}\}
          \end{array} \right.
       \end{array}  \\
     [39pt]
     \Lambda(T) \;\stackrel{\mathrm{def}}{:=}
      \bigl\{(T', T'', \mathcal{R}, \text{\it Fin}, \Lambda') \,|\,
       (T', T'', \mathcal{R}, \text{\it Fin}, \Lambda') \in \Lambda\
        \text{\it s.t.}\ T = T' \mbox{或} T = T'' \bigr\}
     \end{array}
  \]
\end{Definition}


\begin{Definition}{(LIEZAGRAM DOMAIN)}
  \[ \mathpzc{Dom}(\Lambda) \;\stackrel{\mathrm{def}}{:=}\!
      \bigl\{\, t,\, t' \,|\, (t, t', \mathcal{R}, \text{\it fin}, \Lambda')
       \in \Lambda \bigr\}
  \]
\end{Definition}


\begin{Definition}{内部表現項に関する型照合(内的汎照合:POLYMORPHIC
  MATCHING ON INTERNAL TERMS)}
  内部表現項$T$の, 型$\mathcal{R}$に対する(内的)汎照合の定義を, 以下のように
  拡張する.
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \dfrac{
          \genfrac{}{}{0pt}{0}{}{T \cong T'_0\ \text{\it s.t.}\
           T \neq T'_0}
            \quad \dfrac{}{T'_0 \equiv t_0\ \text{\it where}\
                           (t_0, \mathcal{R}_0) \in \Gamma_\text{\it gnd}}
        }{
          \bigl\{(T, T'_0, \mathcal{R}_0, \text{\it gnd}, \phi ) \bigr\}
           \vdash T \blacktriangleright \mathcal{R}_0
        }  &  \text{\it (T-Atom0-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \genfrac{}{}{0pt}{0}{}{T \cong T'_1\ \text{\it s.t.}\
           T \neq T'_1}
            \quad \dfrac{}{T'_1 \equiv t_1\ \text{\it where}\
                           (t_1, \mathcal{R}_1) \in \Gamma_\text{\it def}}
        }{
          \bigl\{(T, T'_1, \mathcal{R}_1, \text{\it def}, \phi) \bigr\}
           \vdash T \blacktriangleright \mathcal{R}_1
        }  &  \text{\it (T-Atom1-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Lambda_1 \vdash T_1 \blacktriangleright \mathcal{R}_1
             \quad \Lambda_2 \vdash T_2 \blacktriangleright \mathcal{R}_2
              \quad \mathpzc{Dom}(\Lambda_1) \cap \mathpzc{Dom}(\Lambda_2)
               = \phi  \\
            T \cong T_1 \wedge T_2\ \text{\it s.t.}\
             T \neq T_1 \wedge T_2
              \quad T,\, T_1 \!\wedge\! T_2 \not\in \mathpzc{Dom}(
               \Lambda_1 \cup \Lambda_2)
          \end{array}
        }{
          \Bigl\{\bigl(T, T_1 \wedge T_2,
           \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge,
            (\Lambda_1 \cup \Lambda_2) \bigr) \Bigr\}
             \cup (\Lambda_1 \cup \Lambda_2) \vdash
              T \blacktriangleright \mathcal{R}_1 \wedge \mathcal{R}_2
        }  &  \text{\it (T-Cas-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Lambda_1 \vdash T_1 \blacktriangleright \mathcal{R}_1
             \quad \Lambda_2 \vdash T_2 \blacktriangleright \mathcal{R}_2
              \quad \mathpzc{Dom}(\Lambda_1) \cap \mathpzc{Dom}(\Lambda_2)
               = \phi  \\
            T \cong T_1 \vee T_2\ \text{\it s.t.}\
             T \neq T_1 \vee T_2   
              \quad T,\, T_1 \!\vee\! T_2 \not\in \mathpzc{Dom}(
               \Lambda_1 \cup \Lambda_2)
          \end{array}
        }{
          \Bigl\{\bigl(T, T_1 \vee T_2, \mathcal{R}_1 \vee \mathcal{R}_2,
           \vee, (\Lambda_1 \cup \Lambda_2) \bigr) \Bigr\} \cup
            (\Lambda_1 \cup \Lambda_2) \vdash
             T \blacktriangleright \mathcal{R}_1 \vee \mathcal{R}_2
        }  &  \text{\it (T-Par-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            \dfrac{}{T \cong \epsilon\ \text{\it s.t.}\ T \neq \epsilon
              \quad \mathcal{R}_1 \,\text{\it is}\, \text{\it Any}. }
          }{
            \bigl\{(T, \epsilon, \mathcal{R}_1^*, \text{\it nil}, \phi)
             \bigr\} \vdash T \blacktriangleright {\mathcal{R}_1}^*
          }  &  (\text{\it nil}\,)  \\
          \\
          
          \dfrac{
            \quad T \cong T'
             \quad \Lambda' \vdash T' \blacktriangleright \mathcal{R}_1
              \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', {\mathcal{R}_1}^*, \text{\it sol}, \Lambda' )
             \bigr\} \cup \Lambda'
              \vdash T \blacktriangleright {\mathcal{R}_1}^*
          }  &  (\text{\it sol}\,)  \\
          \\
          
          \dfrac{
            \begin{array}{c}
              \Lambda_h \vdash T_h \blacktriangleright \mathcal{R}_1
               \quad \Lambda_t \vdash T_t \blacktriangleright {\mathcal{R}_1}^*
                \quad \mathpzc{Dom}(\Lambda_h) \cap \mathpzc{Dom}(\Lambda_t)
                = \phi  \\
              T \cong T_h \wedge T_t\ \text{\it s.t.}\
               T \neq T_h \wedge T_t
               \quad T,\, T_h \!\wedge\! T_t \not\in \mathpzc{Dom}(
                 \Lambda_h \cup \Lambda_t)
            \end{array}
          }{
            \Bigl\{\bigl(T, T_h \wedge T_t, {\mathcal{R}_1}^*, \infty,
             (\Lambda_h \cup \Lambda_t) \bigr) \Bigr\} \cup
              (\Lambda_h \cup \Lambda_t) \vdash
               T \blacktriangleright {\mathcal{R}_1}^*
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Cat0-inter)}
      \end{array}  \\
      
    \end{array}
  \end{displaymath}
  
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            T \cong T'
             \quad \Lambda' \vdash T' \blacktriangleright \mathcal{R}_1
              \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', {\mathcal{R}_1}^+, \text{\it sol}, \Lambda')
             \bigr\} \cup \Lambda' \vdash
              T \blacktriangleright {\mathcal{R}_1}^+
          }  &  (\text{\it sol}\,)  \\
          \\
          \dfrac{
            \begin{array}{c}
              \Lambda_h \vdash T_h \blacktriangleright \mathcal{R}_1
               \quad \Lambda_t \vdash T_t \blacktriangleright {\mathcal{R}_1}^+
                \quad \mathpzc{Dom}(\Lambda_h) \cap \mathpzc{Dom}(\Lambda_t)
                 = \phi  \\
              T \cong T_h \wedge T_t\ \text{\it s.t.}\
               T \neq T_h \wedge T_t   
                \quad T,\, T_h \!\wedge\! T_t \not\in \mathpzc{Dom}(
                 \Lambda_h \cup \Lambda_t)
            \end{array}
          }{
            \Bigl\{\bigl(T, T_h \wedge T_t, {\mathcal{R}_1}^+, \infty,
             (\Lambda_h \cup \Lambda_t) \bigr) \Bigr\} \cup
              (\Lambda_h \cup \Lambda_t) \vdash
               T \blacktriangleright {\mathcal{R}_1}^+
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Cat1-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            T \cong T'
             \quad \Lambda' \vdash T' \blacktriangleright \mathcal{R}_1
              \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', {\mathcal{R}_1}^\downarrow, \text{\it sol},
             \Lambda') \bigr\} \cup \Lambda' \vdash
              T \blacktriangleright {\mathcal{R}_1}^\downarrow
          }  &  (\text{\it sol}\,)  \\
          \\
          \dfrac{
            \begin{array}{c}
              \Lambda_h \vdash T_h \blacktriangleright \mathcal{R}_1
               \quad \Lambda_t \vdash T_t \blacktriangleright
                {\mathcal{R}_1}^\downarrow
                 \quad \mathpzc{Dom}(\Lambda_h) \cap \mathpzc{Dom}(\Lambda_t)
                  = \phi  \\
              T \cong T_h \vee T_t\ \text{\it s.t.}\
               T \neq T_h \vee T_t
                \quad T,\, T_h \!\vee\! T_t \not\in \mathpzc{Dom}(
                 \Lambda_h \cup \Lambda_t)
            \end{array}
          }{
            \Bigl\{\bigl(T, T_h \vee T_t, {\mathcal{R}_1}^\downarrow,
             \infty, (\Lambda_h \cup \Lambda_t) \bigr) \Bigr\} \cup
              (\Lambda_h \cup \Lambda_t) \vdash
               T \blacktriangleright {\mathcal{R}_1}^\downarrow
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Dup-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{\dfrac{}{T \cong \epsilon\ \text{\it s.t.}\ T \neq \epsilon
              \quad \mathcal{R}_1 \,\text{\it is}\, \text{\it Any}. }
          }{
            \bigl\{(T, \epsilon, {\mathcal{R}_1}^?, \text{\it nil}, \phi)
             \bigr\} \vdash T \blacktriangleright {\mathcal{R}_1}^?
          }  &  (\text{\it nil}\,)  \\
          \\
          
          \dfrac{
            T \cong T'
             \quad \Lambda' \vdash T' \blacktriangleright \mathcal{R}_1
              \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', {\mathcal{R}_1}^?, \text{\it sol},
             \Lambda') \bigr\} \cup \Lambda' \vdash
              T \blacktriangleright {\mathcal{R}_1}^?
          }  &  (\text{\it sol}\,)
        \end{array} \right\}  &  \text{\it (T-Opt-inter)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            T \cong T'
             \quad \Lambda' \vdash T' \blacktriangleright \mathcal{R}_1
              \quad \mathcal{R}_2 \,\text{\it is}\, \text{\it Any}.
               \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', \mathcal{R}_1|\mathcal{R}_2,
             \text{\it L}, \Lambda') \bigr\} \cup \Lambda' \vdash
              T \blacktriangleright \mathcal{R}_1|\mathcal{R}_2
          }  &  (\text{\it L})  \\
          \\
          
          \dfrac{
            T \cong T'
             \quad \forall \Lambda' \not\vdash T' \blacktriangleright
              \mathcal{R}_1
              \quad \Lambda' \vdash T' \blacktriangleright \mathcal{R}_2
               \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', \mathcal{R}_1|\mathcal{R}_2,
             \text{\it R}, \Lambda') \bigr\} \cup \Lambda' \vdash
              T \blacktriangleright \mathcal{R}_1|\mathcal{R}_2
          }  &  (\text{\it R})
        \end{array} \right\}  &  \text{\it (T-Alt-inter)}
      \end{array}
      
    \end{array}
  \end{displaymath}
\end{Definition}


\pagebreak
\begin{Definition}{論理的同値性(INTUITIONISTIC EQUIVALENCE FOR IMPLEMENT)}
\label{equality_on_INTERNALS}
  項$T$の論理的同値項(INTUITIONISTIC EQUIVALENTS FOR IMPLEMENT) $T'$を
  以下のように定義する.
  $T'$が$T$論理的同値項であることを$T \>\dot{\cong}\> T'$と表記する.
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \dfrac{
          \dfrac{}{T \equiv T'}
        }{
          T \>\dot{\cong}\> T'
        }  &  (\text{\it Identity-nucls})
      \end{array}  \\
      \\
      
      \begin{array}{ll}
        \begin{array}{rl}
          \dfrac{T_1 \>\dot{\cong}\> T_1' \quad T_2 \>\dot{\cong}\> T_2'}{
            T_1 \!\wedge\! T_2 \>\dot{\cong}\> T_1' \!\wedge\! T_2'
          }  &  (\text{\it Transparency-Cas-nucls})
        \end{array}
        & \begin{array}{rl}
            \dfrac{T_1 \>\dot{\cong}\> T_1' \quad T_2 \>\dot{\cong}\> T_2'}{
              T_1 \!\vee\! T_2 \>\dot{\cong}\> T_1' \!\vee\! T_2'
            }  &  (\text{\it Transparency-Par-nucls})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          T_1 \>\dot{\cong}\> T'_1 \quad T_2 \>\dot{\cong}\> T'_2 \
        }{
          T_1 \wedge T_2 \>\dot{\cong}\> T'' \ \text{\it where}\
           T'' \in T_{r_1} \bowtie_\wedge \cdots \bowtie_\wedge T_{r_n} =
            T'_1 \wedge T'_2
        }  &  (\text{\it Associativity-Cas-nucls})
      \end{array}  \\
      \\
      \begin{array}{rl}
        \dfrac{
          T_1 \>\dot{\cong}\> T'_1 \quad T_2 \>\dot{\cong}\> T'_2 \
        }{
          T_1 \vee T_2 \>\dot{\cong}\> T'' \ \text{\it where}\
           T'' \in T_{r_1} \bowtie_\vee \cdots \bowtie_\vee T_{r_n} =
            T'_1 \vee T'_2
        }  &  (\text{\it Associativity-Par-nucls})
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          T \>\dot{\cong}\> T_1 \wedge T_2\ \text{\it s.t.}\
           \mbox{the last applied rule isn't}\
            \text{\it (Link-Cat0}_1\text{\it -nucls)}
        }{
          T \>\dot{\cong}\> T_1 \wedge (T_2 \wedge \bot)
        }  &  \text{\it (Link-Cat0}_1\text{\it -nucls)}
      \end{array}  \\
      \\
      \begin{array}{rl}
        \dfrac{
          T_1 \>\dot{\cong}\> T'_1
           \quad T_2 \>\dot{\cong}\> T_{21} \wedge T_{22}\
            \text{\it s.t.}\ \mathpzc{id}(T_{21} \wedge T_{22}) =
             \mathpzc{id}(T_{22})\ \text{\it if}\;\; T_{22} \neq \bot
        }{
          T_1 \wedge T_2 \>\dot{\cong}\>
           T'_1 \wedge (T_{21} \wedge T_{22})\ \text{\it s.t.}\
            \mathpzc{id}\bigl(T'_1 \wedge (T_{21} \wedge T_{22}) \bigr) =
             \mathpzc{id}(T_{21} \wedge T_{22})
        } 
        &  \text{\it (LinkH-Cat0}_\infty\text{\it -nucls)}
      \end{array} \\
      \\
      \begin{array}{l}
        \begin{array}{rl}
          \dfrac{
            T_1 \>\dot{\cong}\> T_{11} \wedge T_{12}\ \text{\it s.t.}\
             \mathpzc{id}(T_{11} \wedge T_{12}) = \mathpzc{id}(T_{12})\
              \text{\it if}\;\; T_{12} \neq \bot
               \quad T_2 \>\dot{\cong}\> T'_2
          }{
            T_1 \wedge T_2 \>\dot{\cong}\> \mathpzc{App}_{\{\}}(
             T_{11} \wedge T_{12}, T'_2 )
          }  &  \text{\it (LinkT-Cat0}_\infty\text{\it -nucls)}
        \end{array} \\
        \text{\it where}  \\
        \mathpzc{App}_{\{\}}(T_1, T_2, m) \,\stackrel{\mathrm{def}}{:=}\,
        \left\{ \begin{array}{l}
          {(T_2 \wedge \bot)}^m \quad \text{\it if}\;\; T_1 = \bot  \\
          {\bigl(T_{11} \wedge {(T_2 \wedge \bot)}^m \bigr)}^m
           \quad \text{\it if}\;\; T_1 = T_{11} \wedge \bot  \\
          {\bigl(T_{11} \wedge \mathpzc{App}_{\{\}}(T_{12}, T_2, m)
            \bigr)}^m \quad \text{\it if}\;\; T_1 = T_{11} \wedge T_{12}\
             \text{\it s.t.}\! \begin{array}[t]{l}
               T_{12} \neq \bot  \\
               \mathpzc{id}(T_{12}) = \mathpzc{id}(T_1)
             \end{array}  \\
          {T_1}^m \quad \text{\it otherwise}
        \end{array} \right.
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          T \>\dot{\cong}\> T_1 \wedge T_2\ \text{\it s.t.}\
           \mbox{the last applied rule isn't}\
            \text{\it (Link-Cat1}_1\text{\it -nucls)}
        }{
          T \>\dot{\cong}\> T_1 \vee (T_2 \vee \bot)
        }  &  \text{\it (Link-Cat1}_1\text{\it -nucls)}
      \end{array}  \\
      \\
      \begin{array}{rl}
        \dfrac{
          T_1 \>\dot{\cong}\> T'_1
          \quad T_2 \>\dot{\cong}\> T_{21} \wedge T_{22}\
           \text{\it s.t.}\ \mathpzc{id}(T_{21} \wedge T_{22}) =
            \mathpzc{id}(T_{21})\ \text{\it if}\;\; T_{21} \neq \bot
        }{
          T_1 \wedge T_2 \>\dot{\cong}\>
           (T_{21} \wedge T_{22}) \wedge T'_1\ \text{\it s.t.}\
            \mathpzc{id}\bigl((T_{21} \wedge T_{22}) \wedge T'_1 \bigr) =
             \mathpzc{id}(T_{21} \wedge T_{22})
        } 
        &  \text{\it (LinkH-Cat1}_\infty\text{\it -nucls)}
      \end{array} \\
      \\
      \begin{array}{l}
        \begin{array}{rl}
          \dfrac{
            T_1 \>\dot{\cong}\> T_{11} \wedge T_{12}\ \text{\it s.t.}\
             \mathpzc{id}(T_{11} \wedge T_{12}) = \mathpzc{id}(T_{11})\
              \text{\it if}\;\; T_{11} \neq \bot
               \quad T_2 \>\dot{\cong}\> T'_2
          }{
            T_1 \wedge T_2 \>\dot{\cong}\> \mathpzc{App}_{[\,]}(
             T_{11} \wedge T_{12}, T'_2 )
          }  &  \text{\it (LinkT-Cat1}_\infty\text{\it -nucls)}
        \end{array} \\
        \text{\it where}  \\
        \mathpzc{App}_{[\,]}(T_1, T_2, m) \,\stackrel{\mathrm{def}}{:=}\,
         \left\{ \begin{array}{l}
           {(\bot \wedge T_2)}^m \quad \text{\it if}\;\; T_1 = \bot  \\
           {\bigl({(\bot \wedge T_2)}^m \wedge T_{11} \bigr)}^m
            \quad \text{\it if}\ T_1 = \bot \wedge T_{11}  \\
           {\bigl(\mathpzc{App}_{[\,]}(T_{12}, T_2, m) \wedge T_{11} \bigr)}^m
            \quad \text{\it if}\ T_1 = T_{12} \wedge T_{11}\
             \text{\it s.t.}\! \begin{array}[t]{l}
               T_{12} \neq \bot  \\
               \mathpzc{id}(T_{12}) = \mathpzc{id}(T_1)
            \end{array}  \\
           {T_1}^m \quad \text{\it otherwise}
         \end{array} \right.
      \end{array}
      
    \end{array}
  \end{displaymath}
  
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \dfrac{
          T \>\dot{\cong}\> T_1 \vee T_2\ \text{\it s.t.}\
           \mbox{the last applied rule isn't}\
            \text{\it (Link-Dup}_1\text{\it -nucls)}
        }{
          T \>\dot{\cong}\> T_1 \vee (\bot \vee T_2)
        }  &  \text{\it (Link-Dup}_1\text{\it -nucls)}
      \end{array}  \\
      \\
      \begin{array}{rl}
        \dfrac{
          T_1 \>\dot{\cong}\> T'_1
          \quad T_2 \>\dot{\cong}\> T_{21} \vee T_{22}\
           \text{\it s.t.}\ \mathpzc{id}(T_{21} \vee T_{22}) =
            \mathpzc{id}(T_{21})\ \text{\it if}\;\; T_{21} \neq \bot
        }{
          T_1 \vee T_2 \>\dot{\cong}\>
           (T_{21} \vee T_{22}) \vee T'_1\ \text{\it s.t.}\
            \mathpzc{id}\bigl((T_{21} \vee T_{22}) \vee T'_1 \bigr) =
             \mathpzc{id}(T_{21} \vee T_{22})
        } 
        &  \text{\it (LinkH-Dup}_\infty\text{\it -nucls)}
      \end{array} \\
      \\
      \begin{array}{l}
        \begin{array}{rl}
          \dfrac{
            T_1 \>\dot{\cong}\> T_{11} \vee T_{12}\ \text{\it s.t.}\
             \mathpzc{id}(T_{11} \vee T_{12}) = \mathpzc{id}(T_{11})\
              \text{\it if}\;\; T_{11} \neq \bot
               \quad T_2 \>\dot{\cong}\> T'_2
          }{
            T_1 \vee T_2 \>\dot{\cong}\> \mathpzc{App}_{\langle\rangle}(
             T_{11} \vee T_{12}, T'_2 )
          }  &  \text{\it (LinkT-Dup}_\infty\text{\it -nucls)}
        \end{array} \\
        \text{\it where}  \\
        \mathpzc{App}_{\langle\rangle}(T_1, T_2, m)
        \,\stackrel{\mathrm{def}}{:=}\, \left\{ \begin{array}{l}
          {(\bot \vee T_2)}^m \quad \text{\it if}\;\; T_1 = \bot  \\
          {\bigl({(\bot \vee T_2)}^m \vee T_{11} \bigr)}^m
           \quad \text{\it if} T_1 = \bot \vee T_{11}  \\
          {\bigl(\mathpzc{App}_{\langle\rangle}(T_{12}, T_2, m) \vee T_{11}
           \bigr)}^m \quad \text{\it if}\ T_1 = T_{12} \vee T_{11}\
            \text{\it s.t.}\! \begin{array}[t]{l}
              T_{12} \neq \bot  \\
              \mathpzc{id}(T_{12}) = \mathpzc{id}(T_1)
           \end{array}  \\
          {T_1}^m \quad \text{\it otherwise}
        \end{array} \right.
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{T \>\dot{\cong}\> T'}{
           T \>\dot{\cong}\> \bigl(\epsilon^{\mathpzc{id}(
            \epsilon \wedge \bot)} \wedge  \bot \bigr) \wedge T'
          }  &  (\text{\it PhonyH-Cas-nucls})
        \end{array}
        & \begin{array}{rl}
            \dfrac{T \>\dot{\cong}\> T'}{
             T \>\dot{\cong}\> T' \wedge \bigl(\epsilon^{\mathpzc{id}(
              \epsilon \wedge \bot)} \wedge \bot \bigr)
            }  &  (\text{\it PhonyT-Cas-nucls})
          \end{array}
      \end{array}  \\
      \\
      \begin{array}{rl}
        \begin{array}{rl}
          \dfrac{T \>\dot{\cong}\> T'}{
           T \>\dot{\cong}\> \bigl(\epsilon^{\mathpzc{id}(
            \epsilon \wedge \bot)} \wedge \bot \bigr) \vee T'
          }  &  (\text{\it PhonyH-Par-nucls})
        \end{array}
        & \begin{array}{rl}
            \dfrac{T \>\dot{\cong}\> T'}{
             T \>\dot{\cong}\> T' \vee \bigl(\epsilon^{\mathpzc{id}(
              \epsilon \wedge \bot)} \wedge \bot \bigr)
            }  &  (\text{\it PhonyT-Par-nucls})
          \end{array}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{T \>\dot{\cong}\>
         \bigl(\epsilon^{\mathpzc{id}(\epsilon \wedge \bot)} \wedge
          \bot \bigr) \wedge T'\ \text{\it where}\ T' \neq \bot
        }{
          T \>\dot{\cong}\> T'
        }  &  (\text{\it RevealH-Cas-nucls})
      \end{array} \\
      \\
      \begin{array}{rl}
        \dfrac{T \>\dot{\cong}\> T' \wedge \bigl(\epsilon^{\mathpzc{id}(
         \epsilon \wedge \bot)} \wedge \bot \bigr)\ \text{\it where}\
          T' \neq \bot
        }{
          T \>\dot{\cong}\> T'
        }  &  (\text{\it RevealT-Cas-nucls})
      \end{array} \\
      \\
      
      \begin{array}{rl}
        \dfrac{T \>\dot{\cong}\> \bigl(\epsilon^{\mathpzc{id}(
         \epsilon \wedge \bot)} \wedge \bot \bigr) \vee T'
        }{
          T \>\dot{\cong}\> T'
        }  &  (\text{\it RevealH-Par-nucls})
      \end{array} \\
      \\
      \begin{array}{rl}
        \dfrac{T \>\dot{\cong}\> T' \vee \bigl(\epsilon^{\mathpzc{id}(
         \epsilon \wedge \bot)} \wedge \bot \bigr)\ \text{\it where}\
          T' \neq \bot 
        }{
          T \>\dot{\cong}\> T'
        }  &  (\text{\it RevealT-Par-nucls})
      \end{array} \\
      
    \end{array}
  \end{displaymath}
\end{Definition}


\newpage
\begin{Definition}{内部表現項に関する制限された型照合(制限された内的汎照合:
  RESTRICTED POLYMORPHIC MATCHING ON INTERNAL TERMS)}
  内部表現項$T$の, 型$\mathcal{R}$に対する制限された(内的)汎照合を,
  以下のように定義する。
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \dfrac{
          \dfrac{}{T \equiv t_0\ \text{\it where}\
           (t_0, \mathcal{R}_0) \in \Gamma_\text{\it gnd}}
        }{
          \bigl\{(T, T, \mathcal{R}_0, \text{\it gnd}, \phi ) \bigr\}
           \vdash T \>\dot{\blacktriangleright}\> \mathcal{R}_0          
        }  &  \text{\it (T-Atom0-nucls)}
      \end{array} \\
      \\
      \begin{array}{rl}
        \dfrac{
          \dfrac{}{T \equiv t_1\ \text{\it where}\
           (t_1, \mathcal{R}_1) \in \Gamma_\text{\it def}}
        }{
          \bigl\{(T, T, \mathcal{R}_1, \text{\it def}, \phi) \bigr\}
           \vdash T \>\dot{\blacktriangleright}\> \mathcal{R}_1
        }  &  \text{\it (T-Atom1-nucls)}
      \end{array} \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Lambda_1 \vdash T_1 \>\dot{\blacktriangleright}\> \mathcal{R}_1
             \quad \Lambda_2 \vdash T_2 \>\dot{\blacktriangleright}\> \mathcal{R}_2
              \quad \mathpzc{Dom}(\Lambda_1) \cap \mathpzc{Dom}(\Lambda_2)
               = \phi  \\
            T \>\dot{\cong}\> T_1 \wedge T_2\ \text{\it s.t.}\
             T \neq T_1 \wedge T_2
              \quad T,\, T_1 \!\wedge\! T_2 \not\in \mathpzc{Dom}(
               \Lambda_1 \cup \Lambda_2)
          \end{array}
        }{
          \Bigl\{\bigl(T, T_1 \wedge T_2,
           \mathcal{R}_1 \wedge \mathcal{R}_2, \wedge,
            (\Lambda_1 \cup \Lambda_2) \bigr) \Bigr\}
             \cup (\Lambda_1 \cup \Lambda_2) \vdash
              T \>\dot{\blacktriangleright}\> \mathcal{R}_1 \wedge \mathcal{R}_2
        }  &  \text{\it (T-Cas-nucls)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \dfrac{
          \begin{array}{c}
            \Lambda_1 \vdash T_1 \>\dot{\blacktriangleright}\> \mathcal{R}_1
             \quad \Lambda_2 \vdash T_2 \>\dot{\blacktriangleright}\> \mathcal{R}_2
              \quad \mathpzc{Dom}(\Lambda_1) \cap \mathpzc{Dom}(\Lambda_2)
               = \phi  \\
            T \>\dot{\cong}\> T_1 \vee T_2\ \text{\it s.t.}\
             T \neq T_1 \vee T_2   
              \quad T,\, T_1 \!\vee\! T_2 \not\in \mathpzc{Dom}(
               \Lambda_1 \cup \Lambda_2)
          \end{array}
        }{
          \Bigl\{\bigl(T, T_1 \vee T_2, \mathcal{R}_1 \vee \mathcal{R}_2,
           \vee, (\Lambda_1 \cup \Lambda_2) \bigr) \Bigr\} \cup
            (\Lambda_1 \cup \Lambda_2) \vdash
             T \>\dot{\blacktriangleright}\> \mathcal{R}_1 \vee \mathcal{R}_2
        }  &  \text{\it (T-Par-nucls)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            \dfrac{}{T \>\dot{\cong}\> \epsilon\ \text{\it s.t.}\ T \neq \epsilon}\
              \quad \genfrac{}{}{0pt}{0}{}{\mathcal{R}_1 \,\text{\it is}\, \text{\it Any}.}
          }{
            \bigl\{(T, \epsilon, \mathcal{R}_1^*, \text{\it nil}, \phi)
             \bigr\} \vdash T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^*
          }  &  (\text{\it nil}\,)  \\
          \\
          
          \dfrac{
            \quad T \>\dot{\cong}\> T'
             \quad \Lambda' \vdash T' \>\dot{\blacktriangleright}\> \mathcal{R}_1
              \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', {\mathcal{R}_1}^*, \text{\it sol}, \Lambda' )
             \bigr\} \cup \Lambda'
              \vdash T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^*
          }  &  (\text{\it sol}\,)  \\
          \\
          
          \dfrac{
            \begin{array}{c}
              \Lambda_h \vdash T_h \>\dot{\blacktriangleright}\> \mathcal{R}_1
               \quad \Lambda_t \vdash T_t \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^*
                \quad \mathpzc{Dom}(\Lambda_h) \cap \mathpzc{Dom}(\Lambda_t)
                = \phi  \\
              T \>\dot{\cong}\> T_h \wedge T_t\ \text{\it s.t.}\
               T \neq T_h \wedge T_t
               \quad T,\, T_h \!\wedge\! T_t \not\in \mathpzc{Dom}(
                 \Lambda_h \cup \Lambda_t)
            \end{array}
          }{
            \Bigl\{\bigl(T, T_h \wedge T_t, {\mathcal{R}_1}^*, \infty,
             (\Lambda_h \cup \Lambda_t) \bigr) \Bigr\} \cup
              (\Lambda_h \cup \Lambda_t) \vdash
               T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^*
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Cat0-nucls)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            T \>\dot{\cong}\> T'
             \quad \Lambda' \vdash T' \>\dot{\blacktriangleright}\> \mathcal{R}_1
              \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', {\mathcal{R}_1}^+, \text{\it sol}, \Lambda')
             \bigr\} \cup \Lambda' \vdash
              T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^+
          }  &  (\text{\it sol}\,)  \\
          \\
          \dfrac{
            \begin{array}{c}
              \Lambda_h \vdash T_h \>\dot{\blacktriangleright}\> \mathcal{R}_1
               \quad \Lambda_t \vdash T_t \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^+
                \quad \mathpzc{Dom}(\Lambda_h) \cap \mathpzc{Dom}(\Lambda_t)
                 = \phi  \\
              T \>\dot{\cong}\> T_h \wedge T_t\ \text{\it s.t.}\
               T \neq T_h \wedge T_t   
                \quad T,\, T_h \!\wedge\! T_t \not\in \mathpzc{Dom}(
                 \Lambda_h \cup \Lambda_t)
            \end{array}
          }{
            \Bigl\{\bigl(T, T_h \wedge T_t, {\mathcal{R}_1}^+, \infty,
             (\Lambda_h \cup \Lambda_t) \bigr) \Bigr\} \cup
              (\Lambda_h \cup \Lambda_t) \vdash
               T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^+
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Cat1-nucls)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            T \>\dot{\cong}\> T'
             \quad \Lambda' \vdash T' \>\dot{\blacktriangleright}\> \mathcal{R}_1
              \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', {\mathcal{R}_1}^\downarrow, \text{\it sol},
             \Lambda') \bigr\} \cup \Lambda' \vdash
              T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^\downarrow
          }  &  (\text{\it sol}\,)  \\
          \\
          \dfrac{
            \begin{array}{c}
              \Lambda_h \vdash T_h \>\dot{\blacktriangleright}\> \mathcal{R}_1
               \quad \Lambda_t \vdash T_t \>\dot{\blacktriangleright}\>
                {\mathcal{R}_1}^\downarrow
                 \quad \mathpzc{Dom}(\Lambda_h) \cap \mathpzc{Dom}(\Lambda_t)
                  = \phi  \\
              T \>\dot{\cong}\> T_h \vee T_t\ \text{\it s.t.}\
               T \neq T_h \vee T_t
                \quad T,\, T_h \!\vee\! T_t \not\in \mathpzc{Dom}(
                 \Lambda_h \cup \Lambda_t)
            \end{array}
          }{
            \Bigl\{\bigl(T, T_h \vee T_t, {\mathcal{R}_1}^\downarrow,
             \infty, (\Lambda_h \cup \Lambda_t) \bigr) \Bigr\} \cup
              (\Lambda_h \cup \Lambda_t) \vdash
               T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^\downarrow
          }  &  (\infty)
        \end{array} \right\}  &  \text{\it (T-Dup-nucls)}
      \end{array}  \\
      
    \end{array}
  \end{displaymath}
  
  \begin{displaymath}
    \begin{array}{c}
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{\dfrac{}{T \>\dot{\cong}\> \epsilon\ \text{\it s.t.}\ T \neq \epsilon}
              \quad \genfrac{}{}{0pt}{0}{}{\mathcal{R}_1 \,\text{\it is}\, \text{\it Any}.}
          }{
            \bigl\{(T, \epsilon, {\mathcal{R}_1}^?, \text{\it nil}, \phi)
             \bigr\} \vdash T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^?
          }  &  (\text{\it nil}\,)  \\
          \\
          
          \dfrac{
            T \>\dot{\cong}\> T'
             \quad \Lambda' \vdash T' \>\dot{\blacktriangleright}\> \mathcal{R}_1
              \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', {\mathcal{R}_1}^?, \text{\it sol},
             \Lambda') \bigr\} \cup \Lambda' \vdash
              T \>\dot{\blacktriangleright}\> {\mathcal{R}_1}^?
          }  &  (\text{\it sol}\,)
        \end{array} \right\}  &  \text{\it (T-Opt-nucls)}
      \end{array}  \\
      \\
      
      \begin{array}{rl}
        \left. \begin{array}{rl}
          \dfrac{
            T \>\dot{\cong}\> T'
             \quad \Lambda' \vdash T' \>\dot{\blacktriangleright}\> \mathcal{R}_1
              \quad \mathcal{R}_2 \,\text{\it is}\, \text{\it Any}.
               \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', \mathcal{R}_1|\mathcal{R}_2,
             \text{\it L}, \Lambda') \bigr\} \cup \Lambda' \vdash
              T \>\dot{\blacktriangleright}\> \mathcal{R}_1|\mathcal{R}_2
          }  &  (\text{\it L})  \\
          \\
          
          \dfrac{
            T \>\dot{\cong}\> T'
             \quad \forall \Lambda' \not\vdash T' \>\dot{\blacktriangleright}\>
              \mathcal{R}_1
              \quad \Lambda' \vdash T' \>\dot{\blacktriangleright}\> \mathcal{R}_2
               \quad T \not\in \mathpzc{Dom}(\Lambda')
          }{
            \bigl\{(T, T', \mathcal{R}_1|\mathcal{R}_2,
             \text{\it R}, \Lambda') \bigr\} \cup \Lambda' \vdash
              T \>\dot{\blacktriangleright}\> \mathcal{R}_1|\mathcal{R}_2
          }  &  (\text{\it R})
        \end{array} \right\}  &  \text{\it (T-Alt-nucls)}
      \end{array}
      
    \end{array}
  \end{displaymath}
\end{Definition}

\end{document}
